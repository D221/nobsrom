<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>nobsrom.main API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Colors">Colors</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Colors.HEADER">HEADER</a>
                        </li>
                        <li>
                                <a class="variable" href="#Colors.SELECTED">SELECTED</a>
                        </li>
                        <li>
                                <a class="variable" href="#Colors.FAVORITE">FAVORITE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Colors.NORMAL">NORMAL</a>
                        </li>
                        <li>
                                <a class="variable" href="#Colors.HIGHLIGHT">HIGHLIGHT</a>
                        </li>
                        <li>
                                <a class="variable" href="#Colors.STATUS_BAR">STATUS_BAR</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#EmulatorLauncher">EmulatorLauncher</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#EmulatorLauncher.app_name">app_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.vendor_name">vendor_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.config_dir">config_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.config_file">config_file</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.favorites_file">favorites_file</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.config">config</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.favorites">favorites</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.roms">roms</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.all_roms">all_roms</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.selected_system">selected_system</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.selected_rom">selected_rom</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.total_roms">total_roms</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.current_rom_index">current_rom_index</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.system_window">system_window</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.rom_window">rom_window</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.emulator_process">emulator_process</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.focus">focus</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.filter_string">filter_string</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.filtered_roms">filtered_roms</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.last_selection_change_time">last_selection_change_time</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.mode">mode</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.view_mode">view_mode</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.joystick">joystick</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.first_axis_event">first_axis_event</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.last_axis_event">last_axis_event</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.first_hat_event">first_hat_event</a>
                        </li>
                        <li>
                                <a class="variable" href="#EmulatorLauncher.last_hat_event">last_hat_event</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.load_config">load_config</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.create_default_config">create_default_config</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.save_config">save_config</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.load_favorites">load_favorites</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.save_favorites">save_favorites</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.init_colors">init_colors</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.draw_borders">draw_borders</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.get_roms">get_roms</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.combine_all_roms">combine_all_roms</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.format_size">format_size</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.draw_system_window">draw_system_window</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.draw_rom_window">draw_rom_window</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.launch_rom">launch_rom</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.update_filtered_roms">update_filtered_roms</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.get_favorite_roms_with_system">get_favorite_roms_with_system</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.toggle_favorite">toggle_favorite</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.toggle_favorite_by_system_and_path">toggle_favorite_by_system_and_path</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.is_favorite">is_favorite</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.handle_input">handle_input</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.launch_selected_rom">launch_selected_rom</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.draw_filter_bar">draw_filter_bar</a>
                        </li>
                        <li>
                                <a class="function" href="#EmulatorLauncher.main">main</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#main">main</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
nobsrom<wbr>.main    </h1>

                
                        <input id="mod-main-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-main-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="kn">import</span> <span class="nn">curses</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">import</span> <span class="nn">subprocess</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span> <span class="nn">yaml</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span> <span class="nn">platformdirs</span> <span class="kn">import</span> <span class="n">user_config_path</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PYGAME_HIDE_SUPPORT_PROMPT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;hide&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SDL_AUDIODRIVER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dummy&quot;</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">import</span> <span class="nn">pygame.event</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">import</span> <span class="nn">pygame.joystick</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="k">class</span> <span class="nc">Colors</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="sd">    Enum class representing different color codes used in the application.</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="sd">    Attributes:</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="sd">        HEADER (int): Color code for header elements.</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="sd">        SELECTED (int): Color code for selected items.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="sd">        FAVORITE (int): Color code for favorite items.</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="sd">        NORMAL (int): Color code for normal items.</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">        HIGHLIGHT (int): Color code for highlighted items.</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="sd">        STATUS_BAR (int): Color code for the status bar.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>    <span class="n">HEADER</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>    <span class="n">SELECTED</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>    <span class="n">FAVORITE</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>    <span class="n">NORMAL</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>    <span class="n">HIGHLIGHT</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>    <span class="n">STATUS_BAR</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="k">class</span> <span class="nc">EmulatorLauncher</span><span class="p">:</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">    EmulatorLauncher is a class that manages the launching and navigation of ROMs for various emulators.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>        <span class="c1"># config</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">app_name</span> <span class="o">=</span> <span class="s2">&quot;nobsrom&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The name of the application.&quot;&quot;&quot;</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vendor_name</span> <span class="o">=</span> <span class="s2">&quot;D221&quot;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The vendor name associated with the application.&quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">=</span> <span class="n">user_config_path</span><span class="p">(</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vendor_name</span><span class="p">,</span> <span class="n">ensure_exists</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>        <span class="p">)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The directory path for storing user configuration files.&quot;&quot;&quot;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>        <span class="c1"># Set default file paths if not specified</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="s2">&quot;config.yaml&quot;</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The file path for the configuration file.&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="s2">&quot;favorites.yaml&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The file path for the favorites file.&quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_config</span><span class="p">()</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The loaded configuration dictionary.&quot;&quot;&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_favorites</span><span class="p">()</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The loaded favorites dictionary.&quot;&quot;&quot;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_roms</span><span class="p">()</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A dictionary of ROMs categorized by system.&quot;&quot;&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_all_roms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="p">)</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A list of all ROMs across all systems.&quot;&quot;&quot;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The index of the currently selected system.&quot;&quot;&quot;</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The index of the currently selected ROM.&quot;&quot;&quot;</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The total number of ROMs in the current view.&quot;&quot;&quot;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_rom_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The index of the currently selected ROM (1-based).&quot;&quot;&quot;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The window object for displaying systems.&quot;&quot;&quot;</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The window object for displaying ROMs.&quot;&quot;&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The process object for the running emulator.&quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The current focus of the application (either &#39;systems&#39; or &#39;roms&#39;).&quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The string used to filter ROMs.&quot;&quot;&quot;</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A dictionary of filtered ROMs based on the filter string and view mode.&quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_selection_change_time</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the last selection change.&quot;&quot;&quot;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The current mode of the application (either &#39;navigate&#39; or &#39;filter&#39;).&quot;&quot;&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;favorites&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span> <span class="k">else</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The current view mode (either &#39;favorites&#39; or &#39;systems&#39;).&quot;&quot;&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The joystick object for gamepad support.&quot;&quot;&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the first axis event for each direction.&quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the last axis event for each direction.&quot;&quot;&quot;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the first hat event for each direction.&quot;&quot;&quot;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the last hat event for each direction.&quot;&quot;&quot;</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>    <span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="sd">        Load the configuration from a platform-specific location.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">        This method attempts to load the configuration from a file specified by</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">        `self.config_file`. If the file does not exist, it creates a default</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="sd">        configuration file. If an error occurs during loading, it prints an error</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">        message and returns the default configuration.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">        Returns:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">            dict: The loaded configuration as a dictionary. If the configuration</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">            file does not exist or an error occurs, returns the default configuration.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">create_default_config</span><span class="p">()</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>                <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading config: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_default_config</span><span class="p">()</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>    <span class="k">def</span> <span class="nf">create_default_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">        Creates and saves a default configuration for the ROM launcher.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">        The default configuration includes settings for the NES system, specifying</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        the emulator path, launch arguments, and ROM paths.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="sd">        Returns:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">            dict: The default configuration dictionary.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>        <span class="n">default_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>            <span class="s2">&quot;systems&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>                <span class="s2">&quot;NES&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>                    <span class="s2">&quot;emulator_path&quot;</span><span class="p">:</span> <span class="s2">&quot;retroarch&quot;</span><span class="p">,</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>                    <span class="s2">&quot;launch_arguments&quot;</span><span class="p">:</span> <span class="s2">&quot;-L cores/fceumm_libretro.dll </span><span class="si">{rom_path}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>                    <span class="s2">&quot;paths&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;~/ROMs/NES&quot;</span><span class="p">],</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>                <span class="p">}</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>            <span class="p">}</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>        <span class="p">}</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">save_config</span><span class="p">(</span><span class="n">default_config</span><span class="p">)</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="k">return</span> <span class="n">default_config</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>    <span class="k">def</span> <span class="nf">save_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="sd">        Save the current configuration to a file.</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">        Args:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="sd">            config (dict, optional): The configuration dictionary to save.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">                                     If not provided, the current configuration</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">                                     stored in self.config will be used.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">        Raises:</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">            IOError: If there is an error writing to the file.</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>        <span class="n">config</span> <span class="o">=</span> <span class="n">config</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>    <span class="k">def</span> <span class="nf">load_favorites</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">        Loads the favorites from a YAML file.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a><span class="sd">        This method attempts to load the favorites from a specified YAML file.</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a><span class="sd">        If the file does not exist, it returns an empty dictionary. If there is</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a><span class="sd">        an error during the loading process, it catches the exception, prints</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a><span class="sd">        an error message, and returns an empty dictionary.</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a><span class="sd">        Returns:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a><span class="sd">            dict: A dictionary containing the favorites loaded from the YAML file,</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a><span class="sd">                  or an empty dictionary if the file does not exist or an error occurs.</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>                <span class="k">return</span> <span class="p">{}</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>                <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading favorites: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>            <span class="k">return</span> <span class="p">{}</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>    <span class="k">def</span> <span class="nf">save_favorites</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">        Saves the current list of favorite ROMs to a file.</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">        This method writes the contents of the `self.favorites` list to the file</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">        specified by `self.favorites_file` in YAML format.</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">        Raises:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">            IOError: If the file cannot be opened or written to.</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>    <span class="k">def</span> <span class="nf">init_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a><span class="sd">        Initialize color pairs for the UI using the curses library.</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="sd">        This method sets up the color pairs that will be used throughout the UI.</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">        It starts by initializing the curses color system and using the default</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="sd">        terminal colors. Then, it defines several color pairs for different UI</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">        elements such as headers, selected items, favorites, normal text,</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="sd">        highlighted text, and the status bar.</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a><span class="sd">        Color pairs defined:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a><span class="sd">        - HEADER: White text on a blue background</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a><span class="sd">        - SELECTED: Black text on a white background</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="sd">        - FAVORITE: Yellow text on the default background</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">        - NORMAL: White text on the default background</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a><span class="sd">        - HIGHLIGHT: Cyan text on the default background</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a><span class="sd">        - STATUS_BAR: Black text on a white background</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">start_color</span><span class="p">()</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">use_default_colors</span><span class="p">()</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>        <span class="c1"># Define color pairs</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HEADER</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_BLUE</span><span class="p">)</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_BLACK</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span><span class="p">)</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">FAVORITE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_YELLOW</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HIGHLIGHT</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_CYAN</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>            <span class="n">Colors</span><span class="o">.</span><span class="n">STATUS_BAR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_BLACK</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>    <span class="k">def</span> <span class="nf">draw_borders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">        Draws borders and headers for the system and ROM windows.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">        This method draws a box around the system window and adds a header</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">        labeled &quot;[ Systems ]&quot; with a specific color. It also draws a box</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a><span class="sd">        around the ROM window and adds a header labeled &quot;[ Games ]&quot; with</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a><span class="sd">        the same color.</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="sd">        The colors used for the headers are defined by the Colors.HEADER</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a><span class="sd">        enumeration value.</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>        <span class="c1"># Draw system window border</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>            <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;[ Systems ]&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HEADER</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>        <span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>        <span class="c1"># Draw ROM window border</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>            <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;[ Games ]&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HEADER</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>        <span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>    <span class="k">def</span> <span class="nf">get_roms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">        Retrieves a list of ROMs from the configured paths for each system.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">        This method iterates through the systems defined in the configuration,</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">        collects ROM file paths from the specified directories, and organizes</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">        them by system.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">        Returns:</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a><span class="sd">            dict: A dictionary where the keys are system names and the values</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a><span class="sd">                  are lists of ROM file paths.</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a><span class="sd">        Raises:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a><span class="sd">            Prints a warning message if a specified ROM path is invalid.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>        <span class="n">roms</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;systems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>            <span class="n">roms</span><span class="p">[</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;paths&quot;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>                    <span class="n">roms</span><span class="p">[</span><span class="n">system</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>                        <span class="p">[</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>                            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>                            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>                        <span class="p">]</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>                    <span class="p">)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Invalid ROM path for </span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>        <span class="k">return</span> <span class="n">roms</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>    <span class="k">def</span> <span class="nf">combine_all_roms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roms</span><span class="p">):</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">        Combines all ROMs from all systems into a list of (system, rom_path) tuples.</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="sd">        Args:</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">            roms (dict): A dictionary where keys are system names and values are lists of ROM paths.</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a><span class="sd">        Returns:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="sd">            list: A sorted list of tuples, where each tuple contains a system name and a ROM path.</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">                  The list is sorted by the ROM name in a case-insensitive manner.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>        <span class="n">all_roms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">system_roms</span> <span class="ow">in</span> <span class="n">roms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>            <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">system_roms</span><span class="p">:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>                <span class="n">all_roms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">system</span><span class="p">,</span> <span class="n">rom</span><span class="p">))</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>            <span class="n">all_roms</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>        <span class="p">)</span>  <span class="c1"># Sort by ROM name</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>    <span class="k">def</span> <span class="nf">format_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="sd">        Formats a given size in bytes into a human-readable string with appropriate units.</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a><span class="sd">        Args:</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a><span class="sd">            size (float): The size in bytes to be formatted.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">        Returns:</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a><span class="sd">            str: The formatted size string with units (B, KB, MB, GB, TB, or PB).</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;KB&quot;</span><span class="p">,</span> <span class="s2">&quot;MB&quot;</span><span class="p">,</span> <span class="s2">&quot;GB&quot;</span><span class="p">,</span> <span class="s2">&quot;TB&quot;</span><span class="p">]:</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>            <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>                <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="si">}{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>            <span class="n">size</span> <span class="o">/=</span> <span class="mi">1024</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">PB&quot;</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>    <span class="k">def</span> <span class="nf">draw_system_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="sd">        Draws the system selection window with enhanced visuals.</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">        This method clears the current system window and redraws it with updated</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">        information, including the number of favorite ROMs, all ROMs, and ROMs</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">        categorized by system. It highlights the currently selected view mode</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">        and system, if applicable.</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">        The window includes:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">        - A favorites section with a count of favorite ROMs.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a><span class="sd">        - An &quot;All&quot; section with a count of all available ROMs.</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="sd">        - A separator line for visual clarity.</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="sd">        - A list of systems with their respective ROM counts.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="sd">        The visual elements are styled using curses color pairs to indicate</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">        selection and different categories.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">        Attributes:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">            self.system_window (curses.window): The window object where the system</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">                selection is drawn.</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a><span class="sd">            self.view_mode (str): The current view mode, which can be &quot;favorites&quot;,</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="sd">                &quot;all&quot;, or &quot;systems&quot;.</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">            self.favorites (dict): A dictionary containing favorite ROMs categorized</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a><span class="sd">                by system.</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="sd">            self.all_roms (list): A list of all available ROMs.</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">            self.roms (dict): A dictionary containing ROMs categorized by system.</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">            self.selected_system (int): The index of the currently selected system</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">                in the systems list.</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_borders</span><span class="p">()</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>        <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>  <span class="c1"># Start below the border</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>        <span class="c1"># Favorites view with icon</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>        <span class="n">favorites_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">roms</span><span class="p">)</span> <span class="k">for</span> <span class="n">roms</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>        <span class="n">fav_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; Favorites (</span><span class="si">{</span><span class="n">favorites_count</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fav_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>            <span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fav_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">FAVORITE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>            <span class="p">)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>        <span class="c1"># ALL category with icon</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>        <span class="n">all_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; All (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">all_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>            <span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">all_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>            <span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>        <span class="c1"># Separator with nice pattern</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>        <span class="c1"># Systems with ROM counts and icons</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>        <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">system</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">systems</span><span class="p">):</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>            <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="p">[</span><span class="n">system</span><span class="p">])</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>            <span class="n">system_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">:</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>                    <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">system_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>                <span class="p">)</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>                    <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">system_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>                <span class="p">)</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>            <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>    <span class="k">def</span> <span class="nf">draw_rom_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="sd">        Draws the ROM selection window with borders, ROM entries, and additional information.</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">        This method clears the current ROM window, draws borders, and populates the window</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">        with a list of ROMs based on the current view mode (systems, all, or favorites).</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">        It handles scrolling, selection highlighting, and displays ROM names along with their</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">        sizes. If a ROM is marked as a favorite, it adds a star icon next to its name.</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">        The method also manages scrolling for long ROM names when they are selected and ensures</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">        that the display is updated accordingly.</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">        Attributes:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">            self.rom_window (curses.window): The window object where ROMs are displayed.</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">            self.view_mode (str): The current view mode (&quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;).</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">            self.roms (dict): Dictionary containing ROMs categorized by systems.</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">            self.filtered_roms (dict): Dictionary containing filtered ROMs based on the view mode.</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="sd">            self.selected_system (int): Index of the currently selected system.</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">            self.selected_rom (int): Index of the currently selected ROM.</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">            self.total_roms (int): Total number of ROMs in the current view.</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">            self.current_rom_index (int): Index of the currently selected ROM (1-based).</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">            self.focus (str): The current focus of the application (&quot;roms&quot; or other).</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">            self.last_selection_change_time (float): Timestamp of the last selection change.</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a><span class="sd">        Raises:</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a><span class="sd">            Exception: If there is an error retrieving the file size of a ROM.</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_borders</span><span class="p">()</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="n">rom_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>            <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>            <span class="k">if</span> <span class="n">systems</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>                <span class="n">selected_system_name</span> <span class="o">=</span> <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>                <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_system_name</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="n">viewable_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Account for borders</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>        <span class="n">num_roms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_list</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>        <span class="c1"># Update counters</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span> <span class="o">=</span> <span class="n">num_roms</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_rom_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">num_roms</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="c1"># Calculate scrolling</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>        <span class="k">if</span> <span class="n">num_roms</span> <span class="o">&lt;=</span> <span class="n">viewable_height</span><span class="p">:</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>            <span class="n">top_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>                <span class="n">top_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>                <span class="n">top_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">-</span> <span class="p">(</span><span class="n">viewable_height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>            <span class="n">top_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">top_index</span><span class="p">,</span> <span class="n">num_roms</span> <span class="o">-</span> <span class="n">viewable_height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rom_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rom_list</span><span class="p">[</span><span class="n">top_index</span> <span class="p">:</span> <span class="n">top_index</span> <span class="o">+</span> <span class="n">viewable_height</span><span class="p">]):</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># Start below the border</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>            <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">viewable_height</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>                <span class="k">break</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>            <span class="c1"># Determine ROM display information</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]:</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>                <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>                <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>            <span class="c1"># Add favorite star if needed</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_favorite</span><span class="p">(</span><span class="n">rom_path</span><span class="p">):</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">rom_name</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">rom_name</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>            <span class="c1"># Get file size</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>                <span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>                <span class="n">file_size_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_size</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>                <span class="n">file_size_str</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>            <span class="c1"># Calculate display positions</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>            <span class="n">win_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>            <span class="n">size_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_size_str</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>            <span class="n">name_width</span> <span class="o">=</span> <span class="n">win_width</span> <span class="o">-</span> <span class="n">size_width</span> <span class="o">-</span> <span class="mi">2</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>            <span class="c1"># Determine display attributes</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>            <span class="n">is_selected</span> <span class="o">=</span> <span class="p">(</span><span class="n">top_index</span> <span class="o">+</span> <span class="n">i</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>            <span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>            <span class="k">if</span> <span class="n">is_selected</span><span class="p">:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_favorite</span><span class="p">(</span><span class="n">rom_path</span><span class="p">):</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">FAVORITE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>            <span class="c1"># Handle scrolling for long names</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>            <span class="k">if</span> <span class="n">is_selected</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">name_width</span><span class="p">:</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>                <span class="n">scroll_speed</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>                <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>                <span class="n">time_since_selection</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_selection_change_time</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>                <span class="n">scroll_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_since_selection</span> <span class="o">*</span> <span class="n">scroll_speed</span><span class="p">)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>                <span class="n">scroll_offset</span> <span class="o">=</span> <span class="n">scroll_offset</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rom_name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>                <span class="n">display_name</span> <span class="o">=</span> <span class="n">rom_name</span> <span class="o">+</span> <span class="s2">&quot;     &quot;</span> <span class="o">+</span> <span class="n">rom_name</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>                <span class="n">display_name</span> <span class="o">=</span> <span class="n">display_name</span><span class="p">[</span><span class="n">scroll_offset</span> <span class="p">:</span> <span class="n">scroll_offset</span> <span class="o">+</span> <span class="n">name_width</span><span class="p">]</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>                <span class="n">display_name</span> <span class="o">=</span> <span class="n">rom_name</span><span class="p">[:</span><span class="n">name_width</span><span class="p">]</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>            <span class="c1"># Draw the ROM entry</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">display_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">name_width</span><span class="p">),</span> <span class="n">attr</span><span class="p">)</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">name_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">file_size_str</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>    <span class="k">def</span> <span class="nf">launch_rom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emulator_path</span><span class="p">,</span> <span class="n">launch_arguments</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">,</span> <span class="n">start_in_directory</span><span class="p">):</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">        Launches a ROM using the specified emulator and arguments.</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="sd">        Args:</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a><span class="sd">            emulator_path (str): The file path to the emulator executable.</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a><span class="sd">            launch_arguments (str): The arguments to pass to the emulator. Use &quot;{rom_path}&quot; as a placeholder for the ROM path.</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="sd">            rom_path (str): The file path to the ROM to be launched.</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a><span class="sd">            start_in_directory (str): The directory to set as the working directory when launching the emulator.</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a><span class="sd">        Raises:</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="sd">            subprocess.CalledProcessError: If there is an error launching the emulator.</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a><span class="sd">            FileNotFoundError: If the emulator executable is not found at the specified path.</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>        <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="n">emulator_path</span><span class="p">]</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>        <span class="k">if</span> <span class="n">launch_arguments</span><span class="p">:</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="n">launch_arguments</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>                <span class="k">if</span> <span class="s2">&quot;</span><span class="si">{rom_path}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>                    <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{rom_path}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>            <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>        <span class="c1"># print(f&quot;Launching: {&#39; &#39;.join(command)}&quot;)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>                <span class="n">command</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">start_in_directory</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>            <span class="p">)</span>  <span class="c1"># Set working directory</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error launching emulator: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Emulator not found at: </span><span class="si">{</span><span class="n">emulator_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>    <span class="k">def</span> <span class="nf">update_filtered_roms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">        Updates the list of filtered ROMs based on the filter string and view mode.</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">        This method filters the ROMs according to the current filter string and view mode.</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">        The view modes can be &quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;. Depending on the view mode,</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        the filtered ROMs are updated as follows:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        - &quot;systems&quot;: Filters ROMs within each system based on the filter string.</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">        - &quot;all&quot;: Filters all ROMs across all systems based on the filter string.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">        - &quot;favorites&quot;: Filters favorite ROMs based on the filter string.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">        If the filter string is empty, the filtered ROMs list is set to the full list of ROMs</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">        for the current view mode.</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">        Attributes:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">            filter_string (str): The string used to filter ROMs.</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">            view_mode (str): The current view mode (&quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;).</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">            roms (dict): A dictionary of ROMs categorized by system.</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">            all_roms (list): A list of all ROMs across all systems.</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">            filtered_roms (dict): A dictionary of filtered ROMs based on the filter string and view mode.</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a><span class="sd">            get_favorite_roms_with_system (function): A function that returns favorite ROMs with their systems.</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">:</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">roms</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;all&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span><span class="p">}</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;favorites&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_favorite_roms_with_system</span><span class="p">()}</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>            <span class="k">return</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>            <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">roms</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="p">[</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>                    <span class="n">rom</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>                    <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">roms</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>                <span class="p">]</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>                <span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rom</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>                <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">rom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>            <span class="p">]</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>            <span class="n">favorite_roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_favorite_roms_with_system</span><span class="p">()</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="p">[</span><span class="s2">&quot;favorites&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>                <span class="n">rom_data</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>                <span class="k">for</span> <span class="n">rom_data</span> <span class="ow">in</span> <span class="n">favorite_roms</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>            <span class="p">]</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>    <span class="k">def</span> <span class="nf">get_favorite_roms_with_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="sd">        Returns a list of favorite ROMs with their system names.</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">        This method iterates through the &#39;favorites&#39; dictionary, which contains</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a><span class="sd">        system names as keys and lists of favorite ROMs as values. It creates a</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="sd">        list of tuples, where each tuple contains a system name and a ROM name.</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="sd">        Returns:</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a><span class="sd">            list of tuple: A list of tuples, where each tuple contains a system</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">            name (str) and a ROM name (str).</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>        <span class="n">favorite_roms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">roms</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>            <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">roms</span><span class="p">:</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>                <span class="n">favorite_roms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">system</span><span class="p">,</span> <span class="n">rom</span><span class="p">))</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>        <span class="k">return</span> <span class="n">favorite_roms</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>    <span class="k">def</span> <span class="nf">toggle_favorite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">        Toggles the favorite status of the currently selected ROM.</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">        Depending on the current view mode, this method will:</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a><span class="sd">        - In &quot;systems&quot; view mode: Toggle the favorite status of the selected ROM within the selected system.</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="sd">        - In &quot;all&quot; view mode: Toggle the favorite status of the selected ROM from the complete list of ROMs.</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a><span class="sd">        - In &quot;favorites&quot; view mode: Toggle the favorite status of the selected ROM from the list of favorite ROMs.</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="sd">        After toggling the favorite status, the method updates the filtered ROMs list and redraws the ROM window.</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a><span class="sd">        It also ensures that the ROM selection position is restored and within bounds.</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="sd">        Attributes:</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="sd">            self.selected_rom (int): The index of the currently selected ROM.</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">            self.view_mode (str): The current view mode (&quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;).</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">            self.roms (dict): A dictionary containing ROMs categorized by systems.</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="sd">            self.filtered_roms (dict): A dictionary containing filtered ROMs based on the current view mode.</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a><span class="sd">            self.favorites (dict): A dictionary containing favorite ROMs categorized by systems.</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a><span class="sd">            self.selected_system (int): The index of the currently selected system.</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="sd">        Methods:</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="sd">            self.save_favorites(): Saves the current state of favorite ROMs.</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a><span class="sd">            self.toggle_favorite_by_system_and_path(system, rom_path): Toggles the favorite status of a ROM by system and path.</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a><span class="sd">            self.update_filtered_roms(): Updates the list of filtered ROMs based on the current view mode.</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a><span class="sd">            self.draw_rom_window(): Redraws the ROM window to reflect the current state.</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>        <span class="n">current_rom_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span>  <span class="c1"># Store the current ROM index</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>            <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>            <span class="k">if</span> <span class="n">systems</span><span class="p">:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>                <span class="n">selected_system_name</span> <span class="o">=</span> <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>                <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_system_name</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>                <span class="k">if</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>                    <span class="n">selected_rom_path</span> <span class="o">=</span> <span class="n">rom_list</span><span class="p">[</span><span class="n">current_rom_index</span><span class="p">]</span>  <span class="c1"># Use stored index</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>                    <span class="k">if</span> <span class="n">selected_system_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">:</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>                    <span class="k">if</span> <span class="n">selected_rom_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]:</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">selected_rom_path</span><span class="p">)</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selected_rom_path</span><span class="p">)</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]:</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">save_favorites</span><span class="p">()</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>            <span class="n">rom_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])[</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>                <span class="n">current_rom_index</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="p">]</span>  <span class="c1"># Use stored index</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>            <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite_by_system_and_path</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">)</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>            <span class="n">rom_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])[</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>                <span class="n">current_rom_index</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>            <span class="p">]</span>  <span class="c1"># Use stored index</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>            <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite_by_system_and_path</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">)</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>        <span class="c1"># Restore the ROM selection position</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">],</span> <span class="p">[])</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>        <span class="c1"># Ensure the stored index is within bounds</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">current_rom_index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Ensure it&#39;s not negative</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>    <span class="k">def</span> <span class="nf">toggle_favorite_by_system_and_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">):</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">        Toggles the favorite status of a ROM by its system and path.</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">        If the ROM is already a favorite, it will be removed from the favorites list.</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">        If the ROM is not a favorite, it will be added to the favorites list.</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">        Args:</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">            system (str): The system to which the ROM belongs.</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">            rom_path (str): The file path of the ROM.</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a><span class="sd">        Returns:</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="sd">            None</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>        <span class="k">if</span> <span class="n">system</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">:</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>        <span class="k">if</span> <span class="n">rom_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]:</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]:</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">save_favorites</span><span class="p">()</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>    <span class="k">def</span> <span class="nf">is_favorite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">):</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="sd">        Check if a ROM is marked as a favorite.</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a><span class="sd">        Args:</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">            rom_path (str): The file path of the ROM to check.</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">        Returns:</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">            bool: True if the ROM is a favorite, False otherwise.</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">favorites</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>            <span class="k">if</span> <span class="n">rom_path</span> <span class="ow">in</span> <span class="n">favorites</span><span class="p">:</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>    <span class="k">def</span> <span class="nf">handle_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">        Handles user input for navigating and filtering ROMs.</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="sd">        Parameters:</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">        key (int): The key code of the pressed key.</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">        Behavior:</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="sd">        - In &quot;filter&quot; mode:</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a><span class="sd">            - Escape key (27): Switch to &quot;navigate&quot; mode, clear filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a><span class="sd">            - Enter key (10): Launch the selected ROM.</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a><span class="sd">            - Backspace key (curses.KEY_BACKSPACE, 127, 8): Remove the last character from the filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a><span class="sd">            - Up key (curses.KEY_UP): Move the selection up in the filtered ROM list.</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a><span class="sd">            - Down key (curses.KEY_DOWN): Move the selection down in the filtered ROM list.</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="sd">            - F2 key (curses.KEY_F2): Toggle favorite status of the selected ROM if focus is on ROMs.</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a><span class="sd">            - Printable characters (32-126): Append the character to the filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a><span class="sd">        - In &quot;navigate&quot; mode:</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a><span class="sd">            - Up key (curses.KEY_UP): Navigate through ROMs or switch view modes and systems.</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a><span class="sd">            - Down key (curses.KEY_DOWN): Navigate through ROMs or switch view modes and systems.</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="sd">            - Left key (curses.KEY_LEFT): Set focus to systems.</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="sd">            - Right key (curses.KEY_RIGHT): Set focus to ROMs.</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">            - Slash key (ord(&quot;/&quot;)): Switch to &quot;filter&quot; mode, clear filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">            - Enter key (10): Launch the selected ROM.</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a><span class="sd">            - F2 key (curses.KEY_F2): Toggle favorite status of the selected ROM if focus is on ROMs.</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">        Updates:</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">        - Updates the timestamp if any selection state changes.</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">        - Redraws the ROM window, system window, and filter bar.</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="n">prev_selected_rom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>        <span class="n">prev_view_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>        <span class="n">prev_selected_system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>        <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>        <span class="n">num_systems</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">systems</span><span class="p">)</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>        <span class="n">rom_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="n">systems</span><span class="p">:</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>            <span class="n">selected_system_name</span> <span class="o">=</span> <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_system_name</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>        <span class="n">num_roms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_list</span><span class="p">)</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;filter&quot;</span><span class="p">:</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>  <span class="c1"># Escape key</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># Enter key in filter mode</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">launch_selected_rom</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">rom_list</span><span class="p">)</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_BACKSPACE</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">127</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">:</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">:</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">:</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">&lt;</span> <span class="n">num_roms</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_F2</span><span class="p">:</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span><span class="p">:</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite</span><span class="p">()</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">&gt;=</span> <span class="mi">32</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">&lt;=</span> <span class="mi">126</span><span class="p">:</span>  <span class="c1"># Printable characters</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Navigate mode</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">:</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span> <span class="ow">and</span> <span class="n">num_roms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">num_roms</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">=</span> <span class="n">num_systems</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">num_systems</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;favorites&quot;</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">:</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span> <span class="ow">and</span> <span class="n">num_roms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">num_roms</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">num_systems</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">&lt;</span> <span class="n">num_systems</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>                    <span class="p">):</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">==</span> <span class="n">num_systems</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>                    <span class="p">):</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;favorites&quot;</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">:</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">:</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="s2">&quot;roms&quot;</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;filter&quot;</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># Enter key in navigate mode</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">launch_selected_rom</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">rom_list</span><span class="p">)</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_F2</span><span class="p">:</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span><span class="p">:</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite</span><span class="p">()</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>            <span class="c1"># Update timestamp if any selection state changed</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>            <span class="n">prev_selected_rom</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>            <span class="ow">or</span> <span class="n">prev_view_mode</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>            <span class="ow">or</span> <span class="n">prev_selected_system</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>        <span class="p">):</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_selection_change_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_system_window</span><span class="p">()</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>    <span class="k">def</span> <span class="nf">launch_selected_rom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">systems</span><span class="p">,</span> <span class="n">rom_list</span><span class="p">):</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="sd">        Launches the selected ROM using the appropriate emulator configuration.</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">        Args:</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">            systems (list): A list of available systems.</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">            rom_list (list): A list of ROMs available for the selected system.</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">        Preconditions:</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">            - `self.focus` must be &quot;roms&quot;.</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="sd">            - `self.emulator_process` must be None.</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a><span class="sd">            - `rom_list` must not be empty.</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a><span class="sd">        Behavior:</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a><span class="sd">            - If `self.view_mode` is &quot;systems&quot;:</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a><span class="sd">                - Retrieves the system configuration for the selected system.</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="sd">                - Launches the ROM using the emulator path and launch arguments from the system configuration.</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">            - If `self.view_mode` is &quot;favorites&quot; or &quot;all&quot;:</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="sd">                - Retrieves the system and ROM path for the selected ROM.</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">                - Launches the ROM using the emulator path and launch arguments from the system configuration.</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a><span class="sd">        Postconditions:</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">            - Clears the filter string.</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="sd">            - Updates the filtered ROMs list.</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="sd">            - Resets the selected ROM index to 0.</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>                <span class="n">system_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;systems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>                    <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>                <span class="p">)</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>                <span class="k">if</span> <span class="n">system_config</span> <span class="ow">and</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>                    <span class="n">start_in_directory</span> <span class="o">=</span> <span class="n">system_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_in&quot;</span><span class="p">)</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">launch_rom</span><span class="p">(</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;emulator_path&quot;</span><span class="p">],</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;launch_arguments&quot;</span><span class="p">],</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>                        <span class="n">rom_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">],</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>                        <span class="n">start_in_directory</span><span class="p">,</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>                    <span class="p">)</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>                <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">]</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>                <span class="n">system_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;systems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>                <span class="k">if</span> <span class="n">system_config</span><span class="p">:</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>                    <span class="n">start_in_directory</span> <span class="o">=</span> <span class="n">system_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_in&quot;</span><span class="p">)</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">launch_rom</span><span class="p">(</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;emulator_path&quot;</span><span class="p">],</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;launch_arguments&quot;</span><span class="p">],</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>                        <span class="n">rom_path</span><span class="p">,</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>                        <span class="n">start_in_directory</span><span class="p">,</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>                    <span class="p">)</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>            <span class="c1"># Clear filter and update display after launching</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>    <span class="k">def</span> <span class="nf">draw_filter_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a><span class="sd">        Draws the filter bar at the bottom of the terminal window.</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a><span class="sd">        This method clears the current status bar, sets the appropriate style,</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a><span class="sd">        and displays the current status based on the mode (filter or ready).</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a><span class="sd">        It also ensures that the status bar text fits within the window width.</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a><span class="sd">        The status bar displays different information based on the mode:</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a><span class="sd">        - In &quot;filter&quot; mode, it shows the filter string and the current ROM count.</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="sd">        - In &quot;ready&quot; mode, it shows a ready message and the current ROM count.</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">        The status bar also includes help text with key bindings for various actions.</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">        Attributes:</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">            height (int): The height of the terminal window.</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">            width (int): The width of the terminal window.</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">            current_rom (int): The index of the current ROM.</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">            counter (str): The string representing the current ROM count.</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a><span class="sd">            status (str): The status message to be displayed.</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a><span class="sd">            help_text (str): The help text with key bindings.</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a><span class="sd">            total_length (int): The total length of the status and help text.</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">            padding (int): The padding to ensure the text fits within the window width.</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="sd">            final_text (str): The final text to be displayed on the status bar.</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>        <span class="c1"># Clear the status bar</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">clrtoeol</span><span class="p">()</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>        <span class="c1"># Set status bar style</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">attron</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">STATUS_BAR</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>        <span class="n">current_rom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_rom_index</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>        <span class="n">counter</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">current_rom</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;filter&quot;</span><span class="p">:</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; / </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="si">}{</span><span class="n">counter</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>            <span class="n">help_text</span> <span class="o">=</span> <span class="s2">&quot;ESC:Exit  ENTER/A:Launch  F2/X:Favorite  Q/B:Quit&quot;</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; Ready</span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>            <span class="n">help_text</span> <span class="o">=</span> <span class="s2">&quot;/:Search  ENTER/A:Launch  F2/X:Favorite  Q/B:Quit&quot;</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>        <span class="c1"># Calculate padding, ensuring we don&#39;t exceed the window width</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>        <span class="n">total_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">help_text</span><span class="p">)</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>        <span class="n">padding</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span> <span class="o">-</span> <span class="n">total_length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Leave one character at the end</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>        <span class="c1"># Ensure we don&#39;t write beyond the last column</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>        <span class="n">final_text</span> <span class="o">=</span> <span class="p">(</span><span class="n">status</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">help_text</span><span class="p">)[:</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>        <span class="c1"># Draw status bar</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">final_text</span><span class="p">)</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">attroff</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">STATUS_BAR</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>    <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stdscr</span><span class="p">):</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">        Main function to initialize and run the ROM launcher interface.</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">        Args:</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">            stdscr: The standard screen object provided by curses.</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">        This function sets up the curses environment, initializes pygame for gamepad support,</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a><span class="sd">        and enters the main loop to handle user input and update the display. It supports both</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="sd">        keyboard and gamepad inputs, with auto-repeat functionality for gamepad D-pad and joystick axes.</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">        The interface is divided into two windows: one for system selection and one for ROM selection.</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">        The function also handles window resizing and checks for the completion of the emulator process.</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span> <span class="o">=</span> <span class="n">stdscr</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">keypad</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">curs_set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">init_colors</span><span class="p">()</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>        <span class="c1"># Initialize pygame for gamepad support.</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>        <span class="k">if</span> <span class="n">pygame</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">Joystick</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>            <span class="c1"># print(&quot;Controller connected:&quot;, self.joystick.get_name())</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>            <span class="c1"># print(&quot;No controller found.&quot;)</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">nodelay</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>        <span class="c1"># Calculate split for windows.</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>        <span class="n">system_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">4</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>        <span class="n">rom_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">system_width</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">system_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rom_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">system_width</span><span class="p">)</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_system_window</span><span class="p">()</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>        <span class="c1"># Timing parameters (in seconds)</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>        <span class="n">initial_delay</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Delay before auto-repeat kicks in</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>        <span class="n">repeat_interval</span> <span class="o">=</span> <span class="mf">0.04</span>  <span class="c1"># Interval between repeats after initial delay</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>        <span class="c1"># Timing parameters for scroll updates</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>        <span class="n">last_scroll_time</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>        <span class="n">scroll_interval</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># 100 milliseconds</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        <span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>        <span class="k">while</span> <span class="n">running</span><span class="p">:</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>            <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>            <span class="k">if</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">last_scroll_time</span> <span class="o">&gt;=</span> <span class="n">scroll_interval</span><span class="p">:</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>                <span class="n">last_scroll_time</span> <span class="o">=</span> <span class="n">current_time</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>            <span class="c1"># Process keyboard input.</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getch</span><span class="p">()</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_RESIZE</span><span class="p">:</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>                    <span class="c1"># Handle window resize</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>                    <span class="n">curses</span><span class="o">.</span><span class="n">resize_term</span><span class="p">(</span><span class="o">*</span><span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">())</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>                    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>                    <span class="n">system_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">4</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>                    <span class="n">rom_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">system_width</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">system_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>                        <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rom_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">system_width</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>                    <span class="p">)</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>                    <span class="n">stdscr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>                    <span class="n">curses</span><span class="o">.</span><span class="n">curs_set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Re-hide cursor after resize</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">init_colors</span><span class="p">()</span>  <span class="c1"># Re-initialize colors if necessary</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_system_window</span><span class="p">()</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>                <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>                    <span class="n">key</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">)</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>                <span class="p">):</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>                    <span class="k">break</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>            <span class="c1"># Process pygame events for button presses.</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">JOYBUTTONDOWN</span><span class="p">:</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Typically A button.</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Enter key.</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Typically B button.</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>                        <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Example: X button.</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_F2</span><span class="p">)</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>                <span class="c1"># We poll the hat state below for auto-repeat.</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>            <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>                <span class="c1"># ----- Process D-pad (hat) with initial delay auto-repeat -----</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>                <span class="n">hat_x</span><span class="p">,</span> <span class="n">hat_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_hat</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>                <span class="c1"># For UP</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>                <span class="k">if</span> <span class="n">hat_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>                    <span class="p">):</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>                <span class="c1"># For DOWN</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>                <span class="k">if</span> <span class="n">hat_y</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>                    <span class="p">):</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>                <span class="c1"># For RIGHT</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>                <span class="k">if</span> <span class="n">hat_x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>                    <span class="p">):</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>                <span class="c1"># For LEFT</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>                <span class="k">if</span> <span class="n">hat_x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>                    <span class="p">):</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>                <span class="c1"># ----- Process Joystick Axes if D-pad is neutral -----</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">hat_x</span><span class="p">,</span> <span class="n">hat_y</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>                    <span class="n">axis_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>                    <span class="n">axis_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>                    <span class="c1"># For UP</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>                    <span class="k">if</span> <span class="n">axis_y</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">:</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>                        <span class="p">):</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>                    <span class="c1"># For DOWN</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>                    <span class="k">if</span> <span class="n">axis_y</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>                        <span class="p">):</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>                    <span class="c1"># For LEFT</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>                    <span class="k">if</span> <span class="n">axis_x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">:</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>                        <span class="p">):</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>                    <span class="c1"># For RIGHT</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>                    <span class="k">if</span> <span class="n">axis_x</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>                        <span class="p">):</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>            <span class="c1"># Check if the emulator process has finished.</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>    <span class="n">launcher</span> <span class="o">=</span> <span class="n">EmulatorLauncher</span><span class="p">()</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>    <span class="n">curses</span><span class="o">.</span><span class="n">wrapper</span><span class="p">(</span><span class="n">launcher</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>    <span class="n">main</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="Colors">
                            <input id="Colors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Colors</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="Colors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Colors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Colors-18"><a href="#Colors-18"><span class="linenos">18</span></a><span class="k">class</span> <span class="nc">Colors</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Colors-19"><a href="#Colors-19"><span class="linenos">19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Colors-20"><a href="#Colors-20"><span class="linenos">20</span></a><span class="sd">    Enum class representing different color codes used in the application.</span>
</span><span id="Colors-21"><a href="#Colors-21"><span class="linenos">21</span></a>
</span><span id="Colors-22"><a href="#Colors-22"><span class="linenos">22</span></a><span class="sd">    Attributes:</span>
</span><span id="Colors-23"><a href="#Colors-23"><span class="linenos">23</span></a><span class="sd">        HEADER (int): Color code for header elements.</span>
</span><span id="Colors-24"><a href="#Colors-24"><span class="linenos">24</span></a><span class="sd">        SELECTED (int): Color code for selected items.</span>
</span><span id="Colors-25"><a href="#Colors-25"><span class="linenos">25</span></a><span class="sd">        FAVORITE (int): Color code for favorite items.</span>
</span><span id="Colors-26"><a href="#Colors-26"><span class="linenos">26</span></a><span class="sd">        NORMAL (int): Color code for normal items.</span>
</span><span id="Colors-27"><a href="#Colors-27"><span class="linenos">27</span></a><span class="sd">        HIGHLIGHT (int): Color code for highlighted items.</span>
</span><span id="Colors-28"><a href="#Colors-28"><span class="linenos">28</span></a><span class="sd">        STATUS_BAR (int): Color code for the status bar.</span>
</span><span id="Colors-29"><a href="#Colors-29"><span class="linenos">29</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Colors-30"><a href="#Colors-30"><span class="linenos">30</span></a>
</span><span id="Colors-31"><a href="#Colors-31"><span class="linenos">31</span></a>    <span class="n">HEADER</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Colors-32"><a href="#Colors-32"><span class="linenos">32</span></a>    <span class="n">SELECTED</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Colors-33"><a href="#Colors-33"><span class="linenos">33</span></a>    <span class="n">FAVORITE</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="Colors-34"><a href="#Colors-34"><span class="linenos">34</span></a>    <span class="n">NORMAL</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="Colors-35"><a href="#Colors-35"><span class="linenos">35</span></a>    <span class="n">HIGHLIGHT</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="Colors-36"><a href="#Colors-36"><span class="linenos">36</span></a>    <span class="n">STATUS_BAR</span> <span class="o">=</span> <span class="mi">6</span>
</span></pre></div>


            <div class="docstring"><p>Enum class representing different color codes used in the application.</p>

<p>Attributes:
    HEADER (int): Color code for header elements.
    SELECTED (int): Color code for selected items.
    FAVORITE (int): Color code for favorite items.
    NORMAL (int): Color code for normal items.
    HIGHLIGHT (int): Color code for highlighted items.
    STATUS_BAR (int): Color code for the status bar.</p>
</div>


                            <div id="Colors.HEADER" class="classattr">
                                <div class="attr variable">
            <span class="name">HEADER</span>        =
<span class="default_value">&lt;<a href="#Colors.HEADER">Colors.HEADER</a>: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#Colors.HEADER"></a>
    
    

                            </div>
                            <div id="Colors.SELECTED" class="classattr">
                                <div class="attr variable">
            <span class="name">SELECTED</span>        =
<span class="default_value">&lt;<a href="#Colors.SELECTED">Colors.SELECTED</a>: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#Colors.SELECTED"></a>
    
    

                            </div>
                            <div id="Colors.FAVORITE" class="classattr">
                                <div class="attr variable">
            <span class="name">FAVORITE</span>        =
<span class="default_value">&lt;<a href="#Colors.FAVORITE">Colors.FAVORITE</a>: 3&gt;</span>

        
    </div>
    <a class="headerlink" href="#Colors.FAVORITE"></a>
    
    

                            </div>
                            <div id="Colors.NORMAL" class="classattr">
                                <div class="attr variable">
            <span class="name">NORMAL</span>        =
<span class="default_value">&lt;<a href="#Colors.NORMAL">Colors.NORMAL</a>: 4&gt;</span>

        
    </div>
    <a class="headerlink" href="#Colors.NORMAL"></a>
    
    

                            </div>
                            <div id="Colors.HIGHLIGHT" class="classattr">
                                <div class="attr variable">
            <span class="name">HIGHLIGHT</span>        =
<span class="default_value">&lt;<a href="#Colors.HIGHLIGHT">Colors.HIGHLIGHT</a>: 5&gt;</span>

        
    </div>
    <a class="headerlink" href="#Colors.HIGHLIGHT"></a>
    
    

                            </div>
                            <div id="Colors.STATUS_BAR" class="classattr">
                                <div class="attr variable">
            <span class="name">STATUS_BAR</span>        =
<span class="default_value">&lt;<a href="#Colors.STATUS_BAR">Colors.STATUS_BAR</a>: 6&gt;</span>

        
    </div>
    <a class="headerlink" href="#Colors.STATUS_BAR"></a>
    
    

                            </div>
                </section>
                <section id="EmulatorLauncher">
                            <input id="EmulatorLauncher-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">EmulatorLauncher</span>:

                <label class="view-source-button" for="EmulatorLauncher-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher-39"><a href="#EmulatorLauncher-39"><span class="linenos">  39</span></a><span class="k">class</span> <span class="nc">EmulatorLauncher</span><span class="p">:</span>
</span><span id="EmulatorLauncher-40"><a href="#EmulatorLauncher-40"><span class="linenos">  40</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-41"><a href="#EmulatorLauncher-41"><span class="linenos">  41</span></a><span class="sd">    EmulatorLauncher is a class that manages the launching and navigation of ROMs for various emulators.</span>
</span><span id="EmulatorLauncher-42"><a href="#EmulatorLauncher-42"><span class="linenos">  42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-43"><a href="#EmulatorLauncher-43"><span class="linenos">  43</span></a>
</span><span id="EmulatorLauncher-44"><a href="#EmulatorLauncher-44"><span class="linenos">  44</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-45"><a href="#EmulatorLauncher-45"><span class="linenos">  45</span></a>        <span class="c1"># config</span>
</span><span id="EmulatorLauncher-46"><a href="#EmulatorLauncher-46"><span class="linenos">  46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">app_name</span> <span class="o">=</span> <span class="s2">&quot;nobsrom&quot;</span>
</span><span id="EmulatorLauncher-47"><a href="#EmulatorLauncher-47"><span class="linenos">  47</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The name of the application.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-48"><a href="#EmulatorLauncher-48"><span class="linenos">  48</span></a>
</span><span id="EmulatorLauncher-49"><a href="#EmulatorLauncher-49"><span class="linenos">  49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vendor_name</span> <span class="o">=</span> <span class="s2">&quot;D221&quot;</span>
</span><span id="EmulatorLauncher-50"><a href="#EmulatorLauncher-50"><span class="linenos">  50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The vendor name associated with the application.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-51"><a href="#EmulatorLauncher-51"><span class="linenos">  51</span></a>
</span><span id="EmulatorLauncher-52"><a href="#EmulatorLauncher-52"><span class="linenos">  52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">=</span> <span class="n">user_config_path</span><span class="p">(</span>
</span><span id="EmulatorLauncher-53"><a href="#EmulatorLauncher-53"><span class="linenos">  53</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">app_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vendor_name</span><span class="p">,</span> <span class="n">ensure_exists</span><span class="o">=</span><span class="kc">True</span>
</span><span id="EmulatorLauncher-54"><a href="#EmulatorLauncher-54"><span class="linenos">  54</span></a>        <span class="p">)</span>
</span><span id="EmulatorLauncher-55"><a href="#EmulatorLauncher-55"><span class="linenos">  55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The directory path for storing user configuration files.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-56"><a href="#EmulatorLauncher-56"><span class="linenos">  56</span></a>
</span><span id="EmulatorLauncher-57"><a href="#EmulatorLauncher-57"><span class="linenos">  57</span></a>        <span class="c1"># Set default file paths if not specified</span>
</span><span id="EmulatorLauncher-58"><a href="#EmulatorLauncher-58"><span class="linenos">  58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="s2">&quot;config.yaml&quot;</span>
</span><span id="EmulatorLauncher-59"><a href="#EmulatorLauncher-59"><span class="linenos">  59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The file path for the configuration file.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-60"><a href="#EmulatorLauncher-60"><span class="linenos">  60</span></a>
</span><span id="EmulatorLauncher-61"><a href="#EmulatorLauncher-61"><span class="linenos">  61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="s2">&quot;favorites.yaml&quot;</span>
</span><span id="EmulatorLauncher-62"><a href="#EmulatorLauncher-62"><span class="linenos">  62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The file path for the favorites file.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-63"><a href="#EmulatorLauncher-63"><span class="linenos">  63</span></a>
</span><span id="EmulatorLauncher-64"><a href="#EmulatorLauncher-64"><span class="linenos">  64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_config</span><span class="p">()</span>
</span><span id="EmulatorLauncher-65"><a href="#EmulatorLauncher-65"><span class="linenos">  65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The loaded configuration dictionary.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-66"><a href="#EmulatorLauncher-66"><span class="linenos">  66</span></a>
</span><span id="EmulatorLauncher-67"><a href="#EmulatorLauncher-67"><span class="linenos">  67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_favorites</span><span class="p">()</span>
</span><span id="EmulatorLauncher-68"><a href="#EmulatorLauncher-68"><span class="linenos">  68</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The loaded favorites dictionary.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-69"><a href="#EmulatorLauncher-69"><span class="linenos">  69</span></a>
</span><span id="EmulatorLauncher-70"><a href="#EmulatorLauncher-70"><span class="linenos">  70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-71"><a href="#EmulatorLauncher-71"><span class="linenos">  71</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A dictionary of ROMs categorized by system.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-72"><a href="#EmulatorLauncher-72"><span class="linenos">  72</span></a>
</span><span id="EmulatorLauncher-73"><a href="#EmulatorLauncher-73"><span class="linenos">  73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_all_roms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="p">)</span>
</span><span id="EmulatorLauncher-74"><a href="#EmulatorLauncher-74"><span class="linenos">  74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A list of all ROMs across all systems.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-75"><a href="#EmulatorLauncher-75"><span class="linenos">  75</span></a>
</span><span id="EmulatorLauncher-76"><a href="#EmulatorLauncher-76"><span class="linenos">  76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-77"><a href="#EmulatorLauncher-77"><span class="linenos">  77</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The index of the currently selected system.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-78"><a href="#EmulatorLauncher-78"><span class="linenos">  78</span></a>
</span><span id="EmulatorLauncher-79"><a href="#EmulatorLauncher-79"><span class="linenos">  79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-80"><a href="#EmulatorLauncher-80"><span class="linenos">  80</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The index of the currently selected ROM.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-81"><a href="#EmulatorLauncher-81"><span class="linenos">  81</span></a>
</span><span id="EmulatorLauncher-82"><a href="#EmulatorLauncher-82"><span class="linenos">  82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-83"><a href="#EmulatorLauncher-83"><span class="linenos">  83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The total number of ROMs in the current view.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-84"><a href="#EmulatorLauncher-84"><span class="linenos">  84</span></a>
</span><span id="EmulatorLauncher-85"><a href="#EmulatorLauncher-85"><span class="linenos">  85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_rom_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-86"><a href="#EmulatorLauncher-86"><span class="linenos">  86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The index of the currently selected ROM (1-based).&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-87"><a href="#EmulatorLauncher-87"><span class="linenos">  87</span></a>
</span><span id="EmulatorLauncher-88"><a href="#EmulatorLauncher-88"><span class="linenos">  88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher-89"><a href="#EmulatorLauncher-89"><span class="linenos">  89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The window object for displaying systems.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-90"><a href="#EmulatorLauncher-90"><span class="linenos">  90</span></a>
</span><span id="EmulatorLauncher-91"><a href="#EmulatorLauncher-91"><span class="linenos">  91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher-92"><a href="#EmulatorLauncher-92"><span class="linenos">  92</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The window object for displaying ROMs.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-93"><a href="#EmulatorLauncher-93"><span class="linenos">  93</span></a>
</span><span id="EmulatorLauncher-94"><a href="#EmulatorLauncher-94"><span class="linenos">  94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher-95"><a href="#EmulatorLauncher-95"><span class="linenos">  95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The process object for the running emulator.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-96"><a href="#EmulatorLauncher-96"><span class="linenos">  96</span></a>
</span><span id="EmulatorLauncher-97"><a href="#EmulatorLauncher-97"><span class="linenos">  97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher-98"><a href="#EmulatorLauncher-98"><span class="linenos">  98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The current focus of the application (either &#39;systems&#39; or &#39;roms&#39;).&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-99"><a href="#EmulatorLauncher-99"><span class="linenos">  99</span></a>
</span><span id="EmulatorLauncher-100"><a href="#EmulatorLauncher-100"><span class="linenos"> 100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="EmulatorLauncher-101"><a href="#EmulatorLauncher-101"><span class="linenos"> 101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The string used to filter ROMs.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-102"><a href="#EmulatorLauncher-102"><span class="linenos"> 102</span></a>
</span><span id="EmulatorLauncher-103"><a href="#EmulatorLauncher-103"><span class="linenos"> 103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher-104"><a href="#EmulatorLauncher-104"><span class="linenos"> 104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A dictionary of filtered ROMs based on the filter string and view mode.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-105"><a href="#EmulatorLauncher-105"><span class="linenos"> 105</span></a>
</span><span id="EmulatorLauncher-106"><a href="#EmulatorLauncher-106"><span class="linenos"> 106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_selection_change_time</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-107"><a href="#EmulatorLauncher-107"><span class="linenos"> 107</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the last selection change.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-108"><a href="#EmulatorLauncher-108"><span class="linenos"> 108</span></a>
</span><span id="EmulatorLauncher-109"><a href="#EmulatorLauncher-109"><span class="linenos"> 109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="EmulatorLauncher-110"><a href="#EmulatorLauncher-110"><span class="linenos"> 110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The current mode of the application (either &#39;navigate&#39; or &#39;filter&#39;).&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-111"><a href="#EmulatorLauncher-111"><span class="linenos"> 111</span></a>
</span><span id="EmulatorLauncher-112"><a href="#EmulatorLauncher-112"><span class="linenos"> 112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;favorites&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span> <span class="k">else</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher-113"><a href="#EmulatorLauncher-113"><span class="linenos"> 113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The current view mode (either &#39;favorites&#39; or &#39;systems&#39;).&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-114"><a href="#EmulatorLauncher-114"><span class="linenos"> 114</span></a>
</span><span id="EmulatorLauncher-115"><a href="#EmulatorLauncher-115"><span class="linenos"> 115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher-116"><a href="#EmulatorLauncher-116"><span class="linenos"> 116</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The joystick object for gamepad support.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-117"><a href="#EmulatorLauncher-117"><span class="linenos"> 117</span></a>
</span><span id="EmulatorLauncher-118"><a href="#EmulatorLauncher-118"><span class="linenos"> 118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="EmulatorLauncher-119"><a href="#EmulatorLauncher-119"><span class="linenos"> 119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the first axis event for each direction.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-120"><a href="#EmulatorLauncher-120"><span class="linenos"> 120</span></a>
</span><span id="EmulatorLauncher-121"><a href="#EmulatorLauncher-121"><span class="linenos"> 121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="EmulatorLauncher-122"><a href="#EmulatorLauncher-122"><span class="linenos"> 122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the last axis event for each direction.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-123"><a href="#EmulatorLauncher-123"><span class="linenos"> 123</span></a>
</span><span id="EmulatorLauncher-124"><a href="#EmulatorLauncher-124"><span class="linenos"> 124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="EmulatorLauncher-125"><a href="#EmulatorLauncher-125"><span class="linenos"> 125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the first hat event for each direction.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-126"><a href="#EmulatorLauncher-126"><span class="linenos"> 126</span></a>
</span><span id="EmulatorLauncher-127"><a href="#EmulatorLauncher-127"><span class="linenos"> 127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span id="EmulatorLauncher-128"><a href="#EmulatorLauncher-128"><span class="linenos"> 128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp of the last hat event for each direction.&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-129"><a href="#EmulatorLauncher-129"><span class="linenos"> 129</span></a>
</span><span id="EmulatorLauncher-130"><a href="#EmulatorLauncher-130"><span class="linenos"> 130</span></a>    <span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-131"><a href="#EmulatorLauncher-131"><span class="linenos"> 131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-132"><a href="#EmulatorLauncher-132"><span class="linenos"> 132</span></a><span class="sd">        Load the configuration from a platform-specific location.</span>
</span><span id="EmulatorLauncher-133"><a href="#EmulatorLauncher-133"><span class="linenos"> 133</span></a><span class="sd">        This method attempts to load the configuration from a file specified by</span>
</span><span id="EmulatorLauncher-134"><a href="#EmulatorLauncher-134"><span class="linenos"> 134</span></a><span class="sd">        `self.config_file`. If the file does not exist, it creates a default</span>
</span><span id="EmulatorLauncher-135"><a href="#EmulatorLauncher-135"><span class="linenos"> 135</span></a><span class="sd">        configuration file. If an error occurs during loading, it prints an error</span>
</span><span id="EmulatorLauncher-136"><a href="#EmulatorLauncher-136"><span class="linenos"> 136</span></a><span class="sd">        message and returns the default configuration.</span>
</span><span id="EmulatorLauncher-137"><a href="#EmulatorLauncher-137"><span class="linenos"> 137</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher-138"><a href="#EmulatorLauncher-138"><span class="linenos"> 138</span></a><span class="sd">            dict: The loaded configuration as a dictionary. If the configuration</span>
</span><span id="EmulatorLauncher-139"><a href="#EmulatorLauncher-139"><span class="linenos"> 139</span></a><span class="sd">            file does not exist or an error occurs, returns the default configuration.</span>
</span><span id="EmulatorLauncher-140"><a href="#EmulatorLauncher-140"><span class="linenos"> 140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-141"><a href="#EmulatorLauncher-141"><span class="linenos"> 141</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="EmulatorLauncher-142"><a href="#EmulatorLauncher-142"><span class="linenos"> 142</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="EmulatorLauncher-143"><a href="#EmulatorLauncher-143"><span class="linenos"> 143</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">create_default_config</span><span class="p">()</span>
</span><span id="EmulatorLauncher-144"><a href="#EmulatorLauncher-144"><span class="linenos"> 144</span></a>
</span><span id="EmulatorLauncher-145"><a href="#EmulatorLauncher-145"><span class="linenos"> 145</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="EmulatorLauncher-146"><a href="#EmulatorLauncher-146"><span class="linenos"> 146</span></a>                <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher-147"><a href="#EmulatorLauncher-147"><span class="linenos"> 147</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EmulatorLauncher-148"><a href="#EmulatorLauncher-148"><span class="linenos"> 148</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading config: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher-149"><a href="#EmulatorLauncher-149"><span class="linenos"> 149</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_default_config</span><span class="p">()</span>
</span><span id="EmulatorLauncher-150"><a href="#EmulatorLauncher-150"><span class="linenos"> 150</span></a>
</span><span id="EmulatorLauncher-151"><a href="#EmulatorLauncher-151"><span class="linenos"> 151</span></a>    <span class="k">def</span> <span class="nf">create_default_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-152"><a href="#EmulatorLauncher-152"><span class="linenos"> 152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-153"><a href="#EmulatorLauncher-153"><span class="linenos"> 153</span></a><span class="sd">        Creates and saves a default configuration for the ROM launcher.</span>
</span><span id="EmulatorLauncher-154"><a href="#EmulatorLauncher-154"><span class="linenos"> 154</span></a>
</span><span id="EmulatorLauncher-155"><a href="#EmulatorLauncher-155"><span class="linenos"> 155</span></a><span class="sd">        The default configuration includes settings for the NES system, specifying</span>
</span><span id="EmulatorLauncher-156"><a href="#EmulatorLauncher-156"><span class="linenos"> 156</span></a><span class="sd">        the emulator path, launch arguments, and ROM paths.</span>
</span><span id="EmulatorLauncher-157"><a href="#EmulatorLauncher-157"><span class="linenos"> 157</span></a>
</span><span id="EmulatorLauncher-158"><a href="#EmulatorLauncher-158"><span class="linenos"> 158</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher-159"><a href="#EmulatorLauncher-159"><span class="linenos"> 159</span></a><span class="sd">            dict: The default configuration dictionary.</span>
</span><span id="EmulatorLauncher-160"><a href="#EmulatorLauncher-160"><span class="linenos"> 160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-161"><a href="#EmulatorLauncher-161"><span class="linenos"> 161</span></a>        <span class="n">default_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EmulatorLauncher-162"><a href="#EmulatorLauncher-162"><span class="linenos"> 162</span></a>            <span class="s2">&quot;systems&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="EmulatorLauncher-163"><a href="#EmulatorLauncher-163"><span class="linenos"> 163</span></a>                <span class="s2">&quot;NES&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="EmulatorLauncher-164"><a href="#EmulatorLauncher-164"><span class="linenos"> 164</span></a>                    <span class="s2">&quot;emulator_path&quot;</span><span class="p">:</span> <span class="s2">&quot;retroarch&quot;</span><span class="p">,</span>
</span><span id="EmulatorLauncher-165"><a href="#EmulatorLauncher-165"><span class="linenos"> 165</span></a>                    <span class="s2">&quot;launch_arguments&quot;</span><span class="p">:</span> <span class="s2">&quot;-L cores/fceumm_libretro.dll </span><span class="si">{rom_path}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EmulatorLauncher-166"><a href="#EmulatorLauncher-166"><span class="linenos"> 166</span></a>                    <span class="s2">&quot;paths&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;~/ROMs/NES&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher-167"><a href="#EmulatorLauncher-167"><span class="linenos"> 167</span></a>                <span class="p">}</span>
</span><span id="EmulatorLauncher-168"><a href="#EmulatorLauncher-168"><span class="linenos"> 168</span></a>            <span class="p">}</span>
</span><span id="EmulatorLauncher-169"><a href="#EmulatorLauncher-169"><span class="linenos"> 169</span></a>        <span class="p">}</span>
</span><span id="EmulatorLauncher-170"><a href="#EmulatorLauncher-170"><span class="linenos"> 170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">save_config</span><span class="p">(</span><span class="n">default_config</span><span class="p">)</span>
</span><span id="EmulatorLauncher-171"><a href="#EmulatorLauncher-171"><span class="linenos"> 171</span></a>        <span class="k">return</span> <span class="n">default_config</span>
</span><span id="EmulatorLauncher-172"><a href="#EmulatorLauncher-172"><span class="linenos"> 172</span></a>
</span><span id="EmulatorLauncher-173"><a href="#EmulatorLauncher-173"><span class="linenos"> 173</span></a>    <span class="k">def</span> <span class="nf">save_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="EmulatorLauncher-174"><a href="#EmulatorLauncher-174"><span class="linenos"> 174</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-175"><a href="#EmulatorLauncher-175"><span class="linenos"> 175</span></a><span class="sd">        Save the current configuration to a file.</span>
</span><span id="EmulatorLauncher-176"><a href="#EmulatorLauncher-176"><span class="linenos"> 176</span></a>
</span><span id="EmulatorLauncher-177"><a href="#EmulatorLauncher-177"><span class="linenos"> 177</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher-178"><a href="#EmulatorLauncher-178"><span class="linenos"> 178</span></a><span class="sd">            config (dict, optional): The configuration dictionary to save.</span>
</span><span id="EmulatorLauncher-179"><a href="#EmulatorLauncher-179"><span class="linenos"> 179</span></a><span class="sd">                                     If not provided, the current configuration</span>
</span><span id="EmulatorLauncher-180"><a href="#EmulatorLauncher-180"><span class="linenos"> 180</span></a><span class="sd">                                     stored in self.config will be used.</span>
</span><span id="EmulatorLauncher-181"><a href="#EmulatorLauncher-181"><span class="linenos"> 181</span></a>
</span><span id="EmulatorLauncher-182"><a href="#EmulatorLauncher-182"><span class="linenos"> 182</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher-183"><a href="#EmulatorLauncher-183"><span class="linenos"> 183</span></a><span class="sd">            IOError: If there is an error writing to the file.</span>
</span><span id="EmulatorLauncher-184"><a href="#EmulatorLauncher-184"><span class="linenos"> 184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-185"><a href="#EmulatorLauncher-185"><span class="linenos"> 185</span></a>        <span class="n">config</span> <span class="o">=</span> <span class="n">config</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span>
</span><span id="EmulatorLauncher-186"><a href="#EmulatorLauncher-186"><span class="linenos"> 186</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="EmulatorLauncher-187"><a href="#EmulatorLauncher-187"><span class="linenos"> 187</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="EmulatorLauncher-188"><a href="#EmulatorLauncher-188"><span class="linenos"> 188</span></a>
</span><span id="EmulatorLauncher-189"><a href="#EmulatorLauncher-189"><span class="linenos"> 189</span></a>    <span class="k">def</span> <span class="nf">load_favorites</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-190"><a href="#EmulatorLauncher-190"><span class="linenos"> 190</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-191"><a href="#EmulatorLauncher-191"><span class="linenos"> 191</span></a><span class="sd">        Loads the favorites from a YAML file.</span>
</span><span id="EmulatorLauncher-192"><a href="#EmulatorLauncher-192"><span class="linenos"> 192</span></a><span class="sd">        This method attempts to load the favorites from a specified YAML file.</span>
</span><span id="EmulatorLauncher-193"><a href="#EmulatorLauncher-193"><span class="linenos"> 193</span></a><span class="sd">        If the file does not exist, it returns an empty dictionary. If there is</span>
</span><span id="EmulatorLauncher-194"><a href="#EmulatorLauncher-194"><span class="linenos"> 194</span></a><span class="sd">        an error during the loading process, it catches the exception, prints</span>
</span><span id="EmulatorLauncher-195"><a href="#EmulatorLauncher-195"><span class="linenos"> 195</span></a><span class="sd">        an error message, and returns an empty dictionary.</span>
</span><span id="EmulatorLauncher-196"><a href="#EmulatorLauncher-196"><span class="linenos"> 196</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher-197"><a href="#EmulatorLauncher-197"><span class="linenos"> 197</span></a><span class="sd">            dict: A dictionary containing the favorites loaded from the YAML file,</span>
</span><span id="EmulatorLauncher-198"><a href="#EmulatorLauncher-198"><span class="linenos"> 198</span></a><span class="sd">                  or an empty dictionary if the file does not exist or an error occurs.</span>
</span><span id="EmulatorLauncher-199"><a href="#EmulatorLauncher-199"><span class="linenos"> 199</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-200"><a href="#EmulatorLauncher-200"><span class="linenos"> 200</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="EmulatorLauncher-201"><a href="#EmulatorLauncher-201"><span class="linenos"> 201</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="EmulatorLauncher-202"><a href="#EmulatorLauncher-202"><span class="linenos"> 202</span></a>                <span class="k">return</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher-203"><a href="#EmulatorLauncher-203"><span class="linenos"> 203</span></a>
</span><span id="EmulatorLauncher-204"><a href="#EmulatorLauncher-204"><span class="linenos"> 204</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="EmulatorLauncher-205"><a href="#EmulatorLauncher-205"><span class="linenos"> 205</span></a>                <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher-206"><a href="#EmulatorLauncher-206"><span class="linenos"> 206</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EmulatorLauncher-207"><a href="#EmulatorLauncher-207"><span class="linenos"> 207</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading favorites: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher-208"><a href="#EmulatorLauncher-208"><span class="linenos"> 208</span></a>            <span class="k">return</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher-209"><a href="#EmulatorLauncher-209"><span class="linenos"> 209</span></a>
</span><span id="EmulatorLauncher-210"><a href="#EmulatorLauncher-210"><span class="linenos"> 210</span></a>    <span class="k">def</span> <span class="nf">save_favorites</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-211"><a href="#EmulatorLauncher-211"><span class="linenos"> 211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-212"><a href="#EmulatorLauncher-212"><span class="linenos"> 212</span></a><span class="sd">        Saves the current list of favorite ROMs to a file.</span>
</span><span id="EmulatorLauncher-213"><a href="#EmulatorLauncher-213"><span class="linenos"> 213</span></a>
</span><span id="EmulatorLauncher-214"><a href="#EmulatorLauncher-214"><span class="linenos"> 214</span></a><span class="sd">        This method writes the contents of the `self.favorites` list to the file</span>
</span><span id="EmulatorLauncher-215"><a href="#EmulatorLauncher-215"><span class="linenos"> 215</span></a><span class="sd">        specified by `self.favorites_file` in YAML format.</span>
</span><span id="EmulatorLauncher-216"><a href="#EmulatorLauncher-216"><span class="linenos"> 216</span></a>
</span><span id="EmulatorLauncher-217"><a href="#EmulatorLauncher-217"><span class="linenos"> 217</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher-218"><a href="#EmulatorLauncher-218"><span class="linenos"> 218</span></a><span class="sd">            IOError: If the file cannot be opened or written to.</span>
</span><span id="EmulatorLauncher-219"><a href="#EmulatorLauncher-219"><span class="linenos"> 219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-220"><a href="#EmulatorLauncher-220"><span class="linenos"> 220</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="EmulatorLauncher-221"><a href="#EmulatorLauncher-221"><span class="linenos"> 221</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="EmulatorLauncher-222"><a href="#EmulatorLauncher-222"><span class="linenos"> 222</span></a>
</span><span id="EmulatorLauncher-223"><a href="#EmulatorLauncher-223"><span class="linenos"> 223</span></a>    <span class="k">def</span> <span class="nf">init_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-224"><a href="#EmulatorLauncher-224"><span class="linenos"> 224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-225"><a href="#EmulatorLauncher-225"><span class="linenos"> 225</span></a><span class="sd">        Initialize color pairs for the UI using the curses library.</span>
</span><span id="EmulatorLauncher-226"><a href="#EmulatorLauncher-226"><span class="linenos"> 226</span></a><span class="sd">        This method sets up the color pairs that will be used throughout the UI.</span>
</span><span id="EmulatorLauncher-227"><a href="#EmulatorLauncher-227"><span class="linenos"> 227</span></a><span class="sd">        It starts by initializing the curses color system and using the default</span>
</span><span id="EmulatorLauncher-228"><a href="#EmulatorLauncher-228"><span class="linenos"> 228</span></a><span class="sd">        terminal colors. Then, it defines several color pairs for different UI</span>
</span><span id="EmulatorLauncher-229"><a href="#EmulatorLauncher-229"><span class="linenos"> 229</span></a><span class="sd">        elements such as headers, selected items, favorites, normal text,</span>
</span><span id="EmulatorLauncher-230"><a href="#EmulatorLauncher-230"><span class="linenos"> 230</span></a><span class="sd">        highlighted text, and the status bar.</span>
</span><span id="EmulatorLauncher-231"><a href="#EmulatorLauncher-231"><span class="linenos"> 231</span></a><span class="sd">        Color pairs defined:</span>
</span><span id="EmulatorLauncher-232"><a href="#EmulatorLauncher-232"><span class="linenos"> 232</span></a><span class="sd">        - HEADER: White text on a blue background</span>
</span><span id="EmulatorLauncher-233"><a href="#EmulatorLauncher-233"><span class="linenos"> 233</span></a><span class="sd">        - SELECTED: Black text on a white background</span>
</span><span id="EmulatorLauncher-234"><a href="#EmulatorLauncher-234"><span class="linenos"> 234</span></a><span class="sd">        - FAVORITE: Yellow text on the default background</span>
</span><span id="EmulatorLauncher-235"><a href="#EmulatorLauncher-235"><span class="linenos"> 235</span></a><span class="sd">        - NORMAL: White text on the default background</span>
</span><span id="EmulatorLauncher-236"><a href="#EmulatorLauncher-236"><span class="linenos"> 236</span></a><span class="sd">        - HIGHLIGHT: Cyan text on the default background</span>
</span><span id="EmulatorLauncher-237"><a href="#EmulatorLauncher-237"><span class="linenos"> 237</span></a><span class="sd">        - STATUS_BAR: Black text on a white background</span>
</span><span id="EmulatorLauncher-238"><a href="#EmulatorLauncher-238"><span class="linenos"> 238</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-239"><a href="#EmulatorLauncher-239"><span class="linenos"> 239</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">start_color</span><span class="p">()</span>
</span><span id="EmulatorLauncher-240"><a href="#EmulatorLauncher-240"><span class="linenos"> 240</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">use_default_colors</span><span class="p">()</span>
</span><span id="EmulatorLauncher-241"><a href="#EmulatorLauncher-241"><span class="linenos"> 241</span></a>
</span><span id="EmulatorLauncher-242"><a href="#EmulatorLauncher-242"><span class="linenos"> 242</span></a>        <span class="c1"># Define color pairs</span>
</span><span id="EmulatorLauncher-243"><a href="#EmulatorLauncher-243"><span class="linenos"> 243</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HEADER</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_BLUE</span><span class="p">)</span>
</span><span id="EmulatorLauncher-244"><a href="#EmulatorLauncher-244"><span class="linenos"> 244</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_BLACK</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span><span class="p">)</span>
</span><span id="EmulatorLauncher-245"><a href="#EmulatorLauncher-245"><span class="linenos"> 245</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">FAVORITE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_YELLOW</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher-246"><a href="#EmulatorLauncher-246"><span class="linenos"> 246</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher-247"><a href="#EmulatorLauncher-247"><span class="linenos"> 247</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HIGHLIGHT</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_CYAN</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher-248"><a href="#EmulatorLauncher-248"><span class="linenos"> 248</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span>
</span><span id="EmulatorLauncher-249"><a href="#EmulatorLauncher-249"><span class="linenos"> 249</span></a>            <span class="n">Colors</span><span class="o">.</span><span class="n">STATUS_BAR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_BLACK</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span>
</span><span id="EmulatorLauncher-250"><a href="#EmulatorLauncher-250"><span class="linenos"> 250</span></a>        <span class="p">)</span>
</span><span id="EmulatorLauncher-251"><a href="#EmulatorLauncher-251"><span class="linenos"> 251</span></a>
</span><span id="EmulatorLauncher-252"><a href="#EmulatorLauncher-252"><span class="linenos"> 252</span></a>    <span class="k">def</span> <span class="nf">draw_borders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-253"><a href="#EmulatorLauncher-253"><span class="linenos"> 253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-254"><a href="#EmulatorLauncher-254"><span class="linenos"> 254</span></a><span class="sd">        Draws borders and headers for the system and ROM windows.</span>
</span><span id="EmulatorLauncher-255"><a href="#EmulatorLauncher-255"><span class="linenos"> 255</span></a><span class="sd">        This method draws a box around the system window and adds a header</span>
</span><span id="EmulatorLauncher-256"><a href="#EmulatorLauncher-256"><span class="linenos"> 256</span></a><span class="sd">        labeled &quot;[ Systems ]&quot; with a specific color. It also draws a box</span>
</span><span id="EmulatorLauncher-257"><a href="#EmulatorLauncher-257"><span class="linenos"> 257</span></a><span class="sd">        around the ROM window and adds a header labeled &quot;[ Games ]&quot; with</span>
</span><span id="EmulatorLauncher-258"><a href="#EmulatorLauncher-258"><span class="linenos"> 258</span></a><span class="sd">        the same color.</span>
</span><span id="EmulatorLauncher-259"><a href="#EmulatorLauncher-259"><span class="linenos"> 259</span></a><span class="sd">        The colors used for the headers are defined by the Colors.HEADER</span>
</span><span id="EmulatorLauncher-260"><a href="#EmulatorLauncher-260"><span class="linenos"> 260</span></a><span class="sd">        enumeration value.</span>
</span><span id="EmulatorLauncher-261"><a href="#EmulatorLauncher-261"><span class="linenos"> 261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-262"><a href="#EmulatorLauncher-262"><span class="linenos"> 262</span></a>        <span class="c1"># Draw system window border</span>
</span><span id="EmulatorLauncher-263"><a href="#EmulatorLauncher-263"><span class="linenos"> 263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</span><span id="EmulatorLauncher-264"><a href="#EmulatorLauncher-264"><span class="linenos"> 264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher-265"><a href="#EmulatorLauncher-265"><span class="linenos"> 265</span></a>            <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;[ Systems ]&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HEADER</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-266"><a href="#EmulatorLauncher-266"><span class="linenos"> 266</span></a>        <span class="p">)</span>
</span><span id="EmulatorLauncher-267"><a href="#EmulatorLauncher-267"><span class="linenos"> 267</span></a>
</span><span id="EmulatorLauncher-268"><a href="#EmulatorLauncher-268"><span class="linenos"> 268</span></a>        <span class="c1"># Draw ROM window border</span>
</span><span id="EmulatorLauncher-269"><a href="#EmulatorLauncher-269"><span class="linenos"> 269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</span><span id="EmulatorLauncher-270"><a href="#EmulatorLauncher-270"><span class="linenos"> 270</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher-271"><a href="#EmulatorLauncher-271"><span class="linenos"> 271</span></a>            <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;[ Games ]&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HEADER</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-272"><a href="#EmulatorLauncher-272"><span class="linenos"> 272</span></a>        <span class="p">)</span>
</span><span id="EmulatorLauncher-273"><a href="#EmulatorLauncher-273"><span class="linenos"> 273</span></a>
</span><span id="EmulatorLauncher-274"><a href="#EmulatorLauncher-274"><span class="linenos"> 274</span></a>    <span class="k">def</span> <span class="nf">get_roms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-275"><a href="#EmulatorLauncher-275"><span class="linenos"> 275</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-276"><a href="#EmulatorLauncher-276"><span class="linenos"> 276</span></a><span class="sd">        Retrieves a list of ROMs from the configured paths for each system.</span>
</span><span id="EmulatorLauncher-277"><a href="#EmulatorLauncher-277"><span class="linenos"> 277</span></a>
</span><span id="EmulatorLauncher-278"><a href="#EmulatorLauncher-278"><span class="linenos"> 278</span></a><span class="sd">        This method iterates through the systems defined in the configuration,</span>
</span><span id="EmulatorLauncher-279"><a href="#EmulatorLauncher-279"><span class="linenos"> 279</span></a><span class="sd">        collects ROM file paths from the specified directories, and organizes</span>
</span><span id="EmulatorLauncher-280"><a href="#EmulatorLauncher-280"><span class="linenos"> 280</span></a><span class="sd">        them by system.</span>
</span><span id="EmulatorLauncher-281"><a href="#EmulatorLauncher-281"><span class="linenos"> 281</span></a>
</span><span id="EmulatorLauncher-282"><a href="#EmulatorLauncher-282"><span class="linenos"> 282</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher-283"><a href="#EmulatorLauncher-283"><span class="linenos"> 283</span></a><span class="sd">            dict: A dictionary where the keys are system names and the values</span>
</span><span id="EmulatorLauncher-284"><a href="#EmulatorLauncher-284"><span class="linenos"> 284</span></a><span class="sd">                  are lists of ROM file paths.</span>
</span><span id="EmulatorLauncher-285"><a href="#EmulatorLauncher-285"><span class="linenos"> 285</span></a>
</span><span id="EmulatorLauncher-286"><a href="#EmulatorLauncher-286"><span class="linenos"> 286</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher-287"><a href="#EmulatorLauncher-287"><span class="linenos"> 287</span></a><span class="sd">            Prints a warning message if a specified ROM path is invalid.</span>
</span><span id="EmulatorLauncher-288"><a href="#EmulatorLauncher-288"><span class="linenos"> 288</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-289"><a href="#EmulatorLauncher-289"><span class="linenos"> 289</span></a>        <span class="n">roms</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher-290"><a href="#EmulatorLauncher-290"><span class="linenos"> 290</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;systems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher-291"><a href="#EmulatorLauncher-291"><span class="linenos"> 291</span></a>            <span class="n">roms</span><span class="p">[</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher-292"><a href="#EmulatorLauncher-292"><span class="linenos"> 292</span></a>            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;paths&quot;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="EmulatorLauncher-293"><a href="#EmulatorLauncher-293"><span class="linenos"> 293</span></a>                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span><span id="EmulatorLauncher-294"><a href="#EmulatorLauncher-294"><span class="linenos"> 294</span></a>                    <span class="n">roms</span><span class="p">[</span><span class="n">system</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="EmulatorLauncher-295"><a href="#EmulatorLauncher-295"><span class="linenos"> 295</span></a>                        <span class="p">[</span>
</span><span id="EmulatorLauncher-296"><a href="#EmulatorLauncher-296"><span class="linenos"> 296</span></a>                            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="EmulatorLauncher-297"><a href="#EmulatorLauncher-297"><span class="linenos"> 297</span></a>                            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-298"><a href="#EmulatorLauncher-298"><span class="linenos"> 298</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher-299"><a href="#EmulatorLauncher-299"><span class="linenos"> 299</span></a>                        <span class="p">]</span>
</span><span id="EmulatorLauncher-300"><a href="#EmulatorLauncher-300"><span class="linenos"> 300</span></a>                    <span class="p">)</span>
</span><span id="EmulatorLauncher-301"><a href="#EmulatorLauncher-301"><span class="linenos"> 301</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-302"><a href="#EmulatorLauncher-302"><span class="linenos"> 302</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Invalid ROM path for </span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher-303"><a href="#EmulatorLauncher-303"><span class="linenos"> 303</span></a>        <span class="k">return</span> <span class="n">roms</span>
</span><span id="EmulatorLauncher-304"><a href="#EmulatorLauncher-304"><span class="linenos"> 304</span></a>
</span><span id="EmulatorLauncher-305"><a href="#EmulatorLauncher-305"><span class="linenos"> 305</span></a>    <span class="k">def</span> <span class="nf">combine_all_roms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roms</span><span class="p">):</span>
</span><span id="EmulatorLauncher-306"><a href="#EmulatorLauncher-306"><span class="linenos"> 306</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-307"><a href="#EmulatorLauncher-307"><span class="linenos"> 307</span></a><span class="sd">        Combines all ROMs from all systems into a list of (system, rom_path) tuples.</span>
</span><span id="EmulatorLauncher-308"><a href="#EmulatorLauncher-308"><span class="linenos"> 308</span></a>
</span><span id="EmulatorLauncher-309"><a href="#EmulatorLauncher-309"><span class="linenos"> 309</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher-310"><a href="#EmulatorLauncher-310"><span class="linenos"> 310</span></a><span class="sd">            roms (dict): A dictionary where keys are system names and values are lists of ROM paths.</span>
</span><span id="EmulatorLauncher-311"><a href="#EmulatorLauncher-311"><span class="linenos"> 311</span></a>
</span><span id="EmulatorLauncher-312"><a href="#EmulatorLauncher-312"><span class="linenos"> 312</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher-313"><a href="#EmulatorLauncher-313"><span class="linenos"> 313</span></a><span class="sd">            list: A sorted list of tuples, where each tuple contains a system name and a ROM path.</span>
</span><span id="EmulatorLauncher-314"><a href="#EmulatorLauncher-314"><span class="linenos"> 314</span></a><span class="sd">                  The list is sorted by the ROM name in a case-insensitive manner.</span>
</span><span id="EmulatorLauncher-315"><a href="#EmulatorLauncher-315"><span class="linenos"> 315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-316"><a href="#EmulatorLauncher-316"><span class="linenos"> 316</span></a>        <span class="n">all_roms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher-317"><a href="#EmulatorLauncher-317"><span class="linenos"> 317</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">system_roms</span> <span class="ow">in</span> <span class="n">roms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher-318"><a href="#EmulatorLauncher-318"><span class="linenos"> 318</span></a>            <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">system_roms</span><span class="p">:</span>
</span><span id="EmulatorLauncher-319"><a href="#EmulatorLauncher-319"><span class="linenos"> 319</span></a>                <span class="n">all_roms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">system</span><span class="p">,</span> <span class="n">rom</span><span class="p">))</span>
</span><span id="EmulatorLauncher-320"><a href="#EmulatorLauncher-320"><span class="linenos"> 320</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span>
</span><span id="EmulatorLauncher-321"><a href="#EmulatorLauncher-321"><span class="linenos"> 321</span></a>            <span class="n">all_roms</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="EmulatorLauncher-322"><a href="#EmulatorLauncher-322"><span class="linenos"> 322</span></a>        <span class="p">)</span>  <span class="c1"># Sort by ROM name</span>
</span><span id="EmulatorLauncher-323"><a href="#EmulatorLauncher-323"><span class="linenos"> 323</span></a>
</span><span id="EmulatorLauncher-324"><a href="#EmulatorLauncher-324"><span class="linenos"> 324</span></a>    <span class="k">def</span> <span class="nf">format_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="EmulatorLauncher-325"><a href="#EmulatorLauncher-325"><span class="linenos"> 325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-326"><a href="#EmulatorLauncher-326"><span class="linenos"> 326</span></a><span class="sd">        Formats a given size in bytes into a human-readable string with appropriate units.</span>
</span><span id="EmulatorLauncher-327"><a href="#EmulatorLauncher-327"><span class="linenos"> 327</span></a>
</span><span id="EmulatorLauncher-328"><a href="#EmulatorLauncher-328"><span class="linenos"> 328</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher-329"><a href="#EmulatorLauncher-329"><span class="linenos"> 329</span></a><span class="sd">            size (float): The size in bytes to be formatted.</span>
</span><span id="EmulatorLauncher-330"><a href="#EmulatorLauncher-330"><span class="linenos"> 330</span></a>
</span><span id="EmulatorLauncher-331"><a href="#EmulatorLauncher-331"><span class="linenos"> 331</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher-332"><a href="#EmulatorLauncher-332"><span class="linenos"> 332</span></a><span class="sd">            str: The formatted size string with units (B, KB, MB, GB, TB, or PB).</span>
</span><span id="EmulatorLauncher-333"><a href="#EmulatorLauncher-333"><span class="linenos"> 333</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-334"><a href="#EmulatorLauncher-334"><span class="linenos"> 334</span></a>        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;KB&quot;</span><span class="p">,</span> <span class="s2">&quot;MB&quot;</span><span class="p">,</span> <span class="s2">&quot;GB&quot;</span><span class="p">,</span> <span class="s2">&quot;TB&quot;</span><span class="p">]:</span>
</span><span id="EmulatorLauncher-335"><a href="#EmulatorLauncher-335"><span class="linenos"> 335</span></a>            <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
</span><span id="EmulatorLauncher-336"><a href="#EmulatorLauncher-336"><span class="linenos"> 336</span></a>                <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-337"><a href="#EmulatorLauncher-337"><span class="linenos"> 337</span></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="si">}{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher-338"><a href="#EmulatorLauncher-338"><span class="linenos"> 338</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-339"><a href="#EmulatorLauncher-339"><span class="linenos"> 339</span></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher-340"><a href="#EmulatorLauncher-340"><span class="linenos"> 340</span></a>            <span class="n">size</span> <span class="o">/=</span> <span class="mi">1024</span>
</span><span id="EmulatorLauncher-341"><a href="#EmulatorLauncher-341"><span class="linenos"> 341</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">PB&quot;</span>
</span><span id="EmulatorLauncher-342"><a href="#EmulatorLauncher-342"><span class="linenos"> 342</span></a>
</span><span id="EmulatorLauncher-343"><a href="#EmulatorLauncher-343"><span class="linenos"> 343</span></a>    <span class="k">def</span> <span class="nf">draw_system_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-344"><a href="#EmulatorLauncher-344"><span class="linenos"> 344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-345"><a href="#EmulatorLauncher-345"><span class="linenos"> 345</span></a><span class="sd">        Draws the system selection window with enhanced visuals.</span>
</span><span id="EmulatorLauncher-346"><a href="#EmulatorLauncher-346"><span class="linenos"> 346</span></a><span class="sd">        This method clears the current system window and redraws it with updated</span>
</span><span id="EmulatorLauncher-347"><a href="#EmulatorLauncher-347"><span class="linenos"> 347</span></a><span class="sd">        information, including the number of favorite ROMs, all ROMs, and ROMs</span>
</span><span id="EmulatorLauncher-348"><a href="#EmulatorLauncher-348"><span class="linenos"> 348</span></a><span class="sd">        categorized by system. It highlights the currently selected view mode</span>
</span><span id="EmulatorLauncher-349"><a href="#EmulatorLauncher-349"><span class="linenos"> 349</span></a><span class="sd">        and system, if applicable.</span>
</span><span id="EmulatorLauncher-350"><a href="#EmulatorLauncher-350"><span class="linenos"> 350</span></a><span class="sd">        The window includes:</span>
</span><span id="EmulatorLauncher-351"><a href="#EmulatorLauncher-351"><span class="linenos"> 351</span></a><span class="sd">        - A favorites section with a count of favorite ROMs.</span>
</span><span id="EmulatorLauncher-352"><a href="#EmulatorLauncher-352"><span class="linenos"> 352</span></a><span class="sd">        - An &quot;All&quot; section with a count of all available ROMs.</span>
</span><span id="EmulatorLauncher-353"><a href="#EmulatorLauncher-353"><span class="linenos"> 353</span></a><span class="sd">        - A separator line for visual clarity.</span>
</span><span id="EmulatorLauncher-354"><a href="#EmulatorLauncher-354"><span class="linenos"> 354</span></a><span class="sd">        - A list of systems with their respective ROM counts.</span>
</span><span id="EmulatorLauncher-355"><a href="#EmulatorLauncher-355"><span class="linenos"> 355</span></a><span class="sd">        The visual elements are styled using curses color pairs to indicate</span>
</span><span id="EmulatorLauncher-356"><a href="#EmulatorLauncher-356"><span class="linenos"> 356</span></a><span class="sd">        selection and different categories.</span>
</span><span id="EmulatorLauncher-357"><a href="#EmulatorLauncher-357"><span class="linenos"> 357</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher-358"><a href="#EmulatorLauncher-358"><span class="linenos"> 358</span></a><span class="sd">            self.system_window (curses.window): The window object where the system</span>
</span><span id="EmulatorLauncher-359"><a href="#EmulatorLauncher-359"><span class="linenos"> 359</span></a><span class="sd">                selection is drawn.</span>
</span><span id="EmulatorLauncher-360"><a href="#EmulatorLauncher-360"><span class="linenos"> 360</span></a><span class="sd">            self.view_mode (str): The current view mode, which can be &quot;favorites&quot;,</span>
</span><span id="EmulatorLauncher-361"><a href="#EmulatorLauncher-361"><span class="linenos"> 361</span></a><span class="sd">                &quot;all&quot;, or &quot;systems&quot;.</span>
</span><span id="EmulatorLauncher-362"><a href="#EmulatorLauncher-362"><span class="linenos"> 362</span></a><span class="sd">            self.favorites (dict): A dictionary containing favorite ROMs categorized</span>
</span><span id="EmulatorLauncher-363"><a href="#EmulatorLauncher-363"><span class="linenos"> 363</span></a><span class="sd">                by system.</span>
</span><span id="EmulatorLauncher-364"><a href="#EmulatorLauncher-364"><span class="linenos"> 364</span></a><span class="sd">            self.all_roms (list): A list of all available ROMs.</span>
</span><span id="EmulatorLauncher-365"><a href="#EmulatorLauncher-365"><span class="linenos"> 365</span></a><span class="sd">            self.roms (dict): A dictionary containing ROMs categorized by system.</span>
</span><span id="EmulatorLauncher-366"><a href="#EmulatorLauncher-366"><span class="linenos"> 366</span></a><span class="sd">            self.selected_system (int): The index of the currently selected system</span>
</span><span id="EmulatorLauncher-367"><a href="#EmulatorLauncher-367"><span class="linenos"> 367</span></a><span class="sd">                in the systems list.</span>
</span><span id="EmulatorLauncher-368"><a href="#EmulatorLauncher-368"><span class="linenos"> 368</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-369"><a href="#EmulatorLauncher-369"><span class="linenos"> 369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="EmulatorLauncher-370"><a href="#EmulatorLauncher-370"><span class="linenos"> 370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_borders</span><span class="p">()</span>
</span><span id="EmulatorLauncher-371"><a href="#EmulatorLauncher-371"><span class="linenos"> 371</span></a>        <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>  <span class="c1"># Start below the border</span>
</span><span id="EmulatorLauncher-372"><a href="#EmulatorLauncher-372"><span class="linenos"> 372</span></a>
</span><span id="EmulatorLauncher-373"><a href="#EmulatorLauncher-373"><span class="linenos"> 373</span></a>        <span class="c1"># Favorites view with icon</span>
</span><span id="EmulatorLauncher-374"><a href="#EmulatorLauncher-374"><span class="linenos"> 374</span></a>        <span class="n">favorites_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">roms</span><span class="p">)</span> <span class="k">for</span> <span class="n">roms</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="EmulatorLauncher-375"><a href="#EmulatorLauncher-375"><span class="linenos"> 375</span></a>        <span class="n">fav_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; Favorites (</span><span class="si">{</span><span class="n">favorites_count</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="EmulatorLauncher-376"><a href="#EmulatorLauncher-376"><span class="linenos"> 376</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-377"><a href="#EmulatorLauncher-377"><span class="linenos"> 377</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher-378"><a href="#EmulatorLauncher-378"><span class="linenos"> 378</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fav_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-379"><a href="#EmulatorLauncher-379"><span class="linenos"> 379</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher-380"><a href="#EmulatorLauncher-380"><span class="linenos"> 380</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-381"><a href="#EmulatorLauncher-381"><span class="linenos"> 381</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher-382"><a href="#EmulatorLauncher-382"><span class="linenos"> 382</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fav_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">FAVORITE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-383"><a href="#EmulatorLauncher-383"><span class="linenos"> 383</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher-384"><a href="#EmulatorLauncher-384"><span class="linenos"> 384</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-385"><a href="#EmulatorLauncher-385"><span class="linenos"> 385</span></a>
</span><span id="EmulatorLauncher-386"><a href="#EmulatorLauncher-386"><span class="linenos"> 386</span></a>        <span class="c1"># ALL category with icon</span>
</span><span id="EmulatorLauncher-387"><a href="#EmulatorLauncher-387"><span class="linenos"> 387</span></a>        <span class="n">all_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; All (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="EmulatorLauncher-388"><a href="#EmulatorLauncher-388"><span class="linenos"> 388</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-389"><a href="#EmulatorLauncher-389"><span class="linenos"> 389</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher-390"><a href="#EmulatorLauncher-390"><span class="linenos"> 390</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">all_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-391"><a href="#EmulatorLauncher-391"><span class="linenos"> 391</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher-392"><a href="#EmulatorLauncher-392"><span class="linenos"> 392</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-393"><a href="#EmulatorLauncher-393"><span class="linenos"> 393</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher-394"><a href="#EmulatorLauncher-394"><span class="linenos"> 394</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">all_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-395"><a href="#EmulatorLauncher-395"><span class="linenos"> 395</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher-396"><a href="#EmulatorLauncher-396"><span class="linenos"> 396</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-397"><a href="#EmulatorLauncher-397"><span class="linenos"> 397</span></a>
</span><span id="EmulatorLauncher-398"><a href="#EmulatorLauncher-398"><span class="linenos"> 398</span></a>        <span class="c1"># Separator with nice pattern</span>
</span><span id="EmulatorLauncher-399"><a href="#EmulatorLauncher-399"><span class="linenos"> 399</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="EmulatorLauncher-400"><a href="#EmulatorLauncher-400"><span class="linenos"> 400</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-401"><a href="#EmulatorLauncher-401"><span class="linenos"> 401</span></a>
</span><span id="EmulatorLauncher-402"><a href="#EmulatorLauncher-402"><span class="linenos"> 402</span></a>        <span class="c1"># Systems with ROM counts and icons</span>
</span><span id="EmulatorLauncher-403"><a href="#EmulatorLauncher-403"><span class="linenos"> 403</span></a>        <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="EmulatorLauncher-404"><a href="#EmulatorLauncher-404"><span class="linenos"> 404</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">system</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">systems</span><span class="p">):</span>
</span><span id="EmulatorLauncher-405"><a href="#EmulatorLauncher-405"><span class="linenos"> 405</span></a>            <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="p">[</span><span class="n">system</span><span class="p">])</span>
</span><span id="EmulatorLauncher-406"><a href="#EmulatorLauncher-406"><span class="linenos"> 406</span></a>            <span class="n">system_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="EmulatorLauncher-407"><a href="#EmulatorLauncher-407"><span class="linenos"> 407</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">:</span>
</span><span id="EmulatorLauncher-408"><a href="#EmulatorLauncher-408"><span class="linenos"> 408</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher-409"><a href="#EmulatorLauncher-409"><span class="linenos"> 409</span></a>                    <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">system_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-410"><a href="#EmulatorLauncher-410"><span class="linenos"> 410</span></a>                <span class="p">)</span>
</span><span id="EmulatorLauncher-411"><a href="#EmulatorLauncher-411"><span class="linenos"> 411</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-412"><a href="#EmulatorLauncher-412"><span class="linenos"> 412</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher-413"><a href="#EmulatorLauncher-413"><span class="linenos"> 413</span></a>                    <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">system_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-414"><a href="#EmulatorLauncher-414"><span class="linenos"> 414</span></a>                <span class="p">)</span>
</span><span id="EmulatorLauncher-415"><a href="#EmulatorLauncher-415"><span class="linenos"> 415</span></a>            <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-416"><a href="#EmulatorLauncher-416"><span class="linenos"> 416</span></a>
</span><span id="EmulatorLauncher-417"><a href="#EmulatorLauncher-417"><span class="linenos"> 417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span><span id="EmulatorLauncher-418"><a href="#EmulatorLauncher-418"><span class="linenos"> 418</span></a>
</span><span id="EmulatorLauncher-419"><a href="#EmulatorLauncher-419"><span class="linenos"> 419</span></a>    <span class="k">def</span> <span class="nf">draw_rom_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-420"><a href="#EmulatorLauncher-420"><span class="linenos"> 420</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-421"><a href="#EmulatorLauncher-421"><span class="linenos"> 421</span></a><span class="sd">        Draws the ROM selection window with borders, ROM entries, and additional information.</span>
</span><span id="EmulatorLauncher-422"><a href="#EmulatorLauncher-422"><span class="linenos"> 422</span></a><span class="sd">        This method clears the current ROM window, draws borders, and populates the window</span>
</span><span id="EmulatorLauncher-423"><a href="#EmulatorLauncher-423"><span class="linenos"> 423</span></a><span class="sd">        with a list of ROMs based on the current view mode (systems, all, or favorites).</span>
</span><span id="EmulatorLauncher-424"><a href="#EmulatorLauncher-424"><span class="linenos"> 424</span></a><span class="sd">        It handles scrolling, selection highlighting, and displays ROM names along with their</span>
</span><span id="EmulatorLauncher-425"><a href="#EmulatorLauncher-425"><span class="linenos"> 425</span></a><span class="sd">        sizes. If a ROM is marked as a favorite, it adds a star icon next to its name.</span>
</span><span id="EmulatorLauncher-426"><a href="#EmulatorLauncher-426"><span class="linenos"> 426</span></a><span class="sd">        The method also manages scrolling for long ROM names when they are selected and ensures</span>
</span><span id="EmulatorLauncher-427"><a href="#EmulatorLauncher-427"><span class="linenos"> 427</span></a><span class="sd">        that the display is updated accordingly.</span>
</span><span id="EmulatorLauncher-428"><a href="#EmulatorLauncher-428"><span class="linenos"> 428</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher-429"><a href="#EmulatorLauncher-429"><span class="linenos"> 429</span></a><span class="sd">            self.rom_window (curses.window): The window object where ROMs are displayed.</span>
</span><span id="EmulatorLauncher-430"><a href="#EmulatorLauncher-430"><span class="linenos"> 430</span></a><span class="sd">            self.view_mode (str): The current view mode (&quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;).</span>
</span><span id="EmulatorLauncher-431"><a href="#EmulatorLauncher-431"><span class="linenos"> 431</span></a><span class="sd">            self.roms (dict): Dictionary containing ROMs categorized by systems.</span>
</span><span id="EmulatorLauncher-432"><a href="#EmulatorLauncher-432"><span class="linenos"> 432</span></a><span class="sd">            self.filtered_roms (dict): Dictionary containing filtered ROMs based on the view mode.</span>
</span><span id="EmulatorLauncher-433"><a href="#EmulatorLauncher-433"><span class="linenos"> 433</span></a><span class="sd">            self.selected_system (int): Index of the currently selected system.</span>
</span><span id="EmulatorLauncher-434"><a href="#EmulatorLauncher-434"><span class="linenos"> 434</span></a><span class="sd">            self.selected_rom (int): Index of the currently selected ROM.</span>
</span><span id="EmulatorLauncher-435"><a href="#EmulatorLauncher-435"><span class="linenos"> 435</span></a><span class="sd">            self.total_roms (int): Total number of ROMs in the current view.</span>
</span><span id="EmulatorLauncher-436"><a href="#EmulatorLauncher-436"><span class="linenos"> 436</span></a><span class="sd">            self.current_rom_index (int): Index of the currently selected ROM (1-based).</span>
</span><span id="EmulatorLauncher-437"><a href="#EmulatorLauncher-437"><span class="linenos"> 437</span></a><span class="sd">            self.focus (str): The current focus of the application (&quot;roms&quot; or other).</span>
</span><span id="EmulatorLauncher-438"><a href="#EmulatorLauncher-438"><span class="linenos"> 438</span></a><span class="sd">            self.last_selection_change_time (float): Timestamp of the last selection change.</span>
</span><span id="EmulatorLauncher-439"><a href="#EmulatorLauncher-439"><span class="linenos"> 439</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher-440"><a href="#EmulatorLauncher-440"><span class="linenos"> 440</span></a><span class="sd">            Exception: If there is an error retrieving the file size of a ROM.</span>
</span><span id="EmulatorLauncher-441"><a href="#EmulatorLauncher-441"><span class="linenos"> 441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-442"><a href="#EmulatorLauncher-442"><span class="linenos"> 442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="EmulatorLauncher-443"><a href="#EmulatorLauncher-443"><span class="linenos"> 443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_borders</span><span class="p">()</span>
</span><span id="EmulatorLauncher-444"><a href="#EmulatorLauncher-444"><span class="linenos"> 444</span></a>
</span><span id="EmulatorLauncher-445"><a href="#EmulatorLauncher-445"><span class="linenos"> 445</span></a>        <span class="n">rom_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher-446"><a href="#EmulatorLauncher-446"><span class="linenos"> 446</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-447"><a href="#EmulatorLauncher-447"><span class="linenos"> 447</span></a>            <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="EmulatorLauncher-448"><a href="#EmulatorLauncher-448"><span class="linenos"> 448</span></a>            <span class="k">if</span> <span class="n">systems</span><span class="p">:</span>
</span><span id="EmulatorLauncher-449"><a href="#EmulatorLauncher-449"><span class="linenos"> 449</span></a>                <span class="n">selected_system_name</span> <span class="o">=</span> <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="EmulatorLauncher-450"><a href="#EmulatorLauncher-450"><span class="linenos"> 450</span></a>                <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_system_name</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-451"><a href="#EmulatorLauncher-451"><span class="linenos"> 451</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-452"><a href="#EmulatorLauncher-452"><span class="linenos"> 452</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-453"><a href="#EmulatorLauncher-453"><span class="linenos"> 453</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-454"><a href="#EmulatorLauncher-454"><span class="linenos"> 454</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-455"><a href="#EmulatorLauncher-455"><span class="linenos"> 455</span></a>
</span><span id="EmulatorLauncher-456"><a href="#EmulatorLauncher-456"><span class="linenos"> 456</span></a>        <span class="n">viewable_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Account for borders</span>
</span><span id="EmulatorLauncher-457"><a href="#EmulatorLauncher-457"><span class="linenos"> 457</span></a>        <span class="n">num_roms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_list</span><span class="p">)</span>
</span><span id="EmulatorLauncher-458"><a href="#EmulatorLauncher-458"><span class="linenos"> 458</span></a>
</span><span id="EmulatorLauncher-459"><a href="#EmulatorLauncher-459"><span class="linenos"> 459</span></a>        <span class="c1"># Update counters</span>
</span><span id="EmulatorLauncher-460"><a href="#EmulatorLauncher-460"><span class="linenos"> 460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span> <span class="o">=</span> <span class="n">num_roms</span>
</span><span id="EmulatorLauncher-461"><a href="#EmulatorLauncher-461"><span class="linenos"> 461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_rom_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">num_roms</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-462"><a href="#EmulatorLauncher-462"><span class="linenos"> 462</span></a>
</span><span id="EmulatorLauncher-463"><a href="#EmulatorLauncher-463"><span class="linenos"> 463</span></a>        <span class="c1"># Calculate scrolling</span>
</span><span id="EmulatorLauncher-464"><a href="#EmulatorLauncher-464"><span class="linenos"> 464</span></a>        <span class="k">if</span> <span class="n">num_roms</span> <span class="o">&lt;=</span> <span class="n">viewable_height</span><span class="p">:</span>
</span><span id="EmulatorLauncher-465"><a href="#EmulatorLauncher-465"><span class="linenos"> 465</span></a>            <span class="n">top_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-466"><a href="#EmulatorLauncher-466"><span class="linenos"> 466</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-467"><a href="#EmulatorLauncher-467"><span class="linenos"> 467</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-468"><a href="#EmulatorLauncher-468"><span class="linenos"> 468</span></a>                <span class="n">top_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-469"><a href="#EmulatorLauncher-469"><span class="linenos"> 469</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-470"><a href="#EmulatorLauncher-470"><span class="linenos"> 470</span></a>                <span class="n">top_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">-</span> <span class="p">(</span><span class="n">viewable_height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="EmulatorLauncher-471"><a href="#EmulatorLauncher-471"><span class="linenos"> 471</span></a>            <span class="n">top_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">top_index</span><span class="p">,</span> <span class="n">num_roms</span> <span class="o">-</span> <span class="n">viewable_height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="EmulatorLauncher-472"><a href="#EmulatorLauncher-472"><span class="linenos"> 472</span></a>
</span><span id="EmulatorLauncher-473"><a href="#EmulatorLauncher-473"><span class="linenos"> 473</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rom_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rom_list</span><span class="p">[</span><span class="n">top_index</span> <span class="p">:</span> <span class="n">top_index</span> <span class="o">+</span> <span class="n">viewable_height</span><span class="p">]):</span>
</span><span id="EmulatorLauncher-474"><a href="#EmulatorLauncher-474"><span class="linenos"> 474</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># Start below the border</span>
</span><span id="EmulatorLauncher-475"><a href="#EmulatorLauncher-475"><span class="linenos"> 475</span></a>            <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">viewable_height</span><span class="p">:</span>
</span><span id="EmulatorLauncher-476"><a href="#EmulatorLauncher-476"><span class="linenos"> 476</span></a>                <span class="k">break</span>
</span><span id="EmulatorLauncher-477"><a href="#EmulatorLauncher-477"><span class="linenos"> 477</span></a>
</span><span id="EmulatorLauncher-478"><a href="#EmulatorLauncher-478"><span class="linenos"> 478</span></a>            <span class="c1"># Determine ROM display information</span>
</span><span id="EmulatorLauncher-479"><a href="#EmulatorLauncher-479"><span class="linenos"> 479</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]:</span>
</span><span id="EmulatorLauncher-480"><a href="#EmulatorLauncher-480"><span class="linenos"> 480</span></a>                <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="EmulatorLauncher-481"><a href="#EmulatorLauncher-481"><span class="linenos"> 481</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher-482"><a href="#EmulatorLauncher-482"><span class="linenos"> 482</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-483"><a href="#EmulatorLauncher-483"><span class="linenos"> 483</span></a>                <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="EmulatorLauncher-484"><a href="#EmulatorLauncher-484"><span class="linenos"> 484</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-485"><a href="#EmulatorLauncher-485"><span class="linenos"> 485</span></a>
</span><span id="EmulatorLauncher-486"><a href="#EmulatorLauncher-486"><span class="linenos"> 486</span></a>            <span class="c1"># Add favorite star if needed</span>
</span><span id="EmulatorLauncher-487"><a href="#EmulatorLauncher-487"><span class="linenos"> 487</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_favorite</span><span class="p">(</span><span class="n">rom_path</span><span class="p">):</span>
</span><span id="EmulatorLauncher-488"><a href="#EmulatorLauncher-488"><span class="linenos"> 488</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">rom_name</span>
</span><span id="EmulatorLauncher-489"><a href="#EmulatorLauncher-489"><span class="linenos"> 489</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-490"><a href="#EmulatorLauncher-490"><span class="linenos"> 490</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">rom_name</span>
</span><span id="EmulatorLauncher-491"><a href="#EmulatorLauncher-491"><span class="linenos"> 491</span></a>
</span><span id="EmulatorLauncher-492"><a href="#EmulatorLauncher-492"><span class="linenos"> 492</span></a>            <span class="c1"># Get file size</span>
</span><span id="EmulatorLauncher-493"><a href="#EmulatorLauncher-493"><span class="linenos"> 493</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="EmulatorLauncher-494"><a href="#EmulatorLauncher-494"><span class="linenos"> 494</span></a>                <span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-495"><a href="#EmulatorLauncher-495"><span class="linenos"> 495</span></a>                <span class="n">file_size_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_size</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span><span id="EmulatorLauncher-496"><a href="#EmulatorLauncher-496"><span class="linenos"> 496</span></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="EmulatorLauncher-497"><a href="#EmulatorLauncher-497"><span class="linenos"> 497</span></a>                <span class="n">file_size_str</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="EmulatorLauncher-498"><a href="#EmulatorLauncher-498"><span class="linenos"> 498</span></a>
</span><span id="EmulatorLauncher-499"><a href="#EmulatorLauncher-499"><span class="linenos"> 499</span></a>            <span class="c1"># Calculate display positions</span>
</span><span id="EmulatorLauncher-500"><a href="#EmulatorLauncher-500"><span class="linenos"> 500</span></a>            <span class="n">win_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="EmulatorLauncher-501"><a href="#EmulatorLauncher-501"><span class="linenos"> 501</span></a>            <span class="n">size_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_size_str</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="EmulatorLauncher-502"><a href="#EmulatorLauncher-502"><span class="linenos"> 502</span></a>            <span class="n">name_width</span> <span class="o">=</span> <span class="n">win_width</span> <span class="o">-</span> <span class="n">size_width</span> <span class="o">-</span> <span class="mi">2</span>
</span><span id="EmulatorLauncher-503"><a href="#EmulatorLauncher-503"><span class="linenos"> 503</span></a>
</span><span id="EmulatorLauncher-504"><a href="#EmulatorLauncher-504"><span class="linenos"> 504</span></a>            <span class="c1"># Determine display attributes</span>
</span><span id="EmulatorLauncher-505"><a href="#EmulatorLauncher-505"><span class="linenos"> 505</span></a>            <span class="n">is_selected</span> <span class="o">=</span> <span class="p">(</span><span class="n">top_index</span> <span class="o">+</span> <span class="n">i</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-506"><a href="#EmulatorLauncher-506"><span class="linenos"> 506</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span>
</span><span id="EmulatorLauncher-507"><a href="#EmulatorLauncher-507"><span class="linenos"> 507</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher-508"><a href="#EmulatorLauncher-508"><span class="linenos"> 508</span></a>            <span class="k">if</span> <span class="n">is_selected</span><span class="p">:</span>
</span><span id="EmulatorLauncher-509"><a href="#EmulatorLauncher-509"><span class="linenos"> 509</span></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-510"><a href="#EmulatorLauncher-510"><span class="linenos"> 510</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_favorite</span><span class="p">(</span><span class="n">rom_path</span><span class="p">):</span>
</span><span id="EmulatorLauncher-511"><a href="#EmulatorLauncher-511"><span class="linenos"> 511</span></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">FAVORITE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-512"><a href="#EmulatorLauncher-512"><span class="linenos"> 512</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-513"><a href="#EmulatorLauncher-513"><span class="linenos"> 513</span></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher-514"><a href="#EmulatorLauncher-514"><span class="linenos"> 514</span></a>
</span><span id="EmulatorLauncher-515"><a href="#EmulatorLauncher-515"><span class="linenos"> 515</span></a>            <span class="c1"># Handle scrolling for long names</span>
</span><span id="EmulatorLauncher-516"><a href="#EmulatorLauncher-516"><span class="linenos"> 516</span></a>            <span class="k">if</span> <span class="n">is_selected</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">name_width</span><span class="p">:</span>
</span><span id="EmulatorLauncher-517"><a href="#EmulatorLauncher-517"><span class="linenos"> 517</span></a>                <span class="n">scroll_speed</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="EmulatorLauncher-518"><a href="#EmulatorLauncher-518"><span class="linenos"> 518</span></a>                <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="EmulatorLauncher-519"><a href="#EmulatorLauncher-519"><span class="linenos"> 519</span></a>                <span class="n">time_since_selection</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_selection_change_time</span>
</span><span id="EmulatorLauncher-520"><a href="#EmulatorLauncher-520"><span class="linenos"> 520</span></a>                <span class="n">scroll_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_since_selection</span> <span class="o">*</span> <span class="n">scroll_speed</span><span class="p">)</span>
</span><span id="EmulatorLauncher-521"><a href="#EmulatorLauncher-521"><span class="linenos"> 521</span></a>                <span class="n">scroll_offset</span> <span class="o">=</span> <span class="n">scroll_offset</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rom_name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="EmulatorLauncher-522"><a href="#EmulatorLauncher-522"><span class="linenos"> 522</span></a>                <span class="n">display_name</span> <span class="o">=</span> <span class="n">rom_name</span> <span class="o">+</span> <span class="s2">&quot;     &quot;</span> <span class="o">+</span> <span class="n">rom_name</span>
</span><span id="EmulatorLauncher-523"><a href="#EmulatorLauncher-523"><span class="linenos"> 523</span></a>                <span class="n">display_name</span> <span class="o">=</span> <span class="n">display_name</span><span class="p">[</span><span class="n">scroll_offset</span> <span class="p">:</span> <span class="n">scroll_offset</span> <span class="o">+</span> <span class="n">name_width</span><span class="p">]</span>
</span><span id="EmulatorLauncher-524"><a href="#EmulatorLauncher-524"><span class="linenos"> 524</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-525"><a href="#EmulatorLauncher-525"><span class="linenos"> 525</span></a>                <span class="n">display_name</span> <span class="o">=</span> <span class="n">rom_name</span><span class="p">[:</span><span class="n">name_width</span><span class="p">]</span>
</span><span id="EmulatorLauncher-526"><a href="#EmulatorLauncher-526"><span class="linenos"> 526</span></a>
</span><span id="EmulatorLauncher-527"><a href="#EmulatorLauncher-527"><span class="linenos"> 527</span></a>            <span class="c1"># Draw the ROM entry</span>
</span><span id="EmulatorLauncher-528"><a href="#EmulatorLauncher-528"><span class="linenos"> 528</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">display_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">name_width</span><span class="p">),</span> <span class="n">attr</span><span class="p">)</span>
</span><span id="EmulatorLauncher-529"><a href="#EmulatorLauncher-529"><span class="linenos"> 529</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">name_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">file_size_str</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
</span><span id="EmulatorLauncher-530"><a href="#EmulatorLauncher-530"><span class="linenos"> 530</span></a>
</span><span id="EmulatorLauncher-531"><a href="#EmulatorLauncher-531"><span class="linenos"> 531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span><span id="EmulatorLauncher-532"><a href="#EmulatorLauncher-532"><span class="linenos"> 532</span></a>
</span><span id="EmulatorLauncher-533"><a href="#EmulatorLauncher-533"><span class="linenos"> 533</span></a>    <span class="k">def</span> <span class="nf">launch_rom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emulator_path</span><span class="p">,</span> <span class="n">launch_arguments</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">,</span> <span class="n">start_in_directory</span><span class="p">):</span>
</span><span id="EmulatorLauncher-534"><a href="#EmulatorLauncher-534"><span class="linenos"> 534</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-535"><a href="#EmulatorLauncher-535"><span class="linenos"> 535</span></a><span class="sd">        Launches a ROM using the specified emulator and arguments.</span>
</span><span id="EmulatorLauncher-536"><a href="#EmulatorLauncher-536"><span class="linenos"> 536</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher-537"><a href="#EmulatorLauncher-537"><span class="linenos"> 537</span></a><span class="sd">            emulator_path (str): The file path to the emulator executable.</span>
</span><span id="EmulatorLauncher-538"><a href="#EmulatorLauncher-538"><span class="linenos"> 538</span></a><span class="sd">            launch_arguments (str): The arguments to pass to the emulator. Use &quot;{rom_path}&quot; as a placeholder for the ROM path.</span>
</span><span id="EmulatorLauncher-539"><a href="#EmulatorLauncher-539"><span class="linenos"> 539</span></a><span class="sd">            rom_path (str): The file path to the ROM to be launched.</span>
</span><span id="EmulatorLauncher-540"><a href="#EmulatorLauncher-540"><span class="linenos"> 540</span></a><span class="sd">            start_in_directory (str): The directory to set as the working directory when launching the emulator.</span>
</span><span id="EmulatorLauncher-541"><a href="#EmulatorLauncher-541"><span class="linenos"> 541</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher-542"><a href="#EmulatorLauncher-542"><span class="linenos"> 542</span></a><span class="sd">            subprocess.CalledProcessError: If there is an error launching the emulator.</span>
</span><span id="EmulatorLauncher-543"><a href="#EmulatorLauncher-543"><span class="linenos"> 543</span></a><span class="sd">            FileNotFoundError: If the emulator executable is not found at the specified path.</span>
</span><span id="EmulatorLauncher-544"><a href="#EmulatorLauncher-544"><span class="linenos"> 544</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-545"><a href="#EmulatorLauncher-545"><span class="linenos"> 545</span></a>        <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="n">emulator_path</span><span class="p">]</span>
</span><span id="EmulatorLauncher-546"><a href="#EmulatorLauncher-546"><span class="linenos"> 546</span></a>        <span class="k">if</span> <span class="n">launch_arguments</span><span class="p">:</span>
</span><span id="EmulatorLauncher-547"><a href="#EmulatorLauncher-547"><span class="linenos"> 547</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="n">launch_arguments</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="EmulatorLauncher-548"><a href="#EmulatorLauncher-548"><span class="linenos"> 548</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="EmulatorLauncher-549"><a href="#EmulatorLauncher-549"><span class="linenos"> 549</span></a>                <span class="k">if</span> <span class="s2">&quot;</span><span class="si">{rom_path}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
</span><span id="EmulatorLauncher-550"><a href="#EmulatorLauncher-550"><span class="linenos"> 550</span></a>                    <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{rom_path}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-551"><a href="#EmulatorLauncher-551"><span class="linenos"> 551</span></a>            <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="EmulatorLauncher-552"><a href="#EmulatorLauncher-552"><span class="linenos"> 552</span></a>
</span><span id="EmulatorLauncher-553"><a href="#EmulatorLauncher-553"><span class="linenos"> 553</span></a>        <span class="c1"># print(f&quot;Launching: {&#39; &#39;.join(command)}&quot;)</span>
</span><span id="EmulatorLauncher-554"><a href="#EmulatorLauncher-554"><span class="linenos"> 554</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="EmulatorLauncher-555"><a href="#EmulatorLauncher-555"><span class="linenos"> 555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span id="EmulatorLauncher-556"><a href="#EmulatorLauncher-556"><span class="linenos"> 556</span></a>                <span class="n">command</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">start_in_directory</span>
</span><span id="EmulatorLauncher-557"><a href="#EmulatorLauncher-557"><span class="linenos"> 557</span></a>            <span class="p">)</span>  <span class="c1"># Set working directory</span>
</span><span id="EmulatorLauncher-558"><a href="#EmulatorLauncher-558"><span class="linenos"> 558</span></a>        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EmulatorLauncher-559"><a href="#EmulatorLauncher-559"><span class="linenos"> 559</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error launching emulator: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher-560"><a href="#EmulatorLauncher-560"><span class="linenos"> 560</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="EmulatorLauncher-561"><a href="#EmulatorLauncher-561"><span class="linenos"> 561</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Emulator not found at: </span><span class="si">{</span><span class="n">emulator_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher-562"><a href="#EmulatorLauncher-562"><span class="linenos"> 562</span></a>
</span><span id="EmulatorLauncher-563"><a href="#EmulatorLauncher-563"><span class="linenos"> 563</span></a>    <span class="k">def</span> <span class="nf">update_filtered_roms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-564"><a href="#EmulatorLauncher-564"><span class="linenos"> 564</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-565"><a href="#EmulatorLauncher-565"><span class="linenos"> 565</span></a><span class="sd">        Updates the list of filtered ROMs based on the filter string and view mode.</span>
</span><span id="EmulatorLauncher-566"><a href="#EmulatorLauncher-566"><span class="linenos"> 566</span></a><span class="sd">        This method filters the ROMs according to the current filter string and view mode.</span>
</span><span id="EmulatorLauncher-567"><a href="#EmulatorLauncher-567"><span class="linenos"> 567</span></a><span class="sd">        The view modes can be &quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;. Depending on the view mode,</span>
</span><span id="EmulatorLauncher-568"><a href="#EmulatorLauncher-568"><span class="linenos"> 568</span></a><span class="sd">        the filtered ROMs are updated as follows:</span>
</span><span id="EmulatorLauncher-569"><a href="#EmulatorLauncher-569"><span class="linenos"> 569</span></a><span class="sd">        - &quot;systems&quot;: Filters ROMs within each system based on the filter string.</span>
</span><span id="EmulatorLauncher-570"><a href="#EmulatorLauncher-570"><span class="linenos"> 570</span></a><span class="sd">        - &quot;all&quot;: Filters all ROMs across all systems based on the filter string.</span>
</span><span id="EmulatorLauncher-571"><a href="#EmulatorLauncher-571"><span class="linenos"> 571</span></a><span class="sd">        - &quot;favorites&quot;: Filters favorite ROMs based on the filter string.</span>
</span><span id="EmulatorLauncher-572"><a href="#EmulatorLauncher-572"><span class="linenos"> 572</span></a><span class="sd">        If the filter string is empty, the filtered ROMs list is set to the full list of ROMs</span>
</span><span id="EmulatorLauncher-573"><a href="#EmulatorLauncher-573"><span class="linenos"> 573</span></a><span class="sd">        for the current view mode.</span>
</span><span id="EmulatorLauncher-574"><a href="#EmulatorLauncher-574"><span class="linenos"> 574</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher-575"><a href="#EmulatorLauncher-575"><span class="linenos"> 575</span></a><span class="sd">            filter_string (str): The string used to filter ROMs.</span>
</span><span id="EmulatorLauncher-576"><a href="#EmulatorLauncher-576"><span class="linenos"> 576</span></a><span class="sd">            view_mode (str): The current view mode (&quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;).</span>
</span><span id="EmulatorLauncher-577"><a href="#EmulatorLauncher-577"><span class="linenos"> 577</span></a><span class="sd">            roms (dict): A dictionary of ROMs categorized by system.</span>
</span><span id="EmulatorLauncher-578"><a href="#EmulatorLauncher-578"><span class="linenos"> 578</span></a><span class="sd">            all_roms (list): A list of all ROMs across all systems.</span>
</span><span id="EmulatorLauncher-579"><a href="#EmulatorLauncher-579"><span class="linenos"> 579</span></a><span class="sd">            filtered_roms (dict): A dictionary of filtered ROMs based on the filter string and view mode.</span>
</span><span id="EmulatorLauncher-580"><a href="#EmulatorLauncher-580"><span class="linenos"> 580</span></a><span class="sd">            get_favorite_roms_with_system (function): A function that returns favorite ROMs with their systems.</span>
</span><span id="EmulatorLauncher-581"><a href="#EmulatorLauncher-581"><span class="linenos"> 581</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-582"><a href="#EmulatorLauncher-582"><span class="linenos"> 582</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">:</span>
</span><span id="EmulatorLauncher-583"><a href="#EmulatorLauncher-583"><span class="linenos"> 583</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-584"><a href="#EmulatorLauncher-584"><span class="linenos"> 584</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">roms</span>
</span><span id="EmulatorLauncher-585"><a href="#EmulatorLauncher-585"><span class="linenos"> 585</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-586"><a href="#EmulatorLauncher-586"><span class="linenos"> 586</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;all&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span><span class="p">}</span>
</span><span id="EmulatorLauncher-587"><a href="#EmulatorLauncher-587"><span class="linenos"> 587</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-588"><a href="#EmulatorLauncher-588"><span class="linenos"> 588</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;favorites&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_favorite_roms_with_system</span><span class="p">()}</span>
</span><span id="EmulatorLauncher-589"><a href="#EmulatorLauncher-589"><span class="linenos"> 589</span></a>            <span class="k">return</span>
</span><span id="EmulatorLauncher-590"><a href="#EmulatorLauncher-590"><span class="linenos"> 590</span></a>
</span><span id="EmulatorLauncher-591"><a href="#EmulatorLauncher-591"><span class="linenos"> 591</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher-592"><a href="#EmulatorLauncher-592"><span class="linenos"> 592</span></a>
</span><span id="EmulatorLauncher-593"><a href="#EmulatorLauncher-593"><span class="linenos"> 593</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-594"><a href="#EmulatorLauncher-594"><span class="linenos"> 594</span></a>            <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">roms</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher-595"><a href="#EmulatorLauncher-595"><span class="linenos"> 595</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="p">[</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="EmulatorLauncher-596"><a href="#EmulatorLauncher-596"><span class="linenos"> 596</span></a>                    <span class="n">rom</span>
</span><span id="EmulatorLauncher-597"><a href="#EmulatorLauncher-597"><span class="linenos"> 597</span></a>                    <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">roms</span>
</span><span id="EmulatorLauncher-598"><a href="#EmulatorLauncher-598"><span class="linenos"> 598</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="EmulatorLauncher-599"><a href="#EmulatorLauncher-599"><span class="linenos"> 599</span></a>                <span class="p">]</span>
</span><span id="EmulatorLauncher-600"><a href="#EmulatorLauncher-600"><span class="linenos"> 600</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-601"><a href="#EmulatorLauncher-601"><span class="linenos"> 601</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="EmulatorLauncher-602"><a href="#EmulatorLauncher-602"><span class="linenos"> 602</span></a>                <span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rom</span><span class="p">)</span>
</span><span id="EmulatorLauncher-603"><a href="#EmulatorLauncher-603"><span class="linenos"> 603</span></a>                <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">rom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span>
</span><span id="EmulatorLauncher-604"><a href="#EmulatorLauncher-604"><span class="linenos"> 604</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="EmulatorLauncher-605"><a href="#EmulatorLauncher-605"><span class="linenos"> 605</span></a>            <span class="p">]</span>
</span><span id="EmulatorLauncher-606"><a href="#EmulatorLauncher-606"><span class="linenos"> 606</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-607"><a href="#EmulatorLauncher-607"><span class="linenos"> 607</span></a>            <span class="n">favorite_roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_favorite_roms_with_system</span><span class="p">()</span>
</span><span id="EmulatorLauncher-608"><a href="#EmulatorLauncher-608"><span class="linenos"> 608</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="p">[</span><span class="s2">&quot;favorites&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="EmulatorLauncher-609"><a href="#EmulatorLauncher-609"><span class="linenos"> 609</span></a>                <span class="n">rom_data</span>
</span><span id="EmulatorLauncher-610"><a href="#EmulatorLauncher-610"><span class="linenos"> 610</span></a>                <span class="k">for</span> <span class="n">rom_data</span> <span class="ow">in</span> <span class="n">favorite_roms</span>
</span><span id="EmulatorLauncher-611"><a href="#EmulatorLauncher-611"><span class="linenos"> 611</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="EmulatorLauncher-612"><a href="#EmulatorLauncher-612"><span class="linenos"> 612</span></a>            <span class="p">]</span>
</span><span id="EmulatorLauncher-613"><a href="#EmulatorLauncher-613"><span class="linenos"> 613</span></a>
</span><span id="EmulatorLauncher-614"><a href="#EmulatorLauncher-614"><span class="linenos"> 614</span></a>    <span class="k">def</span> <span class="nf">get_favorite_roms_with_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-615"><a href="#EmulatorLauncher-615"><span class="linenos"> 615</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-616"><a href="#EmulatorLauncher-616"><span class="linenos"> 616</span></a><span class="sd">        Returns a list of favorite ROMs with their system names.</span>
</span><span id="EmulatorLauncher-617"><a href="#EmulatorLauncher-617"><span class="linenos"> 617</span></a>
</span><span id="EmulatorLauncher-618"><a href="#EmulatorLauncher-618"><span class="linenos"> 618</span></a><span class="sd">        This method iterates through the &#39;favorites&#39; dictionary, which contains</span>
</span><span id="EmulatorLauncher-619"><a href="#EmulatorLauncher-619"><span class="linenos"> 619</span></a><span class="sd">        system names as keys and lists of favorite ROMs as values. It creates a</span>
</span><span id="EmulatorLauncher-620"><a href="#EmulatorLauncher-620"><span class="linenos"> 620</span></a><span class="sd">        list of tuples, where each tuple contains a system name and a ROM name.</span>
</span><span id="EmulatorLauncher-621"><a href="#EmulatorLauncher-621"><span class="linenos"> 621</span></a>
</span><span id="EmulatorLauncher-622"><a href="#EmulatorLauncher-622"><span class="linenos"> 622</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher-623"><a href="#EmulatorLauncher-623"><span class="linenos"> 623</span></a><span class="sd">            list of tuple: A list of tuples, where each tuple contains a system</span>
</span><span id="EmulatorLauncher-624"><a href="#EmulatorLauncher-624"><span class="linenos"> 624</span></a><span class="sd">            name (str) and a ROM name (str).</span>
</span><span id="EmulatorLauncher-625"><a href="#EmulatorLauncher-625"><span class="linenos"> 625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-626"><a href="#EmulatorLauncher-626"><span class="linenos"> 626</span></a>        <span class="n">favorite_roms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher-627"><a href="#EmulatorLauncher-627"><span class="linenos"> 627</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">roms</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher-628"><a href="#EmulatorLauncher-628"><span class="linenos"> 628</span></a>            <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">roms</span><span class="p">:</span>
</span><span id="EmulatorLauncher-629"><a href="#EmulatorLauncher-629"><span class="linenos"> 629</span></a>                <span class="n">favorite_roms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">system</span><span class="p">,</span> <span class="n">rom</span><span class="p">))</span>
</span><span id="EmulatorLauncher-630"><a href="#EmulatorLauncher-630"><span class="linenos"> 630</span></a>        <span class="k">return</span> <span class="n">favorite_roms</span>
</span><span id="EmulatorLauncher-631"><a href="#EmulatorLauncher-631"><span class="linenos"> 631</span></a>
</span><span id="EmulatorLauncher-632"><a href="#EmulatorLauncher-632"><span class="linenos"> 632</span></a>    <span class="k">def</span> <span class="nf">toggle_favorite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-633"><a href="#EmulatorLauncher-633"><span class="linenos"> 633</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-634"><a href="#EmulatorLauncher-634"><span class="linenos"> 634</span></a><span class="sd">        Toggles the favorite status of the currently selected ROM.</span>
</span><span id="EmulatorLauncher-635"><a href="#EmulatorLauncher-635"><span class="linenos"> 635</span></a><span class="sd">        Depending on the current view mode, this method will:</span>
</span><span id="EmulatorLauncher-636"><a href="#EmulatorLauncher-636"><span class="linenos"> 636</span></a><span class="sd">        - In &quot;systems&quot; view mode: Toggle the favorite status of the selected ROM within the selected system.</span>
</span><span id="EmulatorLauncher-637"><a href="#EmulatorLauncher-637"><span class="linenos"> 637</span></a><span class="sd">        - In &quot;all&quot; view mode: Toggle the favorite status of the selected ROM from the complete list of ROMs.</span>
</span><span id="EmulatorLauncher-638"><a href="#EmulatorLauncher-638"><span class="linenos"> 638</span></a><span class="sd">        - In &quot;favorites&quot; view mode: Toggle the favorite status of the selected ROM from the list of favorite ROMs.</span>
</span><span id="EmulatorLauncher-639"><a href="#EmulatorLauncher-639"><span class="linenos"> 639</span></a><span class="sd">        After toggling the favorite status, the method updates the filtered ROMs list and redraws the ROM window.</span>
</span><span id="EmulatorLauncher-640"><a href="#EmulatorLauncher-640"><span class="linenos"> 640</span></a><span class="sd">        It also ensures that the ROM selection position is restored and within bounds.</span>
</span><span id="EmulatorLauncher-641"><a href="#EmulatorLauncher-641"><span class="linenos"> 641</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher-642"><a href="#EmulatorLauncher-642"><span class="linenos"> 642</span></a><span class="sd">            self.selected_rom (int): The index of the currently selected ROM.</span>
</span><span id="EmulatorLauncher-643"><a href="#EmulatorLauncher-643"><span class="linenos"> 643</span></a><span class="sd">            self.view_mode (str): The current view mode (&quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;).</span>
</span><span id="EmulatorLauncher-644"><a href="#EmulatorLauncher-644"><span class="linenos"> 644</span></a><span class="sd">            self.roms (dict): A dictionary containing ROMs categorized by systems.</span>
</span><span id="EmulatorLauncher-645"><a href="#EmulatorLauncher-645"><span class="linenos"> 645</span></a><span class="sd">            self.filtered_roms (dict): A dictionary containing filtered ROMs based on the current view mode.</span>
</span><span id="EmulatorLauncher-646"><a href="#EmulatorLauncher-646"><span class="linenos"> 646</span></a><span class="sd">            self.favorites (dict): A dictionary containing favorite ROMs categorized by systems.</span>
</span><span id="EmulatorLauncher-647"><a href="#EmulatorLauncher-647"><span class="linenos"> 647</span></a><span class="sd">            self.selected_system (int): The index of the currently selected system.</span>
</span><span id="EmulatorLauncher-648"><a href="#EmulatorLauncher-648"><span class="linenos"> 648</span></a><span class="sd">        Methods:</span>
</span><span id="EmulatorLauncher-649"><a href="#EmulatorLauncher-649"><span class="linenos"> 649</span></a><span class="sd">            self.save_favorites(): Saves the current state of favorite ROMs.</span>
</span><span id="EmulatorLauncher-650"><a href="#EmulatorLauncher-650"><span class="linenos"> 650</span></a><span class="sd">            self.toggle_favorite_by_system_and_path(system, rom_path): Toggles the favorite status of a ROM by system and path.</span>
</span><span id="EmulatorLauncher-651"><a href="#EmulatorLauncher-651"><span class="linenos"> 651</span></a><span class="sd">            self.update_filtered_roms(): Updates the list of filtered ROMs based on the current view mode.</span>
</span><span id="EmulatorLauncher-652"><a href="#EmulatorLauncher-652"><span class="linenos"> 652</span></a><span class="sd">            self.draw_rom_window(): Redraws the ROM window to reflect the current state.</span>
</span><span id="EmulatorLauncher-653"><a href="#EmulatorLauncher-653"><span class="linenos"> 653</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-654"><a href="#EmulatorLauncher-654"><span class="linenos"> 654</span></a>        <span class="n">current_rom_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span>  <span class="c1"># Store the current ROM index</span>
</span><span id="EmulatorLauncher-655"><a href="#EmulatorLauncher-655"><span class="linenos"> 655</span></a>
</span><span id="EmulatorLauncher-656"><a href="#EmulatorLauncher-656"><span class="linenos"> 656</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-657"><a href="#EmulatorLauncher-657"><span class="linenos"> 657</span></a>            <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="EmulatorLauncher-658"><a href="#EmulatorLauncher-658"><span class="linenos"> 658</span></a>            <span class="k">if</span> <span class="n">systems</span><span class="p">:</span>
</span><span id="EmulatorLauncher-659"><a href="#EmulatorLauncher-659"><span class="linenos"> 659</span></a>                <span class="n">selected_system_name</span> <span class="o">=</span> <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="EmulatorLauncher-660"><a href="#EmulatorLauncher-660"><span class="linenos"> 660</span></a>                <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_system_name</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-661"><a href="#EmulatorLauncher-661"><span class="linenos"> 661</span></a>                <span class="k">if</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="EmulatorLauncher-662"><a href="#EmulatorLauncher-662"><span class="linenos"> 662</span></a>                    <span class="n">selected_rom_path</span> <span class="o">=</span> <span class="n">rom_list</span><span class="p">[</span><span class="n">current_rom_index</span><span class="p">]</span>  <span class="c1"># Use stored index</span>
</span><span id="EmulatorLauncher-663"><a href="#EmulatorLauncher-663"><span class="linenos"> 663</span></a>
</span><span id="EmulatorLauncher-664"><a href="#EmulatorLauncher-664"><span class="linenos"> 664</span></a>                    <span class="k">if</span> <span class="n">selected_system_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">:</span>
</span><span id="EmulatorLauncher-665"><a href="#EmulatorLauncher-665"><span class="linenos"> 665</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher-666"><a href="#EmulatorLauncher-666"><span class="linenos"> 666</span></a>
</span><span id="EmulatorLauncher-667"><a href="#EmulatorLauncher-667"><span class="linenos"> 667</span></a>                    <span class="k">if</span> <span class="n">selected_rom_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]:</span>
</span><span id="EmulatorLauncher-668"><a href="#EmulatorLauncher-668"><span class="linenos"> 668</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">selected_rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-669"><a href="#EmulatorLauncher-669"><span class="linenos"> 669</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-670"><a href="#EmulatorLauncher-670"><span class="linenos"> 670</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selected_rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-671"><a href="#EmulatorLauncher-671"><span class="linenos"> 671</span></a>
</span><span id="EmulatorLauncher-672"><a href="#EmulatorLauncher-672"><span class="linenos"> 672</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]:</span>
</span><span id="EmulatorLauncher-673"><a href="#EmulatorLauncher-673"><span class="linenos"> 673</span></a>                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span>
</span><span id="EmulatorLauncher-674"><a href="#EmulatorLauncher-674"><span class="linenos"> 674</span></a>
</span><span id="EmulatorLauncher-675"><a href="#EmulatorLauncher-675"><span class="linenos"> 675</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">save_favorites</span><span class="p">()</span>
</span><span id="EmulatorLauncher-676"><a href="#EmulatorLauncher-676"><span class="linenos"> 676</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-677"><a href="#EmulatorLauncher-677"><span class="linenos"> 677</span></a>            <span class="n">rom_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])[</span>
</span><span id="EmulatorLauncher-678"><a href="#EmulatorLauncher-678"><span class="linenos"> 678</span></a>                <span class="n">current_rom_index</span>
</span><span id="EmulatorLauncher-679"><a href="#EmulatorLauncher-679"><span class="linenos"> 679</span></a>            <span class="p">]</span>  <span class="c1"># Use stored index</span>
</span><span id="EmulatorLauncher-680"><a href="#EmulatorLauncher-680"><span class="linenos"> 680</span></a>            <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="EmulatorLauncher-681"><a href="#EmulatorLauncher-681"><span class="linenos"> 681</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite_by_system_and_path</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-682"><a href="#EmulatorLauncher-682"><span class="linenos"> 682</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-683"><a href="#EmulatorLauncher-683"><span class="linenos"> 683</span></a>            <span class="n">rom_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])[</span>
</span><span id="EmulatorLauncher-684"><a href="#EmulatorLauncher-684"><span class="linenos"> 684</span></a>                <span class="n">current_rom_index</span>
</span><span id="EmulatorLauncher-685"><a href="#EmulatorLauncher-685"><span class="linenos"> 685</span></a>            <span class="p">]</span>  <span class="c1"># Use stored index</span>
</span><span id="EmulatorLauncher-686"><a href="#EmulatorLauncher-686"><span class="linenos"> 686</span></a>            <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="EmulatorLauncher-687"><a href="#EmulatorLauncher-687"><span class="linenos"> 687</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite_by_system_and_path</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-688"><a href="#EmulatorLauncher-688"><span class="linenos"> 688</span></a>
</span><span id="EmulatorLauncher-689"><a href="#EmulatorLauncher-689"><span class="linenos"> 689</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-690"><a href="#EmulatorLauncher-690"><span class="linenos"> 690</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher-691"><a href="#EmulatorLauncher-691"><span class="linenos"> 691</span></a>
</span><span id="EmulatorLauncher-692"><a href="#EmulatorLauncher-692"><span class="linenos"> 692</span></a>        <span class="c1"># Restore the ROM selection position</span>
</span><span id="EmulatorLauncher-693"><a href="#EmulatorLauncher-693"><span class="linenos"> 693</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-694"><a href="#EmulatorLauncher-694"><span class="linenos"> 694</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">],</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-695"><a href="#EmulatorLauncher-695"><span class="linenos"> 695</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-696"><a href="#EmulatorLauncher-696"><span class="linenos"> 696</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-697"><a href="#EmulatorLauncher-697"><span class="linenos"> 697</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-698"><a href="#EmulatorLauncher-698"><span class="linenos"> 698</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-699"><a href="#EmulatorLauncher-699"><span class="linenos"> 699</span></a>
</span><span id="EmulatorLauncher-700"><a href="#EmulatorLauncher-700"><span class="linenos"> 700</span></a>        <span class="c1"># Ensure the stored index is within bounds</span>
</span><span id="EmulatorLauncher-701"><a href="#EmulatorLauncher-701"><span class="linenos"> 701</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">current_rom_index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher-702"><a href="#EmulatorLauncher-702"><span class="linenos"> 702</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Ensure it&#39;s not negative</span>
</span><span id="EmulatorLauncher-703"><a href="#EmulatorLauncher-703"><span class="linenos"> 703</span></a>
</span><span id="EmulatorLauncher-704"><a href="#EmulatorLauncher-704"><span class="linenos"> 704</span></a>    <span class="k">def</span> <span class="nf">toggle_favorite_by_system_and_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">):</span>
</span><span id="EmulatorLauncher-705"><a href="#EmulatorLauncher-705"><span class="linenos"> 705</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-706"><a href="#EmulatorLauncher-706"><span class="linenos"> 706</span></a><span class="sd">        Toggles the favorite status of a ROM by its system and path.</span>
</span><span id="EmulatorLauncher-707"><a href="#EmulatorLauncher-707"><span class="linenos"> 707</span></a><span class="sd">        If the ROM is already a favorite, it will be removed from the favorites list.</span>
</span><span id="EmulatorLauncher-708"><a href="#EmulatorLauncher-708"><span class="linenos"> 708</span></a><span class="sd">        If the ROM is not a favorite, it will be added to the favorites list.</span>
</span><span id="EmulatorLauncher-709"><a href="#EmulatorLauncher-709"><span class="linenos"> 709</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher-710"><a href="#EmulatorLauncher-710"><span class="linenos"> 710</span></a><span class="sd">            system (str): The system to which the ROM belongs.</span>
</span><span id="EmulatorLauncher-711"><a href="#EmulatorLauncher-711"><span class="linenos"> 711</span></a><span class="sd">            rom_path (str): The file path of the ROM.</span>
</span><span id="EmulatorLauncher-712"><a href="#EmulatorLauncher-712"><span class="linenos"> 712</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher-713"><a href="#EmulatorLauncher-713"><span class="linenos"> 713</span></a><span class="sd">            None</span>
</span><span id="EmulatorLauncher-714"><a href="#EmulatorLauncher-714"><span class="linenos"> 714</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-715"><a href="#EmulatorLauncher-715"><span class="linenos"> 715</span></a>        <span class="k">if</span> <span class="n">system</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">:</span>
</span><span id="EmulatorLauncher-716"><a href="#EmulatorLauncher-716"><span class="linenos"> 716</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher-717"><a href="#EmulatorLauncher-717"><span class="linenos"> 717</span></a>
</span><span id="EmulatorLauncher-718"><a href="#EmulatorLauncher-718"><span class="linenos"> 718</span></a>        <span class="k">if</span> <span class="n">rom_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]:</span>
</span><span id="EmulatorLauncher-719"><a href="#EmulatorLauncher-719"><span class="linenos"> 719</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-720"><a href="#EmulatorLauncher-720"><span class="linenos"> 720</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]:</span>
</span><span id="EmulatorLauncher-721"><a href="#EmulatorLauncher-721"><span class="linenos"> 721</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span>
</span><span id="EmulatorLauncher-722"><a href="#EmulatorLauncher-722"><span class="linenos"> 722</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-723"><a href="#EmulatorLauncher-723"><span class="linenos"> 723</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher-724"><a href="#EmulatorLauncher-724"><span class="linenos"> 724</span></a>
</span><span id="EmulatorLauncher-725"><a href="#EmulatorLauncher-725"><span class="linenos"> 725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">save_favorites</span><span class="p">()</span>
</span><span id="EmulatorLauncher-726"><a href="#EmulatorLauncher-726"><span class="linenos"> 726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-727"><a href="#EmulatorLauncher-727"><span class="linenos"> 727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher-728"><a href="#EmulatorLauncher-728"><span class="linenos"> 728</span></a>
</span><span id="EmulatorLauncher-729"><a href="#EmulatorLauncher-729"><span class="linenos"> 729</span></a>    <span class="k">def</span> <span class="nf">is_favorite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">):</span>
</span><span id="EmulatorLauncher-730"><a href="#EmulatorLauncher-730"><span class="linenos"> 730</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-731"><a href="#EmulatorLauncher-731"><span class="linenos"> 731</span></a><span class="sd">        Check if a ROM is marked as a favorite.</span>
</span><span id="EmulatorLauncher-732"><a href="#EmulatorLauncher-732"><span class="linenos"> 732</span></a>
</span><span id="EmulatorLauncher-733"><a href="#EmulatorLauncher-733"><span class="linenos"> 733</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher-734"><a href="#EmulatorLauncher-734"><span class="linenos"> 734</span></a><span class="sd">            rom_path (str): The file path of the ROM to check.</span>
</span><span id="EmulatorLauncher-735"><a href="#EmulatorLauncher-735"><span class="linenos"> 735</span></a>
</span><span id="EmulatorLauncher-736"><a href="#EmulatorLauncher-736"><span class="linenos"> 736</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher-737"><a href="#EmulatorLauncher-737"><span class="linenos"> 737</span></a><span class="sd">            bool: True if the ROM is a favorite, False otherwise.</span>
</span><span id="EmulatorLauncher-738"><a href="#EmulatorLauncher-738"><span class="linenos"> 738</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-739"><a href="#EmulatorLauncher-739"><span class="linenos"> 739</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">favorites</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher-740"><a href="#EmulatorLauncher-740"><span class="linenos"> 740</span></a>            <span class="k">if</span> <span class="n">rom_path</span> <span class="ow">in</span> <span class="n">favorites</span><span class="p">:</span>
</span><span id="EmulatorLauncher-741"><a href="#EmulatorLauncher-741"><span class="linenos"> 741</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="EmulatorLauncher-742"><a href="#EmulatorLauncher-742"><span class="linenos"> 742</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="EmulatorLauncher-743"><a href="#EmulatorLauncher-743"><span class="linenos"> 743</span></a>
</span><span id="EmulatorLauncher-744"><a href="#EmulatorLauncher-744"><span class="linenos"> 744</span></a>    <span class="k">def</span> <span class="nf">handle_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="EmulatorLauncher-745"><a href="#EmulatorLauncher-745"><span class="linenos"> 745</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-746"><a href="#EmulatorLauncher-746"><span class="linenos"> 746</span></a><span class="sd">        Handles user input for navigating and filtering ROMs.</span>
</span><span id="EmulatorLauncher-747"><a href="#EmulatorLauncher-747"><span class="linenos"> 747</span></a><span class="sd">        Parameters:</span>
</span><span id="EmulatorLauncher-748"><a href="#EmulatorLauncher-748"><span class="linenos"> 748</span></a><span class="sd">        key (int): The key code of the pressed key.</span>
</span><span id="EmulatorLauncher-749"><a href="#EmulatorLauncher-749"><span class="linenos"> 749</span></a><span class="sd">        Behavior:</span>
</span><span id="EmulatorLauncher-750"><a href="#EmulatorLauncher-750"><span class="linenos"> 750</span></a><span class="sd">        - In &quot;filter&quot; mode:</span>
</span><span id="EmulatorLauncher-751"><a href="#EmulatorLauncher-751"><span class="linenos"> 751</span></a><span class="sd">            - Escape key (27): Switch to &quot;navigate&quot; mode, clear filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="EmulatorLauncher-752"><a href="#EmulatorLauncher-752"><span class="linenos"> 752</span></a><span class="sd">            - Enter key (10): Launch the selected ROM.</span>
</span><span id="EmulatorLauncher-753"><a href="#EmulatorLauncher-753"><span class="linenos"> 753</span></a><span class="sd">            - Backspace key (curses.KEY_BACKSPACE, 127, 8): Remove the last character from the filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="EmulatorLauncher-754"><a href="#EmulatorLauncher-754"><span class="linenos"> 754</span></a><span class="sd">            - Up key (curses.KEY_UP): Move the selection up in the filtered ROM list.</span>
</span><span id="EmulatorLauncher-755"><a href="#EmulatorLauncher-755"><span class="linenos"> 755</span></a><span class="sd">            - Down key (curses.KEY_DOWN): Move the selection down in the filtered ROM list.</span>
</span><span id="EmulatorLauncher-756"><a href="#EmulatorLauncher-756"><span class="linenos"> 756</span></a><span class="sd">            - F2 key (curses.KEY_F2): Toggle favorite status of the selected ROM if focus is on ROMs.</span>
</span><span id="EmulatorLauncher-757"><a href="#EmulatorLauncher-757"><span class="linenos"> 757</span></a><span class="sd">            - Printable characters (32-126): Append the character to the filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="EmulatorLauncher-758"><a href="#EmulatorLauncher-758"><span class="linenos"> 758</span></a><span class="sd">        - In &quot;navigate&quot; mode:</span>
</span><span id="EmulatorLauncher-759"><a href="#EmulatorLauncher-759"><span class="linenos"> 759</span></a><span class="sd">            - Up key (curses.KEY_UP): Navigate through ROMs or switch view modes and systems.</span>
</span><span id="EmulatorLauncher-760"><a href="#EmulatorLauncher-760"><span class="linenos"> 760</span></a><span class="sd">            - Down key (curses.KEY_DOWN): Navigate through ROMs or switch view modes and systems.</span>
</span><span id="EmulatorLauncher-761"><a href="#EmulatorLauncher-761"><span class="linenos"> 761</span></a><span class="sd">            - Left key (curses.KEY_LEFT): Set focus to systems.</span>
</span><span id="EmulatorLauncher-762"><a href="#EmulatorLauncher-762"><span class="linenos"> 762</span></a><span class="sd">            - Right key (curses.KEY_RIGHT): Set focus to ROMs.</span>
</span><span id="EmulatorLauncher-763"><a href="#EmulatorLauncher-763"><span class="linenos"> 763</span></a><span class="sd">            - Slash key (ord(&quot;/&quot;)): Switch to &quot;filter&quot; mode, clear filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="EmulatorLauncher-764"><a href="#EmulatorLauncher-764"><span class="linenos"> 764</span></a><span class="sd">            - Enter key (10): Launch the selected ROM.</span>
</span><span id="EmulatorLauncher-765"><a href="#EmulatorLauncher-765"><span class="linenos"> 765</span></a><span class="sd">            - F2 key (curses.KEY_F2): Toggle favorite status of the selected ROM if focus is on ROMs.</span>
</span><span id="EmulatorLauncher-766"><a href="#EmulatorLauncher-766"><span class="linenos"> 766</span></a><span class="sd">        Updates:</span>
</span><span id="EmulatorLauncher-767"><a href="#EmulatorLauncher-767"><span class="linenos"> 767</span></a><span class="sd">        - Updates the timestamp if any selection state changes.</span>
</span><span id="EmulatorLauncher-768"><a href="#EmulatorLauncher-768"><span class="linenos"> 768</span></a><span class="sd">        - Redraws the ROM window, system window, and filter bar.</span>
</span><span id="EmulatorLauncher-769"><a href="#EmulatorLauncher-769"><span class="linenos"> 769</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-770"><a href="#EmulatorLauncher-770"><span class="linenos"> 770</span></a>        <span class="n">prev_selected_rom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span>
</span><span id="EmulatorLauncher-771"><a href="#EmulatorLauncher-771"><span class="linenos"> 771</span></a>        <span class="n">prev_view_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span>
</span><span id="EmulatorLauncher-772"><a href="#EmulatorLauncher-772"><span class="linenos"> 772</span></a>        <span class="n">prev_selected_system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span>
</span><span id="EmulatorLauncher-773"><a href="#EmulatorLauncher-773"><span class="linenos"> 773</span></a>
</span><span id="EmulatorLauncher-774"><a href="#EmulatorLauncher-774"><span class="linenos"> 774</span></a>        <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="EmulatorLauncher-775"><a href="#EmulatorLauncher-775"><span class="linenos"> 775</span></a>        <span class="n">num_systems</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">systems</span><span class="p">)</span>
</span><span id="EmulatorLauncher-776"><a href="#EmulatorLauncher-776"><span class="linenos"> 776</span></a>
</span><span id="EmulatorLauncher-777"><a href="#EmulatorLauncher-777"><span class="linenos"> 777</span></a>        <span class="n">rom_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher-778"><a href="#EmulatorLauncher-778"><span class="linenos"> 778</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="n">systems</span><span class="p">:</span>
</span><span id="EmulatorLauncher-779"><a href="#EmulatorLauncher-779"><span class="linenos"> 779</span></a>            <span class="n">selected_system_name</span> <span class="o">=</span> <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="EmulatorLauncher-780"><a href="#EmulatorLauncher-780"><span class="linenos"> 780</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_system_name</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-781"><a href="#EmulatorLauncher-781"><span class="linenos"> 781</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-782"><a href="#EmulatorLauncher-782"><span class="linenos"> 782</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-783"><a href="#EmulatorLauncher-783"><span class="linenos"> 783</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-784"><a href="#EmulatorLauncher-784"><span class="linenos"> 784</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher-785"><a href="#EmulatorLauncher-785"><span class="linenos"> 785</span></a>
</span><span id="EmulatorLauncher-786"><a href="#EmulatorLauncher-786"><span class="linenos"> 786</span></a>        <span class="n">num_roms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_list</span><span class="p">)</span>
</span><span id="EmulatorLauncher-787"><a href="#EmulatorLauncher-787"><span class="linenos"> 787</span></a>
</span><span id="EmulatorLauncher-788"><a href="#EmulatorLauncher-788"><span class="linenos"> 788</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;filter&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-789"><a href="#EmulatorLauncher-789"><span class="linenos"> 789</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>  <span class="c1"># Escape key</span>
</span><span id="EmulatorLauncher-790"><a href="#EmulatorLauncher-790"><span class="linenos"> 790</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="EmulatorLauncher-791"><a href="#EmulatorLauncher-791"><span class="linenos"> 791</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="EmulatorLauncher-792"><a href="#EmulatorLauncher-792"><span class="linenos"> 792</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-793"><a href="#EmulatorLauncher-793"><span class="linenos"> 793</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-794"><a href="#EmulatorLauncher-794"><span class="linenos"> 794</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># Enter key in filter mode</span>
</span><span id="EmulatorLauncher-795"><a href="#EmulatorLauncher-795"><span class="linenos"> 795</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">launch_selected_rom</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">rom_list</span><span class="p">)</span>
</span><span id="EmulatorLauncher-796"><a href="#EmulatorLauncher-796"><span class="linenos"> 796</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_BACKSPACE</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">127</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="EmulatorLauncher-797"><a href="#EmulatorLauncher-797"><span class="linenos"> 797</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">:</span>
</span><span id="EmulatorLauncher-798"><a href="#EmulatorLauncher-798"><span class="linenos"> 798</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="EmulatorLauncher-799"><a href="#EmulatorLauncher-799"><span class="linenos"> 799</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-800"><a href="#EmulatorLauncher-800"><span class="linenos"> 800</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-801"><a href="#EmulatorLauncher-801"><span class="linenos"> 801</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">:</span>
</span><span id="EmulatorLauncher-802"><a href="#EmulatorLauncher-802"><span class="linenos"> 802</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-803"><a href="#EmulatorLauncher-803"><span class="linenos"> 803</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-804"><a href="#EmulatorLauncher-804"><span class="linenos"> 804</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">:</span>
</span><span id="EmulatorLauncher-805"><a href="#EmulatorLauncher-805"><span class="linenos"> 805</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">&lt;</span> <span class="n">num_roms</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher-806"><a href="#EmulatorLauncher-806"><span class="linenos"> 806</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-807"><a href="#EmulatorLauncher-807"><span class="linenos"> 807</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_F2</span><span class="p">:</span>
</span><span id="EmulatorLauncher-808"><a href="#EmulatorLauncher-808"><span class="linenos"> 808</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-809"><a href="#EmulatorLauncher-809"><span class="linenos"> 809</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite</span><span class="p">()</span>
</span><span id="EmulatorLauncher-810"><a href="#EmulatorLauncher-810"><span class="linenos"> 810</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">&gt;=</span> <span class="mi">32</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">&lt;=</span> <span class="mi">126</span><span class="p">:</span>  <span class="c1"># Printable characters</span>
</span><span id="EmulatorLauncher-811"><a href="#EmulatorLauncher-811"><span class="linenos"> 811</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="EmulatorLauncher-812"><a href="#EmulatorLauncher-812"><span class="linenos"> 812</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-813"><a href="#EmulatorLauncher-813"><span class="linenos"> 813</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-814"><a href="#EmulatorLauncher-814"><span class="linenos"> 814</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Navigate mode</span>
</span><span id="EmulatorLauncher-815"><a href="#EmulatorLauncher-815"><span class="linenos"> 815</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">:</span>
</span><span id="EmulatorLauncher-816"><a href="#EmulatorLauncher-816"><span class="linenos"> 816</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span> <span class="ow">and</span> <span class="n">num_roms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-817"><a href="#EmulatorLauncher-817"><span class="linenos"> 817</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">num_roms</span>
</span><span id="EmulatorLauncher-818"><a href="#EmulatorLauncher-818"><span class="linenos"> 818</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-819"><a href="#EmulatorLauncher-819"><span class="linenos"> 819</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-820"><a href="#EmulatorLauncher-820"><span class="linenos"> 820</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher-821"><a href="#EmulatorLauncher-821"><span class="linenos"> 821</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">=</span> <span class="n">num_systems</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-822"><a href="#EmulatorLauncher-822"><span class="linenos"> 822</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-823"><a href="#EmulatorLauncher-823"><span class="linenos"> 823</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-824"><a href="#EmulatorLauncher-824"><span class="linenos"> 824</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">num_systems</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-825"><a href="#EmulatorLauncher-825"><span class="linenos"> 825</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;favorites&quot;</span>
</span><span id="EmulatorLauncher-826"><a href="#EmulatorLauncher-826"><span class="linenos"> 826</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-827"><a href="#EmulatorLauncher-827"><span class="linenos"> 827</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-828"><a href="#EmulatorLauncher-828"><span class="linenos"> 828</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-829"><a href="#EmulatorLauncher-829"><span class="linenos"> 829</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</span><span id="EmulatorLauncher-830"><a href="#EmulatorLauncher-830"><span class="linenos"> 830</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-831"><a href="#EmulatorLauncher-831"><span class="linenos"> 831</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-832"><a href="#EmulatorLauncher-832"><span class="linenos"> 832</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-833"><a href="#EmulatorLauncher-833"><span class="linenos"> 833</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-834"><a href="#EmulatorLauncher-834"><span class="linenos"> 834</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-835"><a href="#EmulatorLauncher-835"><span class="linenos"> 835</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">:</span>
</span><span id="EmulatorLauncher-836"><a href="#EmulatorLauncher-836"><span class="linenos"> 836</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span> <span class="ow">and</span> <span class="n">num_roms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-837"><a href="#EmulatorLauncher-837"><span class="linenos"> 837</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">num_roms</span>
</span><span id="EmulatorLauncher-838"><a href="#EmulatorLauncher-838"><span class="linenos"> 838</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-839"><a href="#EmulatorLauncher-839"><span class="linenos"> 839</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-840"><a href="#EmulatorLauncher-840"><span class="linenos"> 840</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</span><span id="EmulatorLauncher-841"><a href="#EmulatorLauncher-841"><span class="linenos"> 841</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-842"><a href="#EmulatorLauncher-842"><span class="linenos"> 842</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-843"><a href="#EmulatorLauncher-843"><span class="linenos"> 843</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">num_systems</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-844"><a href="#EmulatorLauncher-844"><span class="linenos"> 844</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher-845"><a href="#EmulatorLauncher-845"><span class="linenos"> 845</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-846"><a href="#EmulatorLauncher-846"><span class="linenos"> 846</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-847"><a href="#EmulatorLauncher-847"><span class="linenos"> 847</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-848"><a href="#EmulatorLauncher-848"><span class="linenos"> 848</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-849"><a href="#EmulatorLauncher-849"><span class="linenos"> 849</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher-850"><a href="#EmulatorLauncher-850"><span class="linenos"> 850</span></a>                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">&lt;</span> <span class="n">num_systems</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-851"><a href="#EmulatorLauncher-851"><span class="linenos"> 851</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher-852"><a href="#EmulatorLauncher-852"><span class="linenos"> 852</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-853"><a href="#EmulatorLauncher-853"><span class="linenos"> 853</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-854"><a href="#EmulatorLauncher-854"><span class="linenos"> 854</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-855"><a href="#EmulatorLauncher-855"><span class="linenos"> 855</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-856"><a href="#EmulatorLauncher-856"><span class="linenos"> 856</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher-857"><a href="#EmulatorLauncher-857"><span class="linenos"> 857</span></a>                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">==</span> <span class="n">num_systems</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher-858"><a href="#EmulatorLauncher-858"><span class="linenos"> 858</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher-859"><a href="#EmulatorLauncher-859"><span class="linenos"> 859</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;favorites&quot;</span>
</span><span id="EmulatorLauncher-860"><a href="#EmulatorLauncher-860"><span class="linenos"> 860</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-861"><a href="#EmulatorLauncher-861"><span class="linenos"> 861</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-862"><a href="#EmulatorLauncher-862"><span class="linenos"> 862</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">:</span>
</span><span id="EmulatorLauncher-863"><a href="#EmulatorLauncher-863"><span class="linenos"> 863</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher-864"><a href="#EmulatorLauncher-864"><span class="linenos"> 864</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">:</span>
</span><span id="EmulatorLauncher-865"><a href="#EmulatorLauncher-865"><span class="linenos"> 865</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="s2">&quot;roms&quot;</span>
</span><span id="EmulatorLauncher-866"><a href="#EmulatorLauncher-866"><span class="linenos"> 866</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
</span><span id="EmulatorLauncher-867"><a href="#EmulatorLauncher-867"><span class="linenos"> 867</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;filter&quot;</span>
</span><span id="EmulatorLauncher-868"><a href="#EmulatorLauncher-868"><span class="linenos"> 868</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="EmulatorLauncher-869"><a href="#EmulatorLauncher-869"><span class="linenos"> 869</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-870"><a href="#EmulatorLauncher-870"><span class="linenos"> 870</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-871"><a href="#EmulatorLauncher-871"><span class="linenos"> 871</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># Enter key in navigate mode</span>
</span><span id="EmulatorLauncher-872"><a href="#EmulatorLauncher-872"><span class="linenos"> 872</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">launch_selected_rom</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">rom_list</span><span class="p">)</span>
</span><span id="EmulatorLauncher-873"><a href="#EmulatorLauncher-873"><span class="linenos"> 873</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_F2</span><span class="p">:</span>
</span><span id="EmulatorLauncher-874"><a href="#EmulatorLauncher-874"><span class="linenos"> 874</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-875"><a href="#EmulatorLauncher-875"><span class="linenos"> 875</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite</span><span class="p">()</span>
</span><span id="EmulatorLauncher-876"><a href="#EmulatorLauncher-876"><span class="linenos"> 876</span></a>
</span><span id="EmulatorLauncher-877"><a href="#EmulatorLauncher-877"><span class="linenos"> 877</span></a>            <span class="c1"># Update timestamp if any selection state changed</span>
</span><span id="EmulatorLauncher-878"><a href="#EmulatorLauncher-878"><span class="linenos"> 878</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-879"><a href="#EmulatorLauncher-879"><span class="linenos"> 879</span></a>            <span class="n">prev_selected_rom</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span>
</span><span id="EmulatorLauncher-880"><a href="#EmulatorLauncher-880"><span class="linenos"> 880</span></a>            <span class="ow">or</span> <span class="n">prev_view_mode</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span>
</span><span id="EmulatorLauncher-881"><a href="#EmulatorLauncher-881"><span class="linenos"> 881</span></a>            <span class="ow">or</span> <span class="n">prev_selected_system</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span>
</span><span id="EmulatorLauncher-882"><a href="#EmulatorLauncher-882"><span class="linenos"> 882</span></a>        <span class="p">):</span>
</span><span id="EmulatorLauncher-883"><a href="#EmulatorLauncher-883"><span class="linenos"> 883</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_selection_change_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="EmulatorLauncher-884"><a href="#EmulatorLauncher-884"><span class="linenos"> 884</span></a>
</span><span id="EmulatorLauncher-885"><a href="#EmulatorLauncher-885"><span class="linenos"> 885</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher-886"><a href="#EmulatorLauncher-886"><span class="linenos"> 886</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_system_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher-887"><a href="#EmulatorLauncher-887"><span class="linenos"> 887</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="EmulatorLauncher-888"><a href="#EmulatorLauncher-888"><span class="linenos"> 888</span></a>
</span><span id="EmulatorLauncher-889"><a href="#EmulatorLauncher-889"><span class="linenos"> 889</span></a>    <span class="k">def</span> <span class="nf">launch_selected_rom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">systems</span><span class="p">,</span> <span class="n">rom_list</span><span class="p">):</span>
</span><span id="EmulatorLauncher-890"><a href="#EmulatorLauncher-890"><span class="linenos"> 890</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-891"><a href="#EmulatorLauncher-891"><span class="linenos"> 891</span></a><span class="sd">        Launches the selected ROM using the appropriate emulator configuration.</span>
</span><span id="EmulatorLauncher-892"><a href="#EmulatorLauncher-892"><span class="linenos"> 892</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher-893"><a href="#EmulatorLauncher-893"><span class="linenos"> 893</span></a><span class="sd">            systems (list): A list of available systems.</span>
</span><span id="EmulatorLauncher-894"><a href="#EmulatorLauncher-894"><span class="linenos"> 894</span></a><span class="sd">            rom_list (list): A list of ROMs available for the selected system.</span>
</span><span id="EmulatorLauncher-895"><a href="#EmulatorLauncher-895"><span class="linenos"> 895</span></a><span class="sd">        Preconditions:</span>
</span><span id="EmulatorLauncher-896"><a href="#EmulatorLauncher-896"><span class="linenos"> 896</span></a><span class="sd">            - `self.focus` must be &quot;roms&quot;.</span>
</span><span id="EmulatorLauncher-897"><a href="#EmulatorLauncher-897"><span class="linenos"> 897</span></a><span class="sd">            - `self.emulator_process` must be None.</span>
</span><span id="EmulatorLauncher-898"><a href="#EmulatorLauncher-898"><span class="linenos"> 898</span></a><span class="sd">            - `rom_list` must not be empty.</span>
</span><span id="EmulatorLauncher-899"><a href="#EmulatorLauncher-899"><span class="linenos"> 899</span></a><span class="sd">        Behavior:</span>
</span><span id="EmulatorLauncher-900"><a href="#EmulatorLauncher-900"><span class="linenos"> 900</span></a><span class="sd">            - If `self.view_mode` is &quot;systems&quot;:</span>
</span><span id="EmulatorLauncher-901"><a href="#EmulatorLauncher-901"><span class="linenos"> 901</span></a><span class="sd">                - Retrieves the system configuration for the selected system.</span>
</span><span id="EmulatorLauncher-902"><a href="#EmulatorLauncher-902"><span class="linenos"> 902</span></a><span class="sd">                - Launches the ROM using the emulator path and launch arguments from the system configuration.</span>
</span><span id="EmulatorLauncher-903"><a href="#EmulatorLauncher-903"><span class="linenos"> 903</span></a><span class="sd">            - If `self.view_mode` is &quot;favorites&quot; or &quot;all&quot;:</span>
</span><span id="EmulatorLauncher-904"><a href="#EmulatorLauncher-904"><span class="linenos"> 904</span></a><span class="sd">                - Retrieves the system and ROM path for the selected ROM.</span>
</span><span id="EmulatorLauncher-905"><a href="#EmulatorLauncher-905"><span class="linenos"> 905</span></a><span class="sd">                - Launches the ROM using the emulator path and launch arguments from the system configuration.</span>
</span><span id="EmulatorLauncher-906"><a href="#EmulatorLauncher-906"><span class="linenos"> 906</span></a><span class="sd">        Postconditions:</span>
</span><span id="EmulatorLauncher-907"><a href="#EmulatorLauncher-907"><span class="linenos"> 907</span></a><span class="sd">            - Clears the filter string.</span>
</span><span id="EmulatorLauncher-908"><a href="#EmulatorLauncher-908"><span class="linenos"> 908</span></a><span class="sd">            - Updates the filtered ROMs list.</span>
</span><span id="EmulatorLauncher-909"><a href="#EmulatorLauncher-909"><span class="linenos"> 909</span></a><span class="sd">            - Resets the selected ROM index to 0.</span>
</span><span id="EmulatorLauncher-910"><a href="#EmulatorLauncher-910"><span class="linenos"> 910</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-911"><a href="#EmulatorLauncher-911"><span class="linenos"> 911</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="EmulatorLauncher-912"><a href="#EmulatorLauncher-912"><span class="linenos"> 912</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-913"><a href="#EmulatorLauncher-913"><span class="linenos"> 913</span></a>                <span class="n">system_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;systems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="EmulatorLauncher-914"><a href="#EmulatorLauncher-914"><span class="linenos"> 914</span></a>                    <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="EmulatorLauncher-915"><a href="#EmulatorLauncher-915"><span class="linenos"> 915</span></a>                <span class="p">)</span>
</span><span id="EmulatorLauncher-916"><a href="#EmulatorLauncher-916"><span class="linenos"> 916</span></a>                <span class="k">if</span> <span class="n">system_config</span> <span class="ow">and</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="EmulatorLauncher-917"><a href="#EmulatorLauncher-917"><span class="linenos"> 917</span></a>                    <span class="n">start_in_directory</span> <span class="o">=</span> <span class="n">system_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_in&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher-918"><a href="#EmulatorLauncher-918"><span class="linenos"> 918</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">launch_rom</span><span class="p">(</span>
</span><span id="EmulatorLauncher-919"><a href="#EmulatorLauncher-919"><span class="linenos"> 919</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;emulator_path&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher-920"><a href="#EmulatorLauncher-920"><span class="linenos"> 920</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;launch_arguments&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher-921"><a href="#EmulatorLauncher-921"><span class="linenos"> 921</span></a>                        <span class="n">rom_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">],</span>
</span><span id="EmulatorLauncher-922"><a href="#EmulatorLauncher-922"><span class="linenos"> 922</span></a>                        <span class="n">start_in_directory</span><span class="p">,</span>
</span><span id="EmulatorLauncher-923"><a href="#EmulatorLauncher-923"><span class="linenos"> 923</span></a>                    <span class="p">)</span>
</span><span id="EmulatorLauncher-924"><a href="#EmulatorLauncher-924"><span class="linenos"> 924</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="EmulatorLauncher-925"><a href="#EmulatorLauncher-925"><span class="linenos"> 925</span></a>                <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">]</span>
</span><span id="EmulatorLauncher-926"><a href="#EmulatorLauncher-926"><span class="linenos"> 926</span></a>                <span class="n">system_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;systems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span><span id="EmulatorLauncher-927"><a href="#EmulatorLauncher-927"><span class="linenos"> 927</span></a>                <span class="k">if</span> <span class="n">system_config</span><span class="p">:</span>
</span><span id="EmulatorLauncher-928"><a href="#EmulatorLauncher-928"><span class="linenos"> 928</span></a>                    <span class="n">start_in_directory</span> <span class="o">=</span> <span class="n">system_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_in&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher-929"><a href="#EmulatorLauncher-929"><span class="linenos"> 929</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">launch_rom</span><span class="p">(</span>
</span><span id="EmulatorLauncher-930"><a href="#EmulatorLauncher-930"><span class="linenos"> 930</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;emulator_path&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher-931"><a href="#EmulatorLauncher-931"><span class="linenos"> 931</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;launch_arguments&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher-932"><a href="#EmulatorLauncher-932"><span class="linenos"> 932</span></a>                        <span class="n">rom_path</span><span class="p">,</span>
</span><span id="EmulatorLauncher-933"><a href="#EmulatorLauncher-933"><span class="linenos"> 933</span></a>                        <span class="n">start_in_directory</span><span class="p">,</span>
</span><span id="EmulatorLauncher-934"><a href="#EmulatorLauncher-934"><span class="linenos"> 934</span></a>                    <span class="p">)</span>
</span><span id="EmulatorLauncher-935"><a href="#EmulatorLauncher-935"><span class="linenos"> 935</span></a>
</span><span id="EmulatorLauncher-936"><a href="#EmulatorLauncher-936"><span class="linenos"> 936</span></a>            <span class="c1"># Clear filter and update display after launching</span>
</span><span id="EmulatorLauncher-937"><a href="#EmulatorLauncher-937"><span class="linenos"> 937</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="EmulatorLauncher-938"><a href="#EmulatorLauncher-938"><span class="linenos"> 938</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="EmulatorLauncher-939"><a href="#EmulatorLauncher-939"><span class="linenos"> 939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-940"><a href="#EmulatorLauncher-940"><span class="linenos"> 940</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-941"><a href="#EmulatorLauncher-941"><span class="linenos"> 941</span></a>
</span><span id="EmulatorLauncher-942"><a href="#EmulatorLauncher-942"><span class="linenos"> 942</span></a>    <span class="k">def</span> <span class="nf">draw_filter_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher-943"><a href="#EmulatorLauncher-943"><span class="linenos"> 943</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-944"><a href="#EmulatorLauncher-944"><span class="linenos"> 944</span></a><span class="sd">        Draws the filter bar at the bottom of the terminal window.</span>
</span><span id="EmulatorLauncher-945"><a href="#EmulatorLauncher-945"><span class="linenos"> 945</span></a><span class="sd">        This method clears the current status bar, sets the appropriate style,</span>
</span><span id="EmulatorLauncher-946"><a href="#EmulatorLauncher-946"><span class="linenos"> 946</span></a><span class="sd">        and displays the current status based on the mode (filter or ready).</span>
</span><span id="EmulatorLauncher-947"><a href="#EmulatorLauncher-947"><span class="linenos"> 947</span></a><span class="sd">        It also ensures that the status bar text fits within the window width.</span>
</span><span id="EmulatorLauncher-948"><a href="#EmulatorLauncher-948"><span class="linenos"> 948</span></a><span class="sd">        The status bar displays different information based on the mode:</span>
</span><span id="EmulatorLauncher-949"><a href="#EmulatorLauncher-949"><span class="linenos"> 949</span></a><span class="sd">        - In &quot;filter&quot; mode, it shows the filter string and the current ROM count.</span>
</span><span id="EmulatorLauncher-950"><a href="#EmulatorLauncher-950"><span class="linenos"> 950</span></a><span class="sd">        - In &quot;ready&quot; mode, it shows a ready message and the current ROM count.</span>
</span><span id="EmulatorLauncher-951"><a href="#EmulatorLauncher-951"><span class="linenos"> 951</span></a><span class="sd">        The status bar also includes help text with key bindings for various actions.</span>
</span><span id="EmulatorLauncher-952"><a href="#EmulatorLauncher-952"><span class="linenos"> 952</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher-953"><a href="#EmulatorLauncher-953"><span class="linenos"> 953</span></a><span class="sd">            height (int): The height of the terminal window.</span>
</span><span id="EmulatorLauncher-954"><a href="#EmulatorLauncher-954"><span class="linenos"> 954</span></a><span class="sd">            width (int): The width of the terminal window.</span>
</span><span id="EmulatorLauncher-955"><a href="#EmulatorLauncher-955"><span class="linenos"> 955</span></a><span class="sd">            current_rom (int): The index of the current ROM.</span>
</span><span id="EmulatorLauncher-956"><a href="#EmulatorLauncher-956"><span class="linenos"> 956</span></a><span class="sd">            counter (str): The string representing the current ROM count.</span>
</span><span id="EmulatorLauncher-957"><a href="#EmulatorLauncher-957"><span class="linenos"> 957</span></a><span class="sd">            status (str): The status message to be displayed.</span>
</span><span id="EmulatorLauncher-958"><a href="#EmulatorLauncher-958"><span class="linenos"> 958</span></a><span class="sd">            help_text (str): The help text with key bindings.</span>
</span><span id="EmulatorLauncher-959"><a href="#EmulatorLauncher-959"><span class="linenos"> 959</span></a><span class="sd">            total_length (int): The total length of the status and help text.</span>
</span><span id="EmulatorLauncher-960"><a href="#EmulatorLauncher-960"><span class="linenos"> 960</span></a><span class="sd">            padding (int): The padding to ensure the text fits within the window width.</span>
</span><span id="EmulatorLauncher-961"><a href="#EmulatorLauncher-961"><span class="linenos"> 961</span></a><span class="sd">            final_text (str): The final text to be displayed on the status bar.</span>
</span><span id="EmulatorLauncher-962"><a href="#EmulatorLauncher-962"><span class="linenos"> 962</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-963"><a href="#EmulatorLauncher-963"><span class="linenos"> 963</span></a>        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()</span>
</span><span id="EmulatorLauncher-964"><a href="#EmulatorLauncher-964"><span class="linenos"> 964</span></a>
</span><span id="EmulatorLauncher-965"><a href="#EmulatorLauncher-965"><span class="linenos"> 965</span></a>        <span class="c1"># Clear the status bar</span>
</span><span id="EmulatorLauncher-966"><a href="#EmulatorLauncher-966"><span class="linenos"> 966</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher-967"><a href="#EmulatorLauncher-967"><span class="linenos"> 967</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">clrtoeol</span><span class="p">()</span>
</span><span id="EmulatorLauncher-968"><a href="#EmulatorLauncher-968"><span class="linenos"> 968</span></a>
</span><span id="EmulatorLauncher-969"><a href="#EmulatorLauncher-969"><span class="linenos"> 969</span></a>        <span class="c1"># Set status bar style</span>
</span><span id="EmulatorLauncher-970"><a href="#EmulatorLauncher-970"><span class="linenos"> 970</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">attron</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">STATUS_BAR</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="EmulatorLauncher-971"><a href="#EmulatorLauncher-971"><span class="linenos"> 971</span></a>
</span><span id="EmulatorLauncher-972"><a href="#EmulatorLauncher-972"><span class="linenos"> 972</span></a>        <span class="n">current_rom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_rom_index</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-973"><a href="#EmulatorLauncher-973"><span class="linenos"> 973</span></a>        <span class="n">counter</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">current_rom</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher-974"><a href="#EmulatorLauncher-974"><span class="linenos"> 974</span></a>
</span><span id="EmulatorLauncher-975"><a href="#EmulatorLauncher-975"><span class="linenos"> 975</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;filter&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher-976"><a href="#EmulatorLauncher-976"><span class="linenos"> 976</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; / </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="si">}{</span><span class="n">counter</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher-977"><a href="#EmulatorLauncher-977"><span class="linenos"> 977</span></a>            <span class="n">help_text</span> <span class="o">=</span> <span class="s2">&quot;ESC:Exit  ENTER/A:Launch  F2/X:Favorite  Q/B:Quit&quot;</span>
</span><span id="EmulatorLauncher-978"><a href="#EmulatorLauncher-978"><span class="linenos"> 978</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-979"><a href="#EmulatorLauncher-979"><span class="linenos"> 979</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; Ready</span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher-980"><a href="#EmulatorLauncher-980"><span class="linenos"> 980</span></a>            <span class="n">help_text</span> <span class="o">=</span> <span class="s2">&quot;/:Search  ENTER/A:Launch  F2/X:Favorite  Q/B:Quit&quot;</span>
</span><span id="EmulatorLauncher-981"><a href="#EmulatorLauncher-981"><span class="linenos"> 981</span></a>
</span><span id="EmulatorLauncher-982"><a href="#EmulatorLauncher-982"><span class="linenos"> 982</span></a>        <span class="c1"># Calculate padding, ensuring we don&#39;t exceed the window width</span>
</span><span id="EmulatorLauncher-983"><a href="#EmulatorLauncher-983"><span class="linenos"> 983</span></a>        <span class="n">total_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">help_text</span><span class="p">)</span>
</span><span id="EmulatorLauncher-984"><a href="#EmulatorLauncher-984"><span class="linenos"> 984</span></a>        <span class="n">padding</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span> <span class="o">-</span> <span class="n">total_length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Leave one character at the end</span>
</span><span id="EmulatorLauncher-985"><a href="#EmulatorLauncher-985"><span class="linenos"> 985</span></a>
</span><span id="EmulatorLauncher-986"><a href="#EmulatorLauncher-986"><span class="linenos"> 986</span></a>        <span class="c1"># Ensure we don&#39;t write beyond the last column</span>
</span><span id="EmulatorLauncher-987"><a href="#EmulatorLauncher-987"><span class="linenos"> 987</span></a>        <span class="n">final_text</span> <span class="o">=</span> <span class="p">(</span><span class="n">status</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">help_text</span><span class="p">)[:</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="EmulatorLauncher-988"><a href="#EmulatorLauncher-988"><span class="linenos"> 988</span></a>
</span><span id="EmulatorLauncher-989"><a href="#EmulatorLauncher-989"><span class="linenos"> 989</span></a>        <span class="c1"># Draw status bar</span>
</span><span id="EmulatorLauncher-990"><a href="#EmulatorLauncher-990"><span class="linenos"> 990</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">final_text</span><span class="p">)</span>
</span><span id="EmulatorLauncher-991"><a href="#EmulatorLauncher-991"><span class="linenos"> 991</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">attroff</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">STATUS_BAR</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="EmulatorLauncher-992"><a href="#EmulatorLauncher-992"><span class="linenos"> 992</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span><span id="EmulatorLauncher-993"><a href="#EmulatorLauncher-993"><span class="linenos"> 993</span></a>
</span><span id="EmulatorLauncher-994"><a href="#EmulatorLauncher-994"><span class="linenos"> 994</span></a>    <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stdscr</span><span class="p">):</span>
</span><span id="EmulatorLauncher-995"><a href="#EmulatorLauncher-995"><span class="linenos"> 995</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-996"><a href="#EmulatorLauncher-996"><span class="linenos"> 996</span></a><span class="sd">        Main function to initialize and run the ROM launcher interface.</span>
</span><span id="EmulatorLauncher-997"><a href="#EmulatorLauncher-997"><span class="linenos"> 997</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher-998"><a href="#EmulatorLauncher-998"><span class="linenos"> 998</span></a><span class="sd">            stdscr: The standard screen object provided by curses.</span>
</span><span id="EmulatorLauncher-999"><a href="#EmulatorLauncher-999"><span class="linenos"> 999</span></a><span class="sd">        This function sets up the curses environment, initializes pygame for gamepad support,</span>
</span><span id="EmulatorLauncher-1000"><a href="#EmulatorLauncher-1000"><span class="linenos">1000</span></a><span class="sd">        and enters the main loop to handle user input and update the display. It supports both</span>
</span><span id="EmulatorLauncher-1001"><a href="#EmulatorLauncher-1001"><span class="linenos">1001</span></a><span class="sd">        keyboard and gamepad inputs, with auto-repeat functionality for gamepad D-pad and joystick axes.</span>
</span><span id="EmulatorLauncher-1002"><a href="#EmulatorLauncher-1002"><span class="linenos">1002</span></a><span class="sd">        The interface is divided into two windows: one for system selection and one for ROM selection.</span>
</span><span id="EmulatorLauncher-1003"><a href="#EmulatorLauncher-1003"><span class="linenos">1003</span></a><span class="sd">        The function also handles window resizing and checks for the completion of the emulator process.</span>
</span><span id="EmulatorLauncher-1004"><a href="#EmulatorLauncher-1004"><span class="linenos">1004</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher-1005"><a href="#EmulatorLauncher-1005"><span class="linenos">1005</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span> <span class="o">=</span> <span class="n">stdscr</span>
</span><span id="EmulatorLauncher-1006"><a href="#EmulatorLauncher-1006"><span class="linenos">1006</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">keypad</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1007"><a href="#EmulatorLauncher-1007"><span class="linenos">1007</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">curs_set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1008"><a href="#EmulatorLauncher-1008"><span class="linenos">1008</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">init_colors</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1009"><a href="#EmulatorLauncher-1009"><span class="linenos">1009</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1010"><a href="#EmulatorLauncher-1010"><span class="linenos">1010</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1011"><a href="#EmulatorLauncher-1011"><span class="linenos">1011</span></a>
</span><span id="EmulatorLauncher-1012"><a href="#EmulatorLauncher-1012"><span class="linenos">1012</span></a>        <span class="c1"># Initialize pygame for gamepad support.</span>
</span><span id="EmulatorLauncher-1013"><a href="#EmulatorLauncher-1013"><span class="linenos">1013</span></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1014"><a href="#EmulatorLauncher-1014"><span class="linenos">1014</span></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1015"><a href="#EmulatorLauncher-1015"><span class="linenos">1015</span></a>        <span class="k">if</span> <span class="n">pygame</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1016"><a href="#EmulatorLauncher-1016"><span class="linenos">1016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">Joystick</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1017"><a href="#EmulatorLauncher-1017"><span class="linenos">1017</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1018"><a href="#EmulatorLauncher-1018"><span class="linenos">1018</span></a>            <span class="c1"># print(&quot;Controller connected:&quot;, self.joystick.get_name())</span>
</span><span id="EmulatorLauncher-1019"><a href="#EmulatorLauncher-1019"><span class="linenos">1019</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1020"><a href="#EmulatorLauncher-1020"><span class="linenos">1020</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher-1021"><a href="#EmulatorLauncher-1021"><span class="linenos">1021</span></a>            <span class="c1"># print(&quot;No controller found.&quot;)</span>
</span><span id="EmulatorLauncher-1022"><a href="#EmulatorLauncher-1022"><span class="linenos">1022</span></a>
</span><span id="EmulatorLauncher-1023"><a href="#EmulatorLauncher-1023"><span class="linenos">1023</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">nodelay</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1024"><a href="#EmulatorLauncher-1024"><span class="linenos">1024</span></a>
</span><span id="EmulatorLauncher-1025"><a href="#EmulatorLauncher-1025"><span class="linenos">1025</span></a>        <span class="c1"># Calculate split for windows.</span>
</span><span id="EmulatorLauncher-1026"><a href="#EmulatorLauncher-1026"><span class="linenos">1026</span></a>        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1027"><a href="#EmulatorLauncher-1027"><span class="linenos">1027</span></a>        <span class="n">system_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">4</span>
</span><span id="EmulatorLauncher-1028"><a href="#EmulatorLauncher-1028"><span class="linenos">1028</span></a>        <span class="n">rom_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">system_width</span>
</span><span id="EmulatorLauncher-1029"><a href="#EmulatorLauncher-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">system_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1030"><a href="#EmulatorLauncher-1030"><span class="linenos">1030</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rom_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">system_width</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1031"><a href="#EmulatorLauncher-1031"><span class="linenos">1031</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="EmulatorLauncher-1032"><a href="#EmulatorLauncher-1032"><span class="linenos">1032</span></a>
</span><span id="EmulatorLauncher-1033"><a href="#EmulatorLauncher-1033"><span class="linenos">1033</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1034"><a href="#EmulatorLauncher-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_system_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1035"><a href="#EmulatorLauncher-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1036"><a href="#EmulatorLauncher-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1037"><a href="#EmulatorLauncher-1037"><span class="linenos">1037</span></a>
</span><span id="EmulatorLauncher-1038"><a href="#EmulatorLauncher-1038"><span class="linenos">1038</span></a>        <span class="c1"># Timing parameters (in seconds)</span>
</span><span id="EmulatorLauncher-1039"><a href="#EmulatorLauncher-1039"><span class="linenos">1039</span></a>        <span class="n">initial_delay</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Delay before auto-repeat kicks in</span>
</span><span id="EmulatorLauncher-1040"><a href="#EmulatorLauncher-1040"><span class="linenos">1040</span></a>        <span class="n">repeat_interval</span> <span class="o">=</span> <span class="mf">0.04</span>  <span class="c1"># Interval between repeats after initial delay</span>
</span><span id="EmulatorLauncher-1041"><a href="#EmulatorLauncher-1041"><span class="linenos">1041</span></a>
</span><span id="EmulatorLauncher-1042"><a href="#EmulatorLauncher-1042"><span class="linenos">1042</span></a>        <span class="c1"># Timing parameters for scroll updates</span>
</span><span id="EmulatorLauncher-1043"><a href="#EmulatorLauncher-1043"><span class="linenos">1043</span></a>        <span class="n">last_scroll_time</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1044"><a href="#EmulatorLauncher-1044"><span class="linenos">1044</span></a>        <span class="n">scroll_interval</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># 100 milliseconds</span>
</span><span id="EmulatorLauncher-1045"><a href="#EmulatorLauncher-1045"><span class="linenos">1045</span></a>
</span><span id="EmulatorLauncher-1046"><a href="#EmulatorLauncher-1046"><span class="linenos">1046</span></a>        <span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="EmulatorLauncher-1047"><a href="#EmulatorLauncher-1047"><span class="linenos">1047</span></a>
</span><span id="EmulatorLauncher-1048"><a href="#EmulatorLauncher-1048"><span class="linenos">1048</span></a>        <span class="k">while</span> <span class="n">running</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1049"><a href="#EmulatorLauncher-1049"><span class="linenos">1049</span></a>            <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1050"><a href="#EmulatorLauncher-1050"><span class="linenos">1050</span></a>
</span><span id="EmulatorLauncher-1051"><a href="#EmulatorLauncher-1051"><span class="linenos">1051</span></a>            <span class="k">if</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">last_scroll_time</span> <span class="o">&gt;=</span> <span class="n">scroll_interval</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1052"><a href="#EmulatorLauncher-1052"><span class="linenos">1052</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1053"><a href="#EmulatorLauncher-1053"><span class="linenos">1053</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1054"><a href="#EmulatorLauncher-1054"><span class="linenos">1054</span></a>                <span class="n">last_scroll_time</span> <span class="o">=</span> <span class="n">current_time</span>
</span><span id="EmulatorLauncher-1055"><a href="#EmulatorLauncher-1055"><span class="linenos">1055</span></a>
</span><span id="EmulatorLauncher-1056"><a href="#EmulatorLauncher-1056"><span class="linenos">1056</span></a>            <span class="c1"># Process keyboard input.</span>
</span><span id="EmulatorLauncher-1057"><a href="#EmulatorLauncher-1057"><span class="linenos">1057</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getch</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1058"><a href="#EmulatorLauncher-1058"><span class="linenos">1058</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1059"><a href="#EmulatorLauncher-1059"><span class="linenos">1059</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_RESIZE</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1060"><a href="#EmulatorLauncher-1060"><span class="linenos">1060</span></a>                    <span class="c1"># Handle window resize</span>
</span><span id="EmulatorLauncher-1061"><a href="#EmulatorLauncher-1061"><span class="linenos">1061</span></a>                    <span class="n">curses</span><span class="o">.</span><span class="n">resize_term</span><span class="p">(</span><span class="o">*</span><span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">())</span>
</span><span id="EmulatorLauncher-1062"><a href="#EmulatorLauncher-1062"><span class="linenos">1062</span></a>                    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1063"><a href="#EmulatorLauncher-1063"><span class="linenos">1063</span></a>                    <span class="n">system_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">4</span>
</span><span id="EmulatorLauncher-1064"><a href="#EmulatorLauncher-1064"><span class="linenos">1064</span></a>                    <span class="n">rom_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">system_width</span>
</span><span id="EmulatorLauncher-1065"><a href="#EmulatorLauncher-1065"><span class="linenos">1065</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">system_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1066"><a href="#EmulatorLauncher-1066"><span class="linenos">1066</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span>
</span><span id="EmulatorLauncher-1067"><a href="#EmulatorLauncher-1067"><span class="linenos">1067</span></a>                        <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rom_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">system_width</span>
</span><span id="EmulatorLauncher-1068"><a href="#EmulatorLauncher-1068"><span class="linenos">1068</span></a>                    <span class="p">)</span>
</span><span id="EmulatorLauncher-1069"><a href="#EmulatorLauncher-1069"><span class="linenos">1069</span></a>                    <span class="n">stdscr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1070"><a href="#EmulatorLauncher-1070"><span class="linenos">1070</span></a>                    <span class="n">curses</span><span class="o">.</span><span class="n">curs_set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Re-hide cursor after resize</span>
</span><span id="EmulatorLauncher-1071"><a href="#EmulatorLauncher-1071"><span class="linenos">1071</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">init_colors</span><span class="p">()</span>  <span class="c1"># Re-initialize colors if necessary</span>
</span><span id="EmulatorLauncher-1072"><a href="#EmulatorLauncher-1072"><span class="linenos">1072</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1073"><a href="#EmulatorLauncher-1073"><span class="linenos">1073</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_system_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1074"><a href="#EmulatorLauncher-1074"><span class="linenos">1074</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1075"><a href="#EmulatorLauncher-1075"><span class="linenos">1075</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1076"><a href="#EmulatorLauncher-1076"><span class="linenos">1076</span></a>                <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-1077"><a href="#EmulatorLauncher-1077"><span class="linenos">1077</span></a>                    <span class="n">key</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1078"><a href="#EmulatorLauncher-1078"><span class="linenos">1078</span></a>                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher-1079"><a href="#EmulatorLauncher-1079"><span class="linenos">1079</span></a>                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="EmulatorLauncher-1080"><a href="#EmulatorLauncher-1080"><span class="linenos">1080</span></a>                <span class="p">):</span>
</span><span id="EmulatorLauncher-1081"><a href="#EmulatorLauncher-1081"><span class="linenos">1081</span></a>                    <span class="k">break</span>
</span><span id="EmulatorLauncher-1082"><a href="#EmulatorLauncher-1082"><span class="linenos">1082</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1083"><a href="#EmulatorLauncher-1083"><span class="linenos">1083</span></a>
</span><span id="EmulatorLauncher-1084"><a href="#EmulatorLauncher-1084"><span class="linenos">1084</span></a>            <span class="c1"># Process pygame events for button presses.</span>
</span><span id="EmulatorLauncher-1085"><a href="#EmulatorLauncher-1085"><span class="linenos">1085</span></a>            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="EmulatorLauncher-1086"><a href="#EmulatorLauncher-1086"><span class="linenos">1086</span></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">JOYBUTTONDOWN</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1087"><a href="#EmulatorLauncher-1087"><span class="linenos">1087</span></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Typically A button.</span>
</span><span id="EmulatorLauncher-1088"><a href="#EmulatorLauncher-1088"><span class="linenos">1088</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Enter key.</span>
</span><span id="EmulatorLauncher-1089"><a href="#EmulatorLauncher-1089"><span class="linenos">1089</span></a>                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Typically B button.</span>
</span><span id="EmulatorLauncher-1090"><a href="#EmulatorLauncher-1090"><span class="linenos">1090</span></a>                        <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EmulatorLauncher-1091"><a href="#EmulatorLauncher-1091"><span class="linenos">1091</span></a>                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Example: X button.</span>
</span><span id="EmulatorLauncher-1092"><a href="#EmulatorLauncher-1092"><span class="linenos">1092</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_F2</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1093"><a href="#EmulatorLauncher-1093"><span class="linenos">1093</span></a>                <span class="c1"># We poll the hat state below for auto-repeat.</span>
</span><span id="EmulatorLauncher-1094"><a href="#EmulatorLauncher-1094"><span class="linenos">1094</span></a>
</span><span id="EmulatorLauncher-1095"><a href="#EmulatorLauncher-1095"><span class="linenos">1095</span></a>            <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="EmulatorLauncher-1096"><a href="#EmulatorLauncher-1096"><span class="linenos">1096</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1097"><a href="#EmulatorLauncher-1097"><span class="linenos">1097</span></a>                <span class="c1"># ----- Process D-pad (hat) with initial delay auto-repeat -----</span>
</span><span id="EmulatorLauncher-1098"><a href="#EmulatorLauncher-1098"><span class="linenos">1098</span></a>                <span class="n">hat_x</span><span class="p">,</span> <span class="n">hat_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_hat</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1099"><a href="#EmulatorLauncher-1099"><span class="linenos">1099</span></a>                <span class="c1"># For UP</span>
</span><span id="EmulatorLauncher-1100"><a href="#EmulatorLauncher-1100"><span class="linenos">1100</span></a>                <span class="k">if</span> <span class="n">hat_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1101"><a href="#EmulatorLauncher-1101"><span class="linenos">1101</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1102"><a href="#EmulatorLauncher-1102"><span class="linenos">1102</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1103"><a href="#EmulatorLauncher-1103"><span class="linenos">1103</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1104"><a href="#EmulatorLauncher-1104"><span class="linenos">1104</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1105"><a href="#EmulatorLauncher-1105"><span class="linenos">1105</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-1106"><a href="#EmulatorLauncher-1106"><span class="linenos">1106</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher-1107"><a href="#EmulatorLauncher-1107"><span class="linenos">1107</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher-1108"><a href="#EmulatorLauncher-1108"><span class="linenos">1108</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher-1109"><a href="#EmulatorLauncher-1109"><span class="linenos">1109</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1110"><a href="#EmulatorLauncher-1110"><span class="linenos">1110</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1111"><a href="#EmulatorLauncher-1111"><span class="linenos">1111</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1112"><a href="#EmulatorLauncher-1112"><span class="linenos">1112</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1113"><a href="#EmulatorLauncher-1113"><span class="linenos">1113</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1114"><a href="#EmulatorLauncher-1114"><span class="linenos">1114</span></a>
</span><span id="EmulatorLauncher-1115"><a href="#EmulatorLauncher-1115"><span class="linenos">1115</span></a>                <span class="c1"># For DOWN</span>
</span><span id="EmulatorLauncher-1116"><a href="#EmulatorLauncher-1116"><span class="linenos">1116</span></a>                <span class="k">if</span> <span class="n">hat_y</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1117"><a href="#EmulatorLauncher-1117"><span class="linenos">1117</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1118"><a href="#EmulatorLauncher-1118"><span class="linenos">1118</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1119"><a href="#EmulatorLauncher-1119"><span class="linenos">1119</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1120"><a href="#EmulatorLauncher-1120"><span class="linenos">1120</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1121"><a href="#EmulatorLauncher-1121"><span class="linenos">1121</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-1122"><a href="#EmulatorLauncher-1122"><span class="linenos">1122</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher-1123"><a href="#EmulatorLauncher-1123"><span class="linenos">1123</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher-1124"><a href="#EmulatorLauncher-1124"><span class="linenos">1124</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher-1125"><a href="#EmulatorLauncher-1125"><span class="linenos">1125</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1126"><a href="#EmulatorLauncher-1126"><span class="linenos">1126</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1127"><a href="#EmulatorLauncher-1127"><span class="linenos">1127</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1128"><a href="#EmulatorLauncher-1128"><span class="linenos">1128</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1129"><a href="#EmulatorLauncher-1129"><span class="linenos">1129</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1130"><a href="#EmulatorLauncher-1130"><span class="linenos">1130</span></a>
</span><span id="EmulatorLauncher-1131"><a href="#EmulatorLauncher-1131"><span class="linenos">1131</span></a>                <span class="c1"># For RIGHT</span>
</span><span id="EmulatorLauncher-1132"><a href="#EmulatorLauncher-1132"><span class="linenos">1132</span></a>                <span class="k">if</span> <span class="n">hat_x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1133"><a href="#EmulatorLauncher-1133"><span class="linenos">1133</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1134"><a href="#EmulatorLauncher-1134"><span class="linenos">1134</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1135"><a href="#EmulatorLauncher-1135"><span class="linenos">1135</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1136"><a href="#EmulatorLauncher-1136"><span class="linenos">1136</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1137"><a href="#EmulatorLauncher-1137"><span class="linenos">1137</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-1138"><a href="#EmulatorLauncher-1138"><span class="linenos">1138</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher-1139"><a href="#EmulatorLauncher-1139"><span class="linenos">1139</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher-1140"><a href="#EmulatorLauncher-1140"><span class="linenos">1140</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher-1141"><a href="#EmulatorLauncher-1141"><span class="linenos">1141</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1142"><a href="#EmulatorLauncher-1142"><span class="linenos">1142</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1143"><a href="#EmulatorLauncher-1143"><span class="linenos">1143</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1144"><a href="#EmulatorLauncher-1144"><span class="linenos">1144</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1145"><a href="#EmulatorLauncher-1145"><span class="linenos">1145</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1146"><a href="#EmulatorLauncher-1146"><span class="linenos">1146</span></a>
</span><span id="EmulatorLauncher-1147"><a href="#EmulatorLauncher-1147"><span class="linenos">1147</span></a>                <span class="c1"># For LEFT</span>
</span><span id="EmulatorLauncher-1148"><a href="#EmulatorLauncher-1148"><span class="linenos">1148</span></a>                <span class="k">if</span> <span class="n">hat_x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1149"><a href="#EmulatorLauncher-1149"><span class="linenos">1149</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1150"><a href="#EmulatorLauncher-1150"><span class="linenos">1150</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1151"><a href="#EmulatorLauncher-1151"><span class="linenos">1151</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1152"><a href="#EmulatorLauncher-1152"><span class="linenos">1152</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1153"><a href="#EmulatorLauncher-1153"><span class="linenos">1153</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-1154"><a href="#EmulatorLauncher-1154"><span class="linenos">1154</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher-1155"><a href="#EmulatorLauncher-1155"><span class="linenos">1155</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher-1156"><a href="#EmulatorLauncher-1156"><span class="linenos">1156</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher-1157"><a href="#EmulatorLauncher-1157"><span class="linenos">1157</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1158"><a href="#EmulatorLauncher-1158"><span class="linenos">1158</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1159"><a href="#EmulatorLauncher-1159"><span class="linenos">1159</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1160"><a href="#EmulatorLauncher-1160"><span class="linenos">1160</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1161"><a href="#EmulatorLauncher-1161"><span class="linenos">1161</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1162"><a href="#EmulatorLauncher-1162"><span class="linenos">1162</span></a>
</span><span id="EmulatorLauncher-1163"><a href="#EmulatorLauncher-1163"><span class="linenos">1163</span></a>                <span class="c1"># ----- Process Joystick Axes if D-pad is neutral -----</span>
</span><span id="EmulatorLauncher-1164"><a href="#EmulatorLauncher-1164"><span class="linenos">1164</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">hat_x</span><span class="p">,</span> <span class="n">hat_y</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="EmulatorLauncher-1165"><a href="#EmulatorLauncher-1165"><span class="linenos">1165</span></a>                    <span class="n">axis_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1166"><a href="#EmulatorLauncher-1166"><span class="linenos">1166</span></a>                    <span class="n">axis_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1167"><a href="#EmulatorLauncher-1167"><span class="linenos">1167</span></a>
</span><span id="EmulatorLauncher-1168"><a href="#EmulatorLauncher-1168"><span class="linenos">1168</span></a>                    <span class="c1"># For UP</span>
</span><span id="EmulatorLauncher-1169"><a href="#EmulatorLauncher-1169"><span class="linenos">1169</span></a>                    <span class="k">if</span> <span class="n">axis_y</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1170"><a href="#EmulatorLauncher-1170"><span class="linenos">1170</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1171"><a href="#EmulatorLauncher-1171"><span class="linenos">1171</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1172"><a href="#EmulatorLauncher-1172"><span class="linenos">1172</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1173"><a href="#EmulatorLauncher-1173"><span class="linenos">1173</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1174"><a href="#EmulatorLauncher-1174"><span class="linenos">1174</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-1175"><a href="#EmulatorLauncher-1175"><span class="linenos">1175</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher-1176"><a href="#EmulatorLauncher-1176"><span class="linenos">1176</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher-1177"><a href="#EmulatorLauncher-1177"><span class="linenos">1177</span></a>                        <span class="p">):</span>
</span><span id="EmulatorLauncher-1178"><a href="#EmulatorLauncher-1178"><span class="linenos">1178</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1179"><a href="#EmulatorLauncher-1179"><span class="linenos">1179</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1180"><a href="#EmulatorLauncher-1180"><span class="linenos">1180</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1181"><a href="#EmulatorLauncher-1181"><span class="linenos">1181</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1182"><a href="#EmulatorLauncher-1182"><span class="linenos">1182</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1183"><a href="#EmulatorLauncher-1183"><span class="linenos">1183</span></a>
</span><span id="EmulatorLauncher-1184"><a href="#EmulatorLauncher-1184"><span class="linenos">1184</span></a>                    <span class="c1"># For DOWN</span>
</span><span id="EmulatorLauncher-1185"><a href="#EmulatorLauncher-1185"><span class="linenos">1185</span></a>                    <span class="k">if</span> <span class="n">axis_y</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1186"><a href="#EmulatorLauncher-1186"><span class="linenos">1186</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1187"><a href="#EmulatorLauncher-1187"><span class="linenos">1187</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1188"><a href="#EmulatorLauncher-1188"><span class="linenos">1188</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1189"><a href="#EmulatorLauncher-1189"><span class="linenos">1189</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1190"><a href="#EmulatorLauncher-1190"><span class="linenos">1190</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-1191"><a href="#EmulatorLauncher-1191"><span class="linenos">1191</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher-1192"><a href="#EmulatorLauncher-1192"><span class="linenos">1192</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher-1193"><a href="#EmulatorLauncher-1193"><span class="linenos">1193</span></a>                        <span class="p">):</span>
</span><span id="EmulatorLauncher-1194"><a href="#EmulatorLauncher-1194"><span class="linenos">1194</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1195"><a href="#EmulatorLauncher-1195"><span class="linenos">1195</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1196"><a href="#EmulatorLauncher-1196"><span class="linenos">1196</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1197"><a href="#EmulatorLauncher-1197"><span class="linenos">1197</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1198"><a href="#EmulatorLauncher-1198"><span class="linenos">1198</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1199"><a href="#EmulatorLauncher-1199"><span class="linenos">1199</span></a>
</span><span id="EmulatorLauncher-1200"><a href="#EmulatorLauncher-1200"><span class="linenos">1200</span></a>                    <span class="c1"># For LEFT</span>
</span><span id="EmulatorLauncher-1201"><a href="#EmulatorLauncher-1201"><span class="linenos">1201</span></a>                    <span class="k">if</span> <span class="n">axis_x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1202"><a href="#EmulatorLauncher-1202"><span class="linenos">1202</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1203"><a href="#EmulatorLauncher-1203"><span class="linenos">1203</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1204"><a href="#EmulatorLauncher-1204"><span class="linenos">1204</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1205"><a href="#EmulatorLauncher-1205"><span class="linenos">1205</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1206"><a href="#EmulatorLauncher-1206"><span class="linenos">1206</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-1207"><a href="#EmulatorLauncher-1207"><span class="linenos">1207</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher-1208"><a href="#EmulatorLauncher-1208"><span class="linenos">1208</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher-1209"><a href="#EmulatorLauncher-1209"><span class="linenos">1209</span></a>                        <span class="p">):</span>
</span><span id="EmulatorLauncher-1210"><a href="#EmulatorLauncher-1210"><span class="linenos">1210</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1211"><a href="#EmulatorLauncher-1211"><span class="linenos">1211</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1212"><a href="#EmulatorLauncher-1212"><span class="linenos">1212</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1213"><a href="#EmulatorLauncher-1213"><span class="linenos">1213</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1214"><a href="#EmulatorLauncher-1214"><span class="linenos">1214</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1215"><a href="#EmulatorLauncher-1215"><span class="linenos">1215</span></a>
</span><span id="EmulatorLauncher-1216"><a href="#EmulatorLauncher-1216"><span class="linenos">1216</span></a>                    <span class="c1"># For RIGHT</span>
</span><span id="EmulatorLauncher-1217"><a href="#EmulatorLauncher-1217"><span class="linenos">1217</span></a>                    <span class="k">if</span> <span class="n">axis_x</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1218"><a href="#EmulatorLauncher-1218"><span class="linenos">1218</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1219"><a href="#EmulatorLauncher-1219"><span class="linenos">1219</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1220"><a href="#EmulatorLauncher-1220"><span class="linenos">1220</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1221"><a href="#EmulatorLauncher-1221"><span class="linenos">1221</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1222"><a href="#EmulatorLauncher-1222"><span class="linenos">1222</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher-1223"><a href="#EmulatorLauncher-1223"><span class="linenos">1223</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher-1224"><a href="#EmulatorLauncher-1224"><span class="linenos">1224</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher-1225"><a href="#EmulatorLauncher-1225"><span class="linenos">1225</span></a>                        <span class="p">):</span>
</span><span id="EmulatorLauncher-1226"><a href="#EmulatorLauncher-1226"><span class="linenos">1226</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="EmulatorLauncher-1227"><a href="#EmulatorLauncher-1227"><span class="linenos">1227</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher-1228"><a href="#EmulatorLauncher-1228"><span class="linenos">1228</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1229"><a href="#EmulatorLauncher-1229"><span class="linenos">1229</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1230"><a href="#EmulatorLauncher-1230"><span class="linenos">1230</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher-1231"><a href="#EmulatorLauncher-1231"><span class="linenos">1231</span></a>
</span><span id="EmulatorLauncher-1232"><a href="#EmulatorLauncher-1232"><span class="linenos">1232</span></a>            <span class="c1"># Check if the emulator process has finished.</span>
</span><span id="EmulatorLauncher-1233"><a href="#EmulatorLauncher-1233"><span class="linenos">1233</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EmulatorLauncher-1234"><a href="#EmulatorLauncher-1234"><span class="linenos">1234</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher-1235"><a href="#EmulatorLauncher-1235"><span class="linenos">1235</span></a>
</span><span id="EmulatorLauncher-1236"><a href="#EmulatorLauncher-1236"><span class="linenos">1236</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>EmulatorLauncher is a class that manages the launching and navigation of ROMs for various emulators.</p>
</div>


                            <div id="EmulatorLauncher.app_name" class="classattr">
                                <div class="attr variable">
            <span class="name">app_name</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.app_name"></a>
    
            <div class="docstring"><p>The name of the application.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.vendor_name" class="classattr">
                                <div class="attr variable">
            <span class="name">vendor_name</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.vendor_name"></a>
    
            <div class="docstring"><p>The vendor name associated with the application.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.config_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">config_dir</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.config_dir"></a>
    
            <div class="docstring"><p>The directory path for storing user configuration files.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.config_file" class="classattr">
                                <div class="attr variable">
            <span class="name">config_file</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.config_file"></a>
    
            <div class="docstring"><p>The file path for the configuration file.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.favorites_file" class="classattr">
                                <div class="attr variable">
            <span class="name">favorites_file</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.favorites_file"></a>
    
            <div class="docstring"><p>The file path for the favorites file.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.config" class="classattr">
                                <div class="attr variable">
            <span class="name">config</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.config"></a>
    
            <div class="docstring"><p>The loaded configuration dictionary.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.favorites" class="classattr">
                                <div class="attr variable">
            <span class="name">favorites</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.favorites"></a>
    
            <div class="docstring"><p>The loaded favorites dictionary.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.roms" class="classattr">
                                <div class="attr variable">
            <span class="name">roms</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.roms"></a>
    
            <div class="docstring"><p>A dictionary of ROMs categorized by system.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.all_roms" class="classattr">
                                <div class="attr variable">
            <span class="name">all_roms</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.all_roms"></a>
    
            <div class="docstring"><p>A list of all ROMs across all systems.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.selected_system" class="classattr">
                                <div class="attr variable">
            <span class="name">selected_system</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.selected_system"></a>
    
            <div class="docstring"><p>The index of the currently selected system.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.selected_rom" class="classattr">
                                <div class="attr variable">
            <span class="name">selected_rom</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.selected_rom"></a>
    
            <div class="docstring"><p>The index of the currently selected ROM.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.total_roms" class="classattr">
                                <div class="attr variable">
            <span class="name">total_roms</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.total_roms"></a>
    
            <div class="docstring"><p>The total number of ROMs in the current view.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.current_rom_index" class="classattr">
                                <div class="attr variable">
            <span class="name">current_rom_index</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.current_rom_index"></a>
    
            <div class="docstring"><p>The index of the currently selected ROM (1-based).</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.system_window" class="classattr">
                                <div class="attr variable">
            <span class="name">system_window</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.system_window"></a>
    
            <div class="docstring"><p>The window object for displaying systems.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.rom_window" class="classattr">
                                <div class="attr variable">
            <span class="name">rom_window</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.rom_window"></a>
    
            <div class="docstring"><p>The window object for displaying ROMs.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.emulator_process" class="classattr">
                                <div class="attr variable">
            <span class="name">emulator_process</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.emulator_process"></a>
    
            <div class="docstring"><p>The process object for the running emulator.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.focus" class="classattr">
                                <div class="attr variable">
            <span class="name">focus</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.focus"></a>
    
            <div class="docstring"><p>The current focus of the application (either 'systems' or 'roms').</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.filter_string" class="classattr">
                                <div class="attr variable">
            <span class="name">filter_string</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.filter_string"></a>
    
            <div class="docstring"><p>The string used to filter ROMs.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.filtered_roms" class="classattr">
                                <div class="attr variable">
            <span class="name">filtered_roms</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.filtered_roms"></a>
    
            <div class="docstring"><p>A dictionary of filtered ROMs based on the filter string and view mode.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.last_selection_change_time" class="classattr">
                                <div class="attr variable">
            <span class="name">last_selection_change_time</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.last_selection_change_time"></a>
    
            <div class="docstring"><p>The timestamp of the last selection change.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.mode" class="classattr">
                                <div class="attr variable">
            <span class="name">mode</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.mode"></a>
    
            <div class="docstring"><p>The current mode of the application (either 'navigate' or 'filter').</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.view_mode" class="classattr">
                                <div class="attr variable">
            <span class="name">view_mode</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.view_mode"></a>
    
            <div class="docstring"><p>The current view mode (either 'favorites' or 'systems').</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.joystick" class="classattr">
                                <div class="attr variable">
            <span class="name">joystick</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.joystick"></a>
    
            <div class="docstring"><p>The joystick object for gamepad support.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.first_axis_event" class="classattr">
                                <div class="attr variable">
            <span class="name">first_axis_event</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.first_axis_event"></a>
    
            <div class="docstring"><p>The timestamp of the first axis event for each direction.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.last_axis_event" class="classattr">
                                <div class="attr variable">
            <span class="name">last_axis_event</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.last_axis_event"></a>
    
            <div class="docstring"><p>The timestamp of the last axis event for each direction.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.first_hat_event" class="classattr">
                                <div class="attr variable">
            <span class="name">first_hat_event</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.first_hat_event"></a>
    
            <div class="docstring"><p>The timestamp of the first hat event for each direction.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.last_hat_event" class="classattr">
                                <div class="attr variable">
            <span class="name">last_hat_event</span>

        
    </div>
    <a class="headerlink" href="#EmulatorLauncher.last_hat_event"></a>
    
            <div class="docstring"><p>The timestamp of the last hat event for each direction.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.load_config" class="classattr">
                                        <input id="EmulatorLauncher.load_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_config</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.load_config-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.load_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.load_config-130"><a href="#EmulatorLauncher.load_config-130"><span class="linenos">130</span></a>    <span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.load_config-131"><a href="#EmulatorLauncher.load_config-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.load_config-132"><a href="#EmulatorLauncher.load_config-132"><span class="linenos">132</span></a><span class="sd">        Load the configuration from a platform-specific location.</span>
</span><span id="EmulatorLauncher.load_config-133"><a href="#EmulatorLauncher.load_config-133"><span class="linenos">133</span></a><span class="sd">        This method attempts to load the configuration from a file specified by</span>
</span><span id="EmulatorLauncher.load_config-134"><a href="#EmulatorLauncher.load_config-134"><span class="linenos">134</span></a><span class="sd">        `self.config_file`. If the file does not exist, it creates a default</span>
</span><span id="EmulatorLauncher.load_config-135"><a href="#EmulatorLauncher.load_config-135"><span class="linenos">135</span></a><span class="sd">        configuration file. If an error occurs during loading, it prints an error</span>
</span><span id="EmulatorLauncher.load_config-136"><a href="#EmulatorLauncher.load_config-136"><span class="linenos">136</span></a><span class="sd">        message and returns the default configuration.</span>
</span><span id="EmulatorLauncher.load_config-137"><a href="#EmulatorLauncher.load_config-137"><span class="linenos">137</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher.load_config-138"><a href="#EmulatorLauncher.load_config-138"><span class="linenos">138</span></a><span class="sd">            dict: The loaded configuration as a dictionary. If the configuration</span>
</span><span id="EmulatorLauncher.load_config-139"><a href="#EmulatorLauncher.load_config-139"><span class="linenos">139</span></a><span class="sd">            file does not exist or an error occurs, returns the default configuration.</span>
</span><span id="EmulatorLauncher.load_config-140"><a href="#EmulatorLauncher.load_config-140"><span class="linenos">140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.load_config-141"><a href="#EmulatorLauncher.load_config-141"><span class="linenos">141</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="EmulatorLauncher.load_config-142"><a href="#EmulatorLauncher.load_config-142"><span class="linenos">142</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="EmulatorLauncher.load_config-143"><a href="#EmulatorLauncher.load_config-143"><span class="linenos">143</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">create_default_config</span><span class="p">()</span>
</span><span id="EmulatorLauncher.load_config-144"><a href="#EmulatorLauncher.load_config-144"><span class="linenos">144</span></a>
</span><span id="EmulatorLauncher.load_config-145"><a href="#EmulatorLauncher.load_config-145"><span class="linenos">145</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="EmulatorLauncher.load_config-146"><a href="#EmulatorLauncher.load_config-146"><span class="linenos">146</span></a>                <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher.load_config-147"><a href="#EmulatorLauncher.load_config-147"><span class="linenos">147</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EmulatorLauncher.load_config-148"><a href="#EmulatorLauncher.load_config-148"><span class="linenos">148</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading config: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher.load_config-149"><a href="#EmulatorLauncher.load_config-149"><span class="linenos">149</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_default_config</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Load the configuration from a platform-specific location.
This method attempts to load the configuration from a file specified by
<code>self.config_file</code>. If the file does not exist, it creates a default
configuration file. If an error occurs during loading, it prints an error
message and returns the default configuration.
Returns:
    dict: The loaded configuration as a dictionary. If the configuration
    file does not exist or an error occurs, returns the default configuration.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.create_default_config" class="classattr">
                                        <input id="EmulatorLauncher.create_default_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_default_config</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.create_default_config-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.create_default_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.create_default_config-151"><a href="#EmulatorLauncher.create_default_config-151"><span class="linenos">151</span></a>    <span class="k">def</span> <span class="nf">create_default_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.create_default_config-152"><a href="#EmulatorLauncher.create_default_config-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.create_default_config-153"><a href="#EmulatorLauncher.create_default_config-153"><span class="linenos">153</span></a><span class="sd">        Creates and saves a default configuration for the ROM launcher.</span>
</span><span id="EmulatorLauncher.create_default_config-154"><a href="#EmulatorLauncher.create_default_config-154"><span class="linenos">154</span></a>
</span><span id="EmulatorLauncher.create_default_config-155"><a href="#EmulatorLauncher.create_default_config-155"><span class="linenos">155</span></a><span class="sd">        The default configuration includes settings for the NES system, specifying</span>
</span><span id="EmulatorLauncher.create_default_config-156"><a href="#EmulatorLauncher.create_default_config-156"><span class="linenos">156</span></a><span class="sd">        the emulator path, launch arguments, and ROM paths.</span>
</span><span id="EmulatorLauncher.create_default_config-157"><a href="#EmulatorLauncher.create_default_config-157"><span class="linenos">157</span></a>
</span><span id="EmulatorLauncher.create_default_config-158"><a href="#EmulatorLauncher.create_default_config-158"><span class="linenos">158</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher.create_default_config-159"><a href="#EmulatorLauncher.create_default_config-159"><span class="linenos">159</span></a><span class="sd">            dict: The default configuration dictionary.</span>
</span><span id="EmulatorLauncher.create_default_config-160"><a href="#EmulatorLauncher.create_default_config-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.create_default_config-161"><a href="#EmulatorLauncher.create_default_config-161"><span class="linenos">161</span></a>        <span class="n">default_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="EmulatorLauncher.create_default_config-162"><a href="#EmulatorLauncher.create_default_config-162"><span class="linenos">162</span></a>            <span class="s2">&quot;systems&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="EmulatorLauncher.create_default_config-163"><a href="#EmulatorLauncher.create_default_config-163"><span class="linenos">163</span></a>                <span class="s2">&quot;NES&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="EmulatorLauncher.create_default_config-164"><a href="#EmulatorLauncher.create_default_config-164"><span class="linenos">164</span></a>                    <span class="s2">&quot;emulator_path&quot;</span><span class="p">:</span> <span class="s2">&quot;retroarch&quot;</span><span class="p">,</span>
</span><span id="EmulatorLauncher.create_default_config-165"><a href="#EmulatorLauncher.create_default_config-165"><span class="linenos">165</span></a>                    <span class="s2">&quot;launch_arguments&quot;</span><span class="p">:</span> <span class="s2">&quot;-L cores/fceumm_libretro.dll </span><span class="si">{rom_path}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="EmulatorLauncher.create_default_config-166"><a href="#EmulatorLauncher.create_default_config-166"><span class="linenos">166</span></a>                    <span class="s2">&quot;paths&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;~/ROMs/NES&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher.create_default_config-167"><a href="#EmulatorLauncher.create_default_config-167"><span class="linenos">167</span></a>                <span class="p">}</span>
</span><span id="EmulatorLauncher.create_default_config-168"><a href="#EmulatorLauncher.create_default_config-168"><span class="linenos">168</span></a>            <span class="p">}</span>
</span><span id="EmulatorLauncher.create_default_config-169"><a href="#EmulatorLauncher.create_default_config-169"><span class="linenos">169</span></a>        <span class="p">}</span>
</span><span id="EmulatorLauncher.create_default_config-170"><a href="#EmulatorLauncher.create_default_config-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">save_config</span><span class="p">(</span><span class="n">default_config</span><span class="p">)</span>
</span><span id="EmulatorLauncher.create_default_config-171"><a href="#EmulatorLauncher.create_default_config-171"><span class="linenos">171</span></a>        <span class="k">return</span> <span class="n">default_config</span>
</span></pre></div>


            <div class="docstring"><p>Creates and saves a default configuration for the ROM launcher.</p>

<p>The default configuration includes settings for the NES system, specifying
the emulator path, launch arguments, and ROM paths.</p>

<p>Returns:
    dict: The default configuration dictionary.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.save_config" class="classattr">
                                        <input id="EmulatorLauncher.save_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_config</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">config</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.save_config-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.save_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.save_config-173"><a href="#EmulatorLauncher.save_config-173"><span class="linenos">173</span></a>    <span class="k">def</span> <span class="nf">save_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="EmulatorLauncher.save_config-174"><a href="#EmulatorLauncher.save_config-174"><span class="linenos">174</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.save_config-175"><a href="#EmulatorLauncher.save_config-175"><span class="linenos">175</span></a><span class="sd">        Save the current configuration to a file.</span>
</span><span id="EmulatorLauncher.save_config-176"><a href="#EmulatorLauncher.save_config-176"><span class="linenos">176</span></a>
</span><span id="EmulatorLauncher.save_config-177"><a href="#EmulatorLauncher.save_config-177"><span class="linenos">177</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher.save_config-178"><a href="#EmulatorLauncher.save_config-178"><span class="linenos">178</span></a><span class="sd">            config (dict, optional): The configuration dictionary to save.</span>
</span><span id="EmulatorLauncher.save_config-179"><a href="#EmulatorLauncher.save_config-179"><span class="linenos">179</span></a><span class="sd">                                     If not provided, the current configuration</span>
</span><span id="EmulatorLauncher.save_config-180"><a href="#EmulatorLauncher.save_config-180"><span class="linenos">180</span></a><span class="sd">                                     stored in self.config will be used.</span>
</span><span id="EmulatorLauncher.save_config-181"><a href="#EmulatorLauncher.save_config-181"><span class="linenos">181</span></a>
</span><span id="EmulatorLauncher.save_config-182"><a href="#EmulatorLauncher.save_config-182"><span class="linenos">182</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher.save_config-183"><a href="#EmulatorLauncher.save_config-183"><span class="linenos">183</span></a><span class="sd">            IOError: If there is an error writing to the file.</span>
</span><span id="EmulatorLauncher.save_config-184"><a href="#EmulatorLauncher.save_config-184"><span class="linenos">184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.save_config-185"><a href="#EmulatorLauncher.save_config-185"><span class="linenos">185</span></a>        <span class="n">config</span> <span class="o">=</span> <span class="n">config</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span>
</span><span id="EmulatorLauncher.save_config-186"><a href="#EmulatorLauncher.save_config-186"><span class="linenos">186</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="EmulatorLauncher.save_config-187"><a href="#EmulatorLauncher.save_config-187"><span class="linenos">187</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save the current configuration to a file.</p>

<p>Args:
    config (dict, optional): The configuration dictionary to save.
                             If not provided, the current configuration
                             stored in self.config will be used.</p>

<p>Raises:
    IOError: If there is an error writing to the file.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.load_favorites" class="classattr">
                                        <input id="EmulatorLauncher.load_favorites-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_favorites</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.load_favorites-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.load_favorites"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.load_favorites-189"><a href="#EmulatorLauncher.load_favorites-189"><span class="linenos">189</span></a>    <span class="k">def</span> <span class="nf">load_favorites</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.load_favorites-190"><a href="#EmulatorLauncher.load_favorites-190"><span class="linenos">190</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.load_favorites-191"><a href="#EmulatorLauncher.load_favorites-191"><span class="linenos">191</span></a><span class="sd">        Loads the favorites from a YAML file.</span>
</span><span id="EmulatorLauncher.load_favorites-192"><a href="#EmulatorLauncher.load_favorites-192"><span class="linenos">192</span></a><span class="sd">        This method attempts to load the favorites from a specified YAML file.</span>
</span><span id="EmulatorLauncher.load_favorites-193"><a href="#EmulatorLauncher.load_favorites-193"><span class="linenos">193</span></a><span class="sd">        If the file does not exist, it returns an empty dictionary. If there is</span>
</span><span id="EmulatorLauncher.load_favorites-194"><a href="#EmulatorLauncher.load_favorites-194"><span class="linenos">194</span></a><span class="sd">        an error during the loading process, it catches the exception, prints</span>
</span><span id="EmulatorLauncher.load_favorites-195"><a href="#EmulatorLauncher.load_favorites-195"><span class="linenos">195</span></a><span class="sd">        an error message, and returns an empty dictionary.</span>
</span><span id="EmulatorLauncher.load_favorites-196"><a href="#EmulatorLauncher.load_favorites-196"><span class="linenos">196</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher.load_favorites-197"><a href="#EmulatorLauncher.load_favorites-197"><span class="linenos">197</span></a><span class="sd">            dict: A dictionary containing the favorites loaded from the YAML file,</span>
</span><span id="EmulatorLauncher.load_favorites-198"><a href="#EmulatorLauncher.load_favorites-198"><span class="linenos">198</span></a><span class="sd">                  or an empty dictionary if the file does not exist or an error occurs.</span>
</span><span id="EmulatorLauncher.load_favorites-199"><a href="#EmulatorLauncher.load_favorites-199"><span class="linenos">199</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.load_favorites-200"><a href="#EmulatorLauncher.load_favorites-200"><span class="linenos">200</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="EmulatorLauncher.load_favorites-201"><a href="#EmulatorLauncher.load_favorites-201"><span class="linenos">201</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="EmulatorLauncher.load_favorites-202"><a href="#EmulatorLauncher.load_favorites-202"><span class="linenos">202</span></a>                <span class="k">return</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher.load_favorites-203"><a href="#EmulatorLauncher.load_favorites-203"><span class="linenos">203</span></a>
</span><span id="EmulatorLauncher.load_favorites-204"><a href="#EmulatorLauncher.load_favorites-204"><span class="linenos">204</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="EmulatorLauncher.load_favorites-205"><a href="#EmulatorLauncher.load_favorites-205"><span class="linenos">205</span></a>                <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher.load_favorites-206"><a href="#EmulatorLauncher.load_favorites-206"><span class="linenos">206</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EmulatorLauncher.load_favorites-207"><a href="#EmulatorLauncher.load_favorites-207"><span class="linenos">207</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading favorites: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher.load_favorites-208"><a href="#EmulatorLauncher.load_favorites-208"><span class="linenos">208</span></a>            <span class="k">return</span> <span class="p">{}</span>
</span></pre></div>


            <div class="docstring"><p>Loads the favorites from a YAML file.
This method attempts to load the favorites from a specified YAML file.
If the file does not exist, it returns an empty dictionary. If there is
an error during the loading process, it catches the exception, prints
an error message, and returns an empty dictionary.
Returns:
    dict: A dictionary containing the favorites loaded from the YAML file,
          or an empty dictionary if the file does not exist or an error occurs.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.save_favorites" class="classattr">
                                        <input id="EmulatorLauncher.save_favorites-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_favorites</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.save_favorites-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.save_favorites"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.save_favorites-210"><a href="#EmulatorLauncher.save_favorites-210"><span class="linenos">210</span></a>    <span class="k">def</span> <span class="nf">save_favorites</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.save_favorites-211"><a href="#EmulatorLauncher.save_favorites-211"><span class="linenos">211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.save_favorites-212"><a href="#EmulatorLauncher.save_favorites-212"><span class="linenos">212</span></a><span class="sd">        Saves the current list of favorite ROMs to a file.</span>
</span><span id="EmulatorLauncher.save_favorites-213"><a href="#EmulatorLauncher.save_favorites-213"><span class="linenos">213</span></a>
</span><span id="EmulatorLauncher.save_favorites-214"><a href="#EmulatorLauncher.save_favorites-214"><span class="linenos">214</span></a><span class="sd">        This method writes the contents of the `self.favorites` list to the file</span>
</span><span id="EmulatorLauncher.save_favorites-215"><a href="#EmulatorLauncher.save_favorites-215"><span class="linenos">215</span></a><span class="sd">        specified by `self.favorites_file` in YAML format.</span>
</span><span id="EmulatorLauncher.save_favorites-216"><a href="#EmulatorLauncher.save_favorites-216"><span class="linenos">216</span></a>
</span><span id="EmulatorLauncher.save_favorites-217"><a href="#EmulatorLauncher.save_favorites-217"><span class="linenos">217</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher.save_favorites-218"><a href="#EmulatorLauncher.save_favorites-218"><span class="linenos">218</span></a><span class="sd">            IOError: If the file cannot be opened or written to.</span>
</span><span id="EmulatorLauncher.save_favorites-219"><a href="#EmulatorLauncher.save_favorites-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.save_favorites-220"><a href="#EmulatorLauncher.save_favorites-220"><span class="linenos">220</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">favorites_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="EmulatorLauncher.save_favorites-221"><a href="#EmulatorLauncher.save_favorites-221"><span class="linenos">221</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Saves the current list of favorite ROMs to a file.</p>

<p>This method writes the contents of the <code>self.favorites</code> list to the file
specified by <code>self.favorites_file</code> in YAML format.</p>

<p>Raises:
    IOError: If the file cannot be opened or written to.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.init_colors" class="classattr">
                                        <input id="EmulatorLauncher.init_colors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">init_colors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.init_colors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.init_colors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.init_colors-223"><a href="#EmulatorLauncher.init_colors-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">init_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.init_colors-224"><a href="#EmulatorLauncher.init_colors-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.init_colors-225"><a href="#EmulatorLauncher.init_colors-225"><span class="linenos">225</span></a><span class="sd">        Initialize color pairs for the UI using the curses library.</span>
</span><span id="EmulatorLauncher.init_colors-226"><a href="#EmulatorLauncher.init_colors-226"><span class="linenos">226</span></a><span class="sd">        This method sets up the color pairs that will be used throughout the UI.</span>
</span><span id="EmulatorLauncher.init_colors-227"><a href="#EmulatorLauncher.init_colors-227"><span class="linenos">227</span></a><span class="sd">        It starts by initializing the curses color system and using the default</span>
</span><span id="EmulatorLauncher.init_colors-228"><a href="#EmulatorLauncher.init_colors-228"><span class="linenos">228</span></a><span class="sd">        terminal colors. Then, it defines several color pairs for different UI</span>
</span><span id="EmulatorLauncher.init_colors-229"><a href="#EmulatorLauncher.init_colors-229"><span class="linenos">229</span></a><span class="sd">        elements such as headers, selected items, favorites, normal text,</span>
</span><span id="EmulatorLauncher.init_colors-230"><a href="#EmulatorLauncher.init_colors-230"><span class="linenos">230</span></a><span class="sd">        highlighted text, and the status bar.</span>
</span><span id="EmulatorLauncher.init_colors-231"><a href="#EmulatorLauncher.init_colors-231"><span class="linenos">231</span></a><span class="sd">        Color pairs defined:</span>
</span><span id="EmulatorLauncher.init_colors-232"><a href="#EmulatorLauncher.init_colors-232"><span class="linenos">232</span></a><span class="sd">        - HEADER: White text on a blue background</span>
</span><span id="EmulatorLauncher.init_colors-233"><a href="#EmulatorLauncher.init_colors-233"><span class="linenos">233</span></a><span class="sd">        - SELECTED: Black text on a white background</span>
</span><span id="EmulatorLauncher.init_colors-234"><a href="#EmulatorLauncher.init_colors-234"><span class="linenos">234</span></a><span class="sd">        - FAVORITE: Yellow text on the default background</span>
</span><span id="EmulatorLauncher.init_colors-235"><a href="#EmulatorLauncher.init_colors-235"><span class="linenos">235</span></a><span class="sd">        - NORMAL: White text on the default background</span>
</span><span id="EmulatorLauncher.init_colors-236"><a href="#EmulatorLauncher.init_colors-236"><span class="linenos">236</span></a><span class="sd">        - HIGHLIGHT: Cyan text on the default background</span>
</span><span id="EmulatorLauncher.init_colors-237"><a href="#EmulatorLauncher.init_colors-237"><span class="linenos">237</span></a><span class="sd">        - STATUS_BAR: Black text on a white background</span>
</span><span id="EmulatorLauncher.init_colors-238"><a href="#EmulatorLauncher.init_colors-238"><span class="linenos">238</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.init_colors-239"><a href="#EmulatorLauncher.init_colors-239"><span class="linenos">239</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">start_color</span><span class="p">()</span>
</span><span id="EmulatorLauncher.init_colors-240"><a href="#EmulatorLauncher.init_colors-240"><span class="linenos">240</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">use_default_colors</span><span class="p">()</span>
</span><span id="EmulatorLauncher.init_colors-241"><a href="#EmulatorLauncher.init_colors-241"><span class="linenos">241</span></a>
</span><span id="EmulatorLauncher.init_colors-242"><a href="#EmulatorLauncher.init_colors-242"><span class="linenos">242</span></a>        <span class="c1"># Define color pairs</span>
</span><span id="EmulatorLauncher.init_colors-243"><a href="#EmulatorLauncher.init_colors-243"><span class="linenos">243</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HEADER</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_BLUE</span><span class="p">)</span>
</span><span id="EmulatorLauncher.init_colors-244"><a href="#EmulatorLauncher.init_colors-244"><span class="linenos">244</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_BLACK</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span><span class="p">)</span>
</span><span id="EmulatorLauncher.init_colors-245"><a href="#EmulatorLauncher.init_colors-245"><span class="linenos">245</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">FAVORITE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_YELLOW</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher.init_colors-246"><a href="#EmulatorLauncher.init_colors-246"><span class="linenos">246</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher.init_colors-247"><a href="#EmulatorLauncher.init_colors-247"><span class="linenos">247</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HIGHLIGHT</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_CYAN</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher.init_colors-248"><a href="#EmulatorLauncher.init_colors-248"><span class="linenos">248</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">init_pair</span><span class="p">(</span>
</span><span id="EmulatorLauncher.init_colors-249"><a href="#EmulatorLauncher.init_colors-249"><span class="linenos">249</span></a>            <span class="n">Colors</span><span class="o">.</span><span class="n">STATUS_BAR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_BLACK</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">COLOR_WHITE</span>
</span><span id="EmulatorLauncher.init_colors-250"><a href="#EmulatorLauncher.init_colors-250"><span class="linenos">250</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize color pairs for the UI using the curses library.
This method sets up the color pairs that will be used throughout the UI.
It starts by initializing the curses color system and using the default
terminal colors. Then, it defines several color pairs for different UI
elements such as headers, selected items, favorites, normal text,
highlighted text, and the status bar.
Color pairs defined:</p>

<ul>
<li>HEADER: White text on a blue background</li>
<li>SELECTED: Black text on a white background</li>
<li>FAVORITE: Yellow text on the default background</li>
<li>NORMAL: White text on the default background</li>
<li>HIGHLIGHT: Cyan text on the default background</li>
<li>STATUS_BAR: Black text on a white background</li>
</ul>
</div>


                            </div>
                            <div id="EmulatorLauncher.draw_borders" class="classattr">
                                        <input id="EmulatorLauncher.draw_borders-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_borders</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.draw_borders-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.draw_borders"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.draw_borders-252"><a href="#EmulatorLauncher.draw_borders-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">draw_borders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.draw_borders-253"><a href="#EmulatorLauncher.draw_borders-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.draw_borders-254"><a href="#EmulatorLauncher.draw_borders-254"><span class="linenos">254</span></a><span class="sd">        Draws borders and headers for the system and ROM windows.</span>
</span><span id="EmulatorLauncher.draw_borders-255"><a href="#EmulatorLauncher.draw_borders-255"><span class="linenos">255</span></a><span class="sd">        This method draws a box around the system window and adds a header</span>
</span><span id="EmulatorLauncher.draw_borders-256"><a href="#EmulatorLauncher.draw_borders-256"><span class="linenos">256</span></a><span class="sd">        labeled &quot;[ Systems ]&quot; with a specific color. It also draws a box</span>
</span><span id="EmulatorLauncher.draw_borders-257"><a href="#EmulatorLauncher.draw_borders-257"><span class="linenos">257</span></a><span class="sd">        around the ROM window and adds a header labeled &quot;[ Games ]&quot; with</span>
</span><span id="EmulatorLauncher.draw_borders-258"><a href="#EmulatorLauncher.draw_borders-258"><span class="linenos">258</span></a><span class="sd">        the same color.</span>
</span><span id="EmulatorLauncher.draw_borders-259"><a href="#EmulatorLauncher.draw_borders-259"><span class="linenos">259</span></a><span class="sd">        The colors used for the headers are defined by the Colors.HEADER</span>
</span><span id="EmulatorLauncher.draw_borders-260"><a href="#EmulatorLauncher.draw_borders-260"><span class="linenos">260</span></a><span class="sd">        enumeration value.</span>
</span><span id="EmulatorLauncher.draw_borders-261"><a href="#EmulatorLauncher.draw_borders-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.draw_borders-262"><a href="#EmulatorLauncher.draw_borders-262"><span class="linenos">262</span></a>        <span class="c1"># Draw system window border</span>
</span><span id="EmulatorLauncher.draw_borders-263"><a href="#EmulatorLauncher.draw_borders-263"><span class="linenos">263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</span><span id="EmulatorLauncher.draw_borders-264"><a href="#EmulatorLauncher.draw_borders-264"><span class="linenos">264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher.draw_borders-265"><a href="#EmulatorLauncher.draw_borders-265"><span class="linenos">265</span></a>            <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;[ Systems ]&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HEADER</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_borders-266"><a href="#EmulatorLauncher.draw_borders-266"><span class="linenos">266</span></a>        <span class="p">)</span>
</span><span id="EmulatorLauncher.draw_borders-267"><a href="#EmulatorLauncher.draw_borders-267"><span class="linenos">267</span></a>
</span><span id="EmulatorLauncher.draw_borders-268"><a href="#EmulatorLauncher.draw_borders-268"><span class="linenos">268</span></a>        <span class="c1"># Draw ROM window border</span>
</span><span id="EmulatorLauncher.draw_borders-269"><a href="#EmulatorLauncher.draw_borders-269"><span class="linenos">269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
</span><span id="EmulatorLauncher.draw_borders-270"><a href="#EmulatorLauncher.draw_borders-270"><span class="linenos">270</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher.draw_borders-271"><a href="#EmulatorLauncher.draw_borders-271"><span class="linenos">271</span></a>            <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;[ Games ]&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">HEADER</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_borders-272"><a href="#EmulatorLauncher.draw_borders-272"><span class="linenos">272</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Draws borders and headers for the system and ROM windows.
This method draws a box around the system window and adds a header
labeled "[ Systems ]" with a specific color. It also draws a box
around the ROM window and adds a header labeled "[ Games ]" with
the same color.
The colors used for the headers are defined by the <a href="#Colors.HEADER">Colors.HEADER</a>
enumeration value.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.get_roms" class="classattr">
                                        <input id="EmulatorLauncher.get_roms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_roms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.get_roms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.get_roms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.get_roms-274"><a href="#EmulatorLauncher.get_roms-274"><span class="linenos">274</span></a>    <span class="k">def</span> <span class="nf">get_roms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.get_roms-275"><a href="#EmulatorLauncher.get_roms-275"><span class="linenos">275</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.get_roms-276"><a href="#EmulatorLauncher.get_roms-276"><span class="linenos">276</span></a><span class="sd">        Retrieves a list of ROMs from the configured paths for each system.</span>
</span><span id="EmulatorLauncher.get_roms-277"><a href="#EmulatorLauncher.get_roms-277"><span class="linenos">277</span></a>
</span><span id="EmulatorLauncher.get_roms-278"><a href="#EmulatorLauncher.get_roms-278"><span class="linenos">278</span></a><span class="sd">        This method iterates through the systems defined in the configuration,</span>
</span><span id="EmulatorLauncher.get_roms-279"><a href="#EmulatorLauncher.get_roms-279"><span class="linenos">279</span></a><span class="sd">        collects ROM file paths from the specified directories, and organizes</span>
</span><span id="EmulatorLauncher.get_roms-280"><a href="#EmulatorLauncher.get_roms-280"><span class="linenos">280</span></a><span class="sd">        them by system.</span>
</span><span id="EmulatorLauncher.get_roms-281"><a href="#EmulatorLauncher.get_roms-281"><span class="linenos">281</span></a>
</span><span id="EmulatorLauncher.get_roms-282"><a href="#EmulatorLauncher.get_roms-282"><span class="linenos">282</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher.get_roms-283"><a href="#EmulatorLauncher.get_roms-283"><span class="linenos">283</span></a><span class="sd">            dict: A dictionary where the keys are system names and the values</span>
</span><span id="EmulatorLauncher.get_roms-284"><a href="#EmulatorLauncher.get_roms-284"><span class="linenos">284</span></a><span class="sd">                  are lists of ROM file paths.</span>
</span><span id="EmulatorLauncher.get_roms-285"><a href="#EmulatorLauncher.get_roms-285"><span class="linenos">285</span></a>
</span><span id="EmulatorLauncher.get_roms-286"><a href="#EmulatorLauncher.get_roms-286"><span class="linenos">286</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher.get_roms-287"><a href="#EmulatorLauncher.get_roms-287"><span class="linenos">287</span></a><span class="sd">            Prints a warning message if a specified ROM path is invalid.</span>
</span><span id="EmulatorLauncher.get_roms-288"><a href="#EmulatorLauncher.get_roms-288"><span class="linenos">288</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.get_roms-289"><a href="#EmulatorLauncher.get_roms-289"><span class="linenos">289</span></a>        <span class="n">roms</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher.get_roms-290"><a href="#EmulatorLauncher.get_roms-290"><span class="linenos">290</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;systems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher.get_roms-291"><a href="#EmulatorLauncher.get_roms-291"><span class="linenos">291</span></a>            <span class="n">roms</span><span class="p">[</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher.get_roms-292"><a href="#EmulatorLauncher.get_roms-292"><span class="linenos">292</span></a>            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;paths&quot;</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="EmulatorLauncher.get_roms-293"><a href="#EmulatorLauncher.get_roms-293"><span class="linenos">293</span></a>                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span><span id="EmulatorLauncher.get_roms-294"><a href="#EmulatorLauncher.get_roms-294"><span class="linenos">294</span></a>                    <span class="n">roms</span><span class="p">[</span><span class="n">system</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
</span><span id="EmulatorLauncher.get_roms-295"><a href="#EmulatorLauncher.get_roms-295"><span class="linenos">295</span></a>                        <span class="p">[</span>
</span><span id="EmulatorLauncher.get_roms-296"><a href="#EmulatorLauncher.get_roms-296"><span class="linenos">296</span></a>                            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="EmulatorLauncher.get_roms-297"><a href="#EmulatorLauncher.get_roms-297"><span class="linenos">297</span></a>                            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.get_roms-298"><a href="#EmulatorLauncher.get_roms-298"><span class="linenos">298</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher.get_roms-299"><a href="#EmulatorLauncher.get_roms-299"><span class="linenos">299</span></a>                        <span class="p">]</span>
</span><span id="EmulatorLauncher.get_roms-300"><a href="#EmulatorLauncher.get_roms-300"><span class="linenos">300</span></a>                    <span class="p">)</span>
</span><span id="EmulatorLauncher.get_roms-301"><a href="#EmulatorLauncher.get_roms-301"><span class="linenos">301</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.get_roms-302"><a href="#EmulatorLauncher.get_roms-302"><span class="linenos">302</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Invalid ROM path for </span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher.get_roms-303"><a href="#EmulatorLauncher.get_roms-303"><span class="linenos">303</span></a>        <span class="k">return</span> <span class="n">roms</span>
</span></pre></div>


            <div class="docstring"><p>Retrieves a list of ROMs from the configured paths for each system.</p>

<p>This method iterates through the systems defined in the configuration,
collects ROM file paths from the specified directories, and organizes
them by system.</p>

<p>Returns:
    dict: A dictionary where the keys are system names and the values
          are lists of ROM file paths.</p>

<p>Raises:
    Prints a warning message if a specified ROM path is invalid.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.combine_all_roms" class="classattr">
                                        <input id="EmulatorLauncher.combine_all_roms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">combine_all_roms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">roms</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.combine_all_roms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.combine_all_roms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.combine_all_roms-305"><a href="#EmulatorLauncher.combine_all_roms-305"><span class="linenos">305</span></a>    <span class="k">def</span> <span class="nf">combine_all_roms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roms</span><span class="p">):</span>
</span><span id="EmulatorLauncher.combine_all_roms-306"><a href="#EmulatorLauncher.combine_all_roms-306"><span class="linenos">306</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.combine_all_roms-307"><a href="#EmulatorLauncher.combine_all_roms-307"><span class="linenos">307</span></a><span class="sd">        Combines all ROMs from all systems into a list of (system, rom_path) tuples.</span>
</span><span id="EmulatorLauncher.combine_all_roms-308"><a href="#EmulatorLauncher.combine_all_roms-308"><span class="linenos">308</span></a>
</span><span id="EmulatorLauncher.combine_all_roms-309"><a href="#EmulatorLauncher.combine_all_roms-309"><span class="linenos">309</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher.combine_all_roms-310"><a href="#EmulatorLauncher.combine_all_roms-310"><span class="linenos">310</span></a><span class="sd">            roms (dict): A dictionary where keys are system names and values are lists of ROM paths.</span>
</span><span id="EmulatorLauncher.combine_all_roms-311"><a href="#EmulatorLauncher.combine_all_roms-311"><span class="linenos">311</span></a>
</span><span id="EmulatorLauncher.combine_all_roms-312"><a href="#EmulatorLauncher.combine_all_roms-312"><span class="linenos">312</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher.combine_all_roms-313"><a href="#EmulatorLauncher.combine_all_roms-313"><span class="linenos">313</span></a><span class="sd">            list: A sorted list of tuples, where each tuple contains a system name and a ROM path.</span>
</span><span id="EmulatorLauncher.combine_all_roms-314"><a href="#EmulatorLauncher.combine_all_roms-314"><span class="linenos">314</span></a><span class="sd">                  The list is sorted by the ROM name in a case-insensitive manner.</span>
</span><span id="EmulatorLauncher.combine_all_roms-315"><a href="#EmulatorLauncher.combine_all_roms-315"><span class="linenos">315</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.combine_all_roms-316"><a href="#EmulatorLauncher.combine_all_roms-316"><span class="linenos">316</span></a>        <span class="n">all_roms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher.combine_all_roms-317"><a href="#EmulatorLauncher.combine_all_roms-317"><span class="linenos">317</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">system_roms</span> <span class="ow">in</span> <span class="n">roms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher.combine_all_roms-318"><a href="#EmulatorLauncher.combine_all_roms-318"><span class="linenos">318</span></a>            <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">system_roms</span><span class="p">:</span>
</span><span id="EmulatorLauncher.combine_all_roms-319"><a href="#EmulatorLauncher.combine_all_roms-319"><span class="linenos">319</span></a>                <span class="n">all_roms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">system</span><span class="p">,</span> <span class="n">rom</span><span class="p">))</span>
</span><span id="EmulatorLauncher.combine_all_roms-320"><a href="#EmulatorLauncher.combine_all_roms-320"><span class="linenos">320</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span>
</span><span id="EmulatorLauncher.combine_all_roms-321"><a href="#EmulatorLauncher.combine_all_roms-321"><span class="linenos">321</span></a>            <span class="n">all_roms</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="EmulatorLauncher.combine_all_roms-322"><a href="#EmulatorLauncher.combine_all_roms-322"><span class="linenos">322</span></a>        <span class="p">)</span>  <span class="c1"># Sort by ROM name</span>
</span></pre></div>


            <div class="docstring"><p>Combines all ROMs from all systems into a list of (system, rom_path) tuples.</p>

<p>Args:
    roms (dict): A dictionary where keys are system names and values are lists of ROM paths.</p>

<p>Returns:
    list: A sorted list of tuples, where each tuple contains a system name and a ROM path.
          The list is sorted by the ROM name in a case-insensitive manner.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.format_size" class="classattr">
                                        <input id="EmulatorLauncher.format_size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">format_size</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">size</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.format_size-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.format_size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.format_size-324"><a href="#EmulatorLauncher.format_size-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">format_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
</span><span id="EmulatorLauncher.format_size-325"><a href="#EmulatorLauncher.format_size-325"><span class="linenos">325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.format_size-326"><a href="#EmulatorLauncher.format_size-326"><span class="linenos">326</span></a><span class="sd">        Formats a given size in bytes into a human-readable string with appropriate units.</span>
</span><span id="EmulatorLauncher.format_size-327"><a href="#EmulatorLauncher.format_size-327"><span class="linenos">327</span></a>
</span><span id="EmulatorLauncher.format_size-328"><a href="#EmulatorLauncher.format_size-328"><span class="linenos">328</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher.format_size-329"><a href="#EmulatorLauncher.format_size-329"><span class="linenos">329</span></a><span class="sd">            size (float): The size in bytes to be formatted.</span>
</span><span id="EmulatorLauncher.format_size-330"><a href="#EmulatorLauncher.format_size-330"><span class="linenos">330</span></a>
</span><span id="EmulatorLauncher.format_size-331"><a href="#EmulatorLauncher.format_size-331"><span class="linenos">331</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher.format_size-332"><a href="#EmulatorLauncher.format_size-332"><span class="linenos">332</span></a><span class="sd">            str: The formatted size string with units (B, KB, MB, GB, TB, or PB).</span>
</span><span id="EmulatorLauncher.format_size-333"><a href="#EmulatorLauncher.format_size-333"><span class="linenos">333</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.format_size-334"><a href="#EmulatorLauncher.format_size-334"><span class="linenos">334</span></a>        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;KB&quot;</span><span class="p">,</span> <span class="s2">&quot;MB&quot;</span><span class="p">,</span> <span class="s2">&quot;GB&quot;</span><span class="p">,</span> <span class="s2">&quot;TB&quot;</span><span class="p">]:</span>
</span><span id="EmulatorLauncher.format_size-335"><a href="#EmulatorLauncher.format_size-335"><span class="linenos">335</span></a>            <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
</span><span id="EmulatorLauncher.format_size-336"><a href="#EmulatorLauncher.format_size-336"><span class="linenos">336</span></a>                <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.format_size-337"><a href="#EmulatorLauncher.format_size-337"><span class="linenos">337</span></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="si">}{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher.format_size-338"><a href="#EmulatorLauncher.format_size-338"><span class="linenos">338</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.format_size-339"><a href="#EmulatorLauncher.format_size-339"><span class="linenos">339</span></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher.format_size-340"><a href="#EmulatorLauncher.format_size-340"><span class="linenos">340</span></a>            <span class="n">size</span> <span class="o">/=</span> <span class="mi">1024</span>
</span><span id="EmulatorLauncher.format_size-341"><a href="#EmulatorLauncher.format_size-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">PB&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Formats a given size in bytes into a human-readable string with appropriate units.</p>

<p>Args:
    size (float): The size in bytes to be formatted.</p>

<p>Returns:
    str: The formatted size string with units (B, KB, MB, GB, TB, or PB).</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.draw_system_window" class="classattr">
                                        <input id="EmulatorLauncher.draw_system_window-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_system_window</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.draw_system_window-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.draw_system_window"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.draw_system_window-343"><a href="#EmulatorLauncher.draw_system_window-343"><span class="linenos">343</span></a>    <span class="k">def</span> <span class="nf">draw_system_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.draw_system_window-344"><a href="#EmulatorLauncher.draw_system_window-344"><span class="linenos">344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.draw_system_window-345"><a href="#EmulatorLauncher.draw_system_window-345"><span class="linenos">345</span></a><span class="sd">        Draws the system selection window with enhanced visuals.</span>
</span><span id="EmulatorLauncher.draw_system_window-346"><a href="#EmulatorLauncher.draw_system_window-346"><span class="linenos">346</span></a><span class="sd">        This method clears the current system window and redraws it with updated</span>
</span><span id="EmulatorLauncher.draw_system_window-347"><a href="#EmulatorLauncher.draw_system_window-347"><span class="linenos">347</span></a><span class="sd">        information, including the number of favorite ROMs, all ROMs, and ROMs</span>
</span><span id="EmulatorLauncher.draw_system_window-348"><a href="#EmulatorLauncher.draw_system_window-348"><span class="linenos">348</span></a><span class="sd">        categorized by system. It highlights the currently selected view mode</span>
</span><span id="EmulatorLauncher.draw_system_window-349"><a href="#EmulatorLauncher.draw_system_window-349"><span class="linenos">349</span></a><span class="sd">        and system, if applicable.</span>
</span><span id="EmulatorLauncher.draw_system_window-350"><a href="#EmulatorLauncher.draw_system_window-350"><span class="linenos">350</span></a><span class="sd">        The window includes:</span>
</span><span id="EmulatorLauncher.draw_system_window-351"><a href="#EmulatorLauncher.draw_system_window-351"><span class="linenos">351</span></a><span class="sd">        - A favorites section with a count of favorite ROMs.</span>
</span><span id="EmulatorLauncher.draw_system_window-352"><a href="#EmulatorLauncher.draw_system_window-352"><span class="linenos">352</span></a><span class="sd">        - An &quot;All&quot; section with a count of all available ROMs.</span>
</span><span id="EmulatorLauncher.draw_system_window-353"><a href="#EmulatorLauncher.draw_system_window-353"><span class="linenos">353</span></a><span class="sd">        - A separator line for visual clarity.</span>
</span><span id="EmulatorLauncher.draw_system_window-354"><a href="#EmulatorLauncher.draw_system_window-354"><span class="linenos">354</span></a><span class="sd">        - A list of systems with their respective ROM counts.</span>
</span><span id="EmulatorLauncher.draw_system_window-355"><a href="#EmulatorLauncher.draw_system_window-355"><span class="linenos">355</span></a><span class="sd">        The visual elements are styled using curses color pairs to indicate</span>
</span><span id="EmulatorLauncher.draw_system_window-356"><a href="#EmulatorLauncher.draw_system_window-356"><span class="linenos">356</span></a><span class="sd">        selection and different categories.</span>
</span><span id="EmulatorLauncher.draw_system_window-357"><a href="#EmulatorLauncher.draw_system_window-357"><span class="linenos">357</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher.draw_system_window-358"><a href="#EmulatorLauncher.draw_system_window-358"><span class="linenos">358</span></a><span class="sd">            self.system_window (curses.window): The window object where the system</span>
</span><span id="EmulatorLauncher.draw_system_window-359"><a href="#EmulatorLauncher.draw_system_window-359"><span class="linenos">359</span></a><span class="sd">                selection is drawn.</span>
</span><span id="EmulatorLauncher.draw_system_window-360"><a href="#EmulatorLauncher.draw_system_window-360"><span class="linenos">360</span></a><span class="sd">            self.view_mode (str): The current view mode, which can be &quot;favorites&quot;,</span>
</span><span id="EmulatorLauncher.draw_system_window-361"><a href="#EmulatorLauncher.draw_system_window-361"><span class="linenos">361</span></a><span class="sd">                &quot;all&quot;, or &quot;systems&quot;.</span>
</span><span id="EmulatorLauncher.draw_system_window-362"><a href="#EmulatorLauncher.draw_system_window-362"><span class="linenos">362</span></a><span class="sd">            self.favorites (dict): A dictionary containing favorite ROMs categorized</span>
</span><span id="EmulatorLauncher.draw_system_window-363"><a href="#EmulatorLauncher.draw_system_window-363"><span class="linenos">363</span></a><span class="sd">                by system.</span>
</span><span id="EmulatorLauncher.draw_system_window-364"><a href="#EmulatorLauncher.draw_system_window-364"><span class="linenos">364</span></a><span class="sd">            self.all_roms (list): A list of all available ROMs.</span>
</span><span id="EmulatorLauncher.draw_system_window-365"><a href="#EmulatorLauncher.draw_system_window-365"><span class="linenos">365</span></a><span class="sd">            self.roms (dict): A dictionary containing ROMs categorized by system.</span>
</span><span id="EmulatorLauncher.draw_system_window-366"><a href="#EmulatorLauncher.draw_system_window-366"><span class="linenos">366</span></a><span class="sd">            self.selected_system (int): The index of the currently selected system</span>
</span><span id="EmulatorLauncher.draw_system_window-367"><a href="#EmulatorLauncher.draw_system_window-367"><span class="linenos">367</span></a><span class="sd">                in the systems list.</span>
</span><span id="EmulatorLauncher.draw_system_window-368"><a href="#EmulatorLauncher.draw_system_window-368"><span class="linenos">368</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.draw_system_window-369"><a href="#EmulatorLauncher.draw_system_window-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="EmulatorLauncher.draw_system_window-370"><a href="#EmulatorLauncher.draw_system_window-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_borders</span><span class="p">()</span>
</span><span id="EmulatorLauncher.draw_system_window-371"><a href="#EmulatorLauncher.draw_system_window-371"><span class="linenos">371</span></a>        <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>  <span class="c1"># Start below the border</span>
</span><span id="EmulatorLauncher.draw_system_window-372"><a href="#EmulatorLauncher.draw_system_window-372"><span class="linenos">372</span></a>
</span><span id="EmulatorLauncher.draw_system_window-373"><a href="#EmulatorLauncher.draw_system_window-373"><span class="linenos">373</span></a>        <span class="c1"># Favorites view with icon</span>
</span><span id="EmulatorLauncher.draw_system_window-374"><a href="#EmulatorLauncher.draw_system_window-374"><span class="linenos">374</span></a>        <span class="n">favorites_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">roms</span><span class="p">)</span> <span class="k">for</span> <span class="n">roms</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="EmulatorLauncher.draw_system_window-375"><a href="#EmulatorLauncher.draw_system_window-375"><span class="linenos">375</span></a>        <span class="n">fav_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; Favorites (</span><span class="si">{</span><span class="n">favorites_count</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="EmulatorLauncher.draw_system_window-376"><a href="#EmulatorLauncher.draw_system_window-376"><span class="linenos">376</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_system_window-377"><a href="#EmulatorLauncher.draw_system_window-377"><span class="linenos">377</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher.draw_system_window-378"><a href="#EmulatorLauncher.draw_system_window-378"><span class="linenos">378</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fav_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-379"><a href="#EmulatorLauncher.draw_system_window-379"><span class="linenos">379</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-380"><a href="#EmulatorLauncher.draw_system_window-380"><span class="linenos">380</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_system_window-381"><a href="#EmulatorLauncher.draw_system_window-381"><span class="linenos">381</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher.draw_system_window-382"><a href="#EmulatorLauncher.draw_system_window-382"><span class="linenos">382</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fav_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">FAVORITE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-383"><a href="#EmulatorLauncher.draw_system_window-383"><span class="linenos">383</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-384"><a href="#EmulatorLauncher.draw_system_window-384"><span class="linenos">384</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.draw_system_window-385"><a href="#EmulatorLauncher.draw_system_window-385"><span class="linenos">385</span></a>
</span><span id="EmulatorLauncher.draw_system_window-386"><a href="#EmulatorLauncher.draw_system_window-386"><span class="linenos">386</span></a>        <span class="c1"># ALL category with icon</span>
</span><span id="EmulatorLauncher.draw_system_window-387"><a href="#EmulatorLauncher.draw_system_window-387"><span class="linenos">387</span></a>        <span class="n">all_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; All (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="EmulatorLauncher.draw_system_window-388"><a href="#EmulatorLauncher.draw_system_window-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_system_window-389"><a href="#EmulatorLauncher.draw_system_window-389"><span class="linenos">389</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher.draw_system_window-390"><a href="#EmulatorLauncher.draw_system_window-390"><span class="linenos">390</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">all_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-391"><a href="#EmulatorLauncher.draw_system_window-391"><span class="linenos">391</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-392"><a href="#EmulatorLauncher.draw_system_window-392"><span class="linenos">392</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_system_window-393"><a href="#EmulatorLauncher.draw_system_window-393"><span class="linenos">393</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher.draw_system_window-394"><a href="#EmulatorLauncher.draw_system_window-394"><span class="linenos">394</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">all_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-395"><a href="#EmulatorLauncher.draw_system_window-395"><span class="linenos">395</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-396"><a href="#EmulatorLauncher.draw_system_window-396"><span class="linenos">396</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.draw_system_window-397"><a href="#EmulatorLauncher.draw_system_window-397"><span class="linenos">397</span></a>
</span><span id="EmulatorLauncher.draw_system_window-398"><a href="#EmulatorLauncher.draw_system_window-398"><span class="linenos">398</span></a>        <span class="c1"># Separator with nice pattern</span>
</span><span id="EmulatorLauncher.draw_system_window-399"><a href="#EmulatorLauncher.draw_system_window-399"><span class="linenos">399</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="EmulatorLauncher.draw_system_window-400"><a href="#EmulatorLauncher.draw_system_window-400"><span class="linenos">400</span></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.draw_system_window-401"><a href="#EmulatorLauncher.draw_system_window-401"><span class="linenos">401</span></a>
</span><span id="EmulatorLauncher.draw_system_window-402"><a href="#EmulatorLauncher.draw_system_window-402"><span class="linenos">402</span></a>        <span class="c1"># Systems with ROM counts and icons</span>
</span><span id="EmulatorLauncher.draw_system_window-403"><a href="#EmulatorLauncher.draw_system_window-403"><span class="linenos">403</span></a>        <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="EmulatorLauncher.draw_system_window-404"><a href="#EmulatorLauncher.draw_system_window-404"><span class="linenos">404</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">system</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">systems</span><span class="p">):</span>
</span><span id="EmulatorLauncher.draw_system_window-405"><a href="#EmulatorLauncher.draw_system_window-405"><span class="linenos">405</span></a>            <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="p">[</span><span class="n">system</span><span class="p">])</span>
</span><span id="EmulatorLauncher.draw_system_window-406"><a href="#EmulatorLauncher.draw_system_window-406"><span class="linenos">406</span></a>            <span class="n">system_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="EmulatorLauncher.draw_system_window-407"><a href="#EmulatorLauncher.draw_system_window-407"><span class="linenos">407</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_system_window-408"><a href="#EmulatorLauncher.draw_system_window-408"><span class="linenos">408</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher.draw_system_window-409"><a href="#EmulatorLauncher.draw_system_window-409"><span class="linenos">409</span></a>                    <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">system_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-410"><a href="#EmulatorLauncher.draw_system_window-410"><span class="linenos">410</span></a>                <span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-411"><a href="#EmulatorLauncher.draw_system_window-411"><span class="linenos">411</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_system_window-412"><a href="#EmulatorLauncher.draw_system_window-412"><span class="linenos">412</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span>
</span><span id="EmulatorLauncher.draw_system_window-413"><a href="#EmulatorLauncher.draw_system_window-413"><span class="linenos">413</span></a>                    <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">system_text</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-414"><a href="#EmulatorLauncher.draw_system_window-414"><span class="linenos">414</span></a>                <span class="p">)</span>
</span><span id="EmulatorLauncher.draw_system_window-415"><a href="#EmulatorLauncher.draw_system_window-415"><span class="linenos">415</span></a>            <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.draw_system_window-416"><a href="#EmulatorLauncher.draw_system_window-416"><span class="linenos">416</span></a>
</span><span id="EmulatorLauncher.draw_system_window-417"><a href="#EmulatorLauncher.draw_system_window-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Draws the system selection window with enhanced visuals.
This method clears the current system window and redraws it with updated
information, including the number of favorite ROMs, all ROMs, and ROMs
categorized by system. It highlights the currently selected view mode
and system, if applicable.
The window includes:</p>

<ul>
<li>A favorites section with a count of favorite ROMs.</li>
<li>An "All" section with a count of all available ROMs.</li>
<li>A separator line for visual clarity.</li>
<li>A list of systems with their respective ROM counts.
The visual elements are styled using curses color pairs to indicate
selection and different categories.
Attributes:
self.system_window (curses.window): The window object where the system
    selection is drawn.
self.view_mode (str): The current view mode, which can be "favorites",
    "all", or "systems".
self.favorites (dict): A dictionary containing favorite ROMs categorized
    by system.
self.all_roms (list): A list of all available ROMs.
self.roms (dict): A dictionary containing ROMs categorized by system.
self.selected_system (int): The index of the currently selected system
    in the systems list.</li>
</ul>
</div>


                            </div>
                            <div id="EmulatorLauncher.draw_rom_window" class="classattr">
                                        <input id="EmulatorLauncher.draw_rom_window-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_rom_window</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.draw_rom_window-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.draw_rom_window"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.draw_rom_window-419"><a href="#EmulatorLauncher.draw_rom_window-419"><span class="linenos">419</span></a>    <span class="k">def</span> <span class="nf">draw_rom_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.draw_rom_window-420"><a href="#EmulatorLauncher.draw_rom_window-420"><span class="linenos">420</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.draw_rom_window-421"><a href="#EmulatorLauncher.draw_rom_window-421"><span class="linenos">421</span></a><span class="sd">        Draws the ROM selection window with borders, ROM entries, and additional information.</span>
</span><span id="EmulatorLauncher.draw_rom_window-422"><a href="#EmulatorLauncher.draw_rom_window-422"><span class="linenos">422</span></a><span class="sd">        This method clears the current ROM window, draws borders, and populates the window</span>
</span><span id="EmulatorLauncher.draw_rom_window-423"><a href="#EmulatorLauncher.draw_rom_window-423"><span class="linenos">423</span></a><span class="sd">        with a list of ROMs based on the current view mode (systems, all, or favorites).</span>
</span><span id="EmulatorLauncher.draw_rom_window-424"><a href="#EmulatorLauncher.draw_rom_window-424"><span class="linenos">424</span></a><span class="sd">        It handles scrolling, selection highlighting, and displays ROM names along with their</span>
</span><span id="EmulatorLauncher.draw_rom_window-425"><a href="#EmulatorLauncher.draw_rom_window-425"><span class="linenos">425</span></a><span class="sd">        sizes. If a ROM is marked as a favorite, it adds a star icon next to its name.</span>
</span><span id="EmulatorLauncher.draw_rom_window-426"><a href="#EmulatorLauncher.draw_rom_window-426"><span class="linenos">426</span></a><span class="sd">        The method also manages scrolling for long ROM names when they are selected and ensures</span>
</span><span id="EmulatorLauncher.draw_rom_window-427"><a href="#EmulatorLauncher.draw_rom_window-427"><span class="linenos">427</span></a><span class="sd">        that the display is updated accordingly.</span>
</span><span id="EmulatorLauncher.draw_rom_window-428"><a href="#EmulatorLauncher.draw_rom_window-428"><span class="linenos">428</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher.draw_rom_window-429"><a href="#EmulatorLauncher.draw_rom_window-429"><span class="linenos">429</span></a><span class="sd">            self.rom_window (curses.window): The window object where ROMs are displayed.</span>
</span><span id="EmulatorLauncher.draw_rom_window-430"><a href="#EmulatorLauncher.draw_rom_window-430"><span class="linenos">430</span></a><span class="sd">            self.view_mode (str): The current view mode (&quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;).</span>
</span><span id="EmulatorLauncher.draw_rom_window-431"><a href="#EmulatorLauncher.draw_rom_window-431"><span class="linenos">431</span></a><span class="sd">            self.roms (dict): Dictionary containing ROMs categorized by systems.</span>
</span><span id="EmulatorLauncher.draw_rom_window-432"><a href="#EmulatorLauncher.draw_rom_window-432"><span class="linenos">432</span></a><span class="sd">            self.filtered_roms (dict): Dictionary containing filtered ROMs based on the view mode.</span>
</span><span id="EmulatorLauncher.draw_rom_window-433"><a href="#EmulatorLauncher.draw_rom_window-433"><span class="linenos">433</span></a><span class="sd">            self.selected_system (int): Index of the currently selected system.</span>
</span><span id="EmulatorLauncher.draw_rom_window-434"><a href="#EmulatorLauncher.draw_rom_window-434"><span class="linenos">434</span></a><span class="sd">            self.selected_rom (int): Index of the currently selected ROM.</span>
</span><span id="EmulatorLauncher.draw_rom_window-435"><a href="#EmulatorLauncher.draw_rom_window-435"><span class="linenos">435</span></a><span class="sd">            self.total_roms (int): Total number of ROMs in the current view.</span>
</span><span id="EmulatorLauncher.draw_rom_window-436"><a href="#EmulatorLauncher.draw_rom_window-436"><span class="linenos">436</span></a><span class="sd">            self.current_rom_index (int): Index of the currently selected ROM (1-based).</span>
</span><span id="EmulatorLauncher.draw_rom_window-437"><a href="#EmulatorLauncher.draw_rom_window-437"><span class="linenos">437</span></a><span class="sd">            self.focus (str): The current focus of the application (&quot;roms&quot; or other).</span>
</span><span id="EmulatorLauncher.draw_rom_window-438"><a href="#EmulatorLauncher.draw_rom_window-438"><span class="linenos">438</span></a><span class="sd">            self.last_selection_change_time (float): Timestamp of the last selection change.</span>
</span><span id="EmulatorLauncher.draw_rom_window-439"><a href="#EmulatorLauncher.draw_rom_window-439"><span class="linenos">439</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher.draw_rom_window-440"><a href="#EmulatorLauncher.draw_rom_window-440"><span class="linenos">440</span></a><span class="sd">            Exception: If there is an error retrieving the file size of a ROM.</span>
</span><span id="EmulatorLauncher.draw_rom_window-441"><a href="#EmulatorLauncher.draw_rom_window-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.draw_rom_window-442"><a href="#EmulatorLauncher.draw_rom_window-442"><span class="linenos">442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="EmulatorLauncher.draw_rom_window-443"><a href="#EmulatorLauncher.draw_rom_window-443"><span class="linenos">443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_borders</span><span class="p">()</span>
</span><span id="EmulatorLauncher.draw_rom_window-444"><a href="#EmulatorLauncher.draw_rom_window-444"><span class="linenos">444</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-445"><a href="#EmulatorLauncher.draw_rom_window-445"><span class="linenos">445</span></a>        <span class="n">rom_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher.draw_rom_window-446"><a href="#EmulatorLauncher.draw_rom_window-446"><span class="linenos">446</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-447"><a href="#EmulatorLauncher.draw_rom_window-447"><span class="linenos">447</span></a>            <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="EmulatorLauncher.draw_rom_window-448"><a href="#EmulatorLauncher.draw_rom_window-448"><span class="linenos">448</span></a>            <span class="k">if</span> <span class="n">systems</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-449"><a href="#EmulatorLauncher.draw_rom_window-449"><span class="linenos">449</span></a>                <span class="n">selected_system_name</span> <span class="o">=</span> <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="EmulatorLauncher.draw_rom_window-450"><a href="#EmulatorLauncher.draw_rom_window-450"><span class="linenos">450</span></a>                <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_system_name</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.draw_rom_window-451"><a href="#EmulatorLauncher.draw_rom_window-451"><span class="linenos">451</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-452"><a href="#EmulatorLauncher.draw_rom_window-452"><span class="linenos">452</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.draw_rom_window-453"><a href="#EmulatorLauncher.draw_rom_window-453"><span class="linenos">453</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-454"><a href="#EmulatorLauncher.draw_rom_window-454"><span class="linenos">454</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.draw_rom_window-455"><a href="#EmulatorLauncher.draw_rom_window-455"><span class="linenos">455</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-456"><a href="#EmulatorLauncher.draw_rom_window-456"><span class="linenos">456</span></a>        <span class="n">viewable_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Account for borders</span>
</span><span id="EmulatorLauncher.draw_rom_window-457"><a href="#EmulatorLauncher.draw_rom_window-457"><span class="linenos">457</span></a>        <span class="n">num_roms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_list</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-458"><a href="#EmulatorLauncher.draw_rom_window-458"><span class="linenos">458</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-459"><a href="#EmulatorLauncher.draw_rom_window-459"><span class="linenos">459</span></a>        <span class="c1"># Update counters</span>
</span><span id="EmulatorLauncher.draw_rom_window-460"><a href="#EmulatorLauncher.draw_rom_window-460"><span class="linenos">460</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span> <span class="o">=</span> <span class="n">num_roms</span>
</span><span id="EmulatorLauncher.draw_rom_window-461"><a href="#EmulatorLauncher.draw_rom_window-461"><span class="linenos">461</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_rom_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">num_roms</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.draw_rom_window-462"><a href="#EmulatorLauncher.draw_rom_window-462"><span class="linenos">462</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-463"><a href="#EmulatorLauncher.draw_rom_window-463"><span class="linenos">463</span></a>        <span class="c1"># Calculate scrolling</span>
</span><span id="EmulatorLauncher.draw_rom_window-464"><a href="#EmulatorLauncher.draw_rom_window-464"><span class="linenos">464</span></a>        <span class="k">if</span> <span class="n">num_roms</span> <span class="o">&lt;=</span> <span class="n">viewable_height</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-465"><a href="#EmulatorLauncher.draw_rom_window-465"><span class="linenos">465</span></a>            <span class="n">top_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.draw_rom_window-466"><a href="#EmulatorLauncher.draw_rom_window-466"><span class="linenos">466</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-467"><a href="#EmulatorLauncher.draw_rom_window-467"><span class="linenos">467</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-468"><a href="#EmulatorLauncher.draw_rom_window-468"><span class="linenos">468</span></a>                <span class="n">top_index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.draw_rom_window-469"><a href="#EmulatorLauncher.draw_rom_window-469"><span class="linenos">469</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-470"><a href="#EmulatorLauncher.draw_rom_window-470"><span class="linenos">470</span></a>                <span class="n">top_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">-</span> <span class="p">(</span><span class="n">viewable_height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-471"><a href="#EmulatorLauncher.draw_rom_window-471"><span class="linenos">471</span></a>            <span class="n">top_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">top_index</span><span class="p">,</span> <span class="n">num_roms</span> <span class="o">-</span> <span class="n">viewable_height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="EmulatorLauncher.draw_rom_window-472"><a href="#EmulatorLauncher.draw_rom_window-472"><span class="linenos">472</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-473"><a href="#EmulatorLauncher.draw_rom_window-473"><span class="linenos">473</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rom_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rom_list</span><span class="p">[</span><span class="n">top_index</span> <span class="p">:</span> <span class="n">top_index</span> <span class="o">+</span> <span class="n">viewable_height</span><span class="p">]):</span>
</span><span id="EmulatorLauncher.draw_rom_window-474"><a href="#EmulatorLauncher.draw_rom_window-474"><span class="linenos">474</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># Start below the border</span>
</span><span id="EmulatorLauncher.draw_rom_window-475"><a href="#EmulatorLauncher.draw_rom_window-475"><span class="linenos">475</span></a>            <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">viewable_height</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-476"><a href="#EmulatorLauncher.draw_rom_window-476"><span class="linenos">476</span></a>                <span class="k">break</span>
</span><span id="EmulatorLauncher.draw_rom_window-477"><a href="#EmulatorLauncher.draw_rom_window-477"><span class="linenos">477</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-478"><a href="#EmulatorLauncher.draw_rom_window-478"><span class="linenos">478</span></a>            <span class="c1"># Determine ROM display information</span>
</span><span id="EmulatorLauncher.draw_rom_window-479"><a href="#EmulatorLauncher.draw_rom_window-479"><span class="linenos">479</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]:</span>
</span><span id="EmulatorLauncher.draw_rom_window-480"><a href="#EmulatorLauncher.draw_rom_window-480"><span class="linenos">480</span></a>                <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="EmulatorLauncher.draw_rom_window-481"><a href="#EmulatorLauncher.draw_rom_window-481"><span class="linenos">481</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher.draw_rom_window-482"><a href="#EmulatorLauncher.draw_rom_window-482"><span class="linenos">482</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-483"><a href="#EmulatorLauncher.draw_rom_window-483"><span class="linenos">483</span></a>                <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="EmulatorLauncher.draw_rom_window-484"><a href="#EmulatorLauncher.draw_rom_window-484"><span class="linenos">484</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-485"><a href="#EmulatorLauncher.draw_rom_window-485"><span class="linenos">485</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-486"><a href="#EmulatorLauncher.draw_rom_window-486"><span class="linenos">486</span></a>            <span class="c1"># Add favorite star if needed</span>
</span><span id="EmulatorLauncher.draw_rom_window-487"><a href="#EmulatorLauncher.draw_rom_window-487"><span class="linenos">487</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_favorite</span><span class="p">(</span><span class="n">rom_path</span><span class="p">):</span>
</span><span id="EmulatorLauncher.draw_rom_window-488"><a href="#EmulatorLauncher.draw_rom_window-488"><span class="linenos">488</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">rom_name</span>
</span><span id="EmulatorLauncher.draw_rom_window-489"><a href="#EmulatorLauncher.draw_rom_window-489"><span class="linenos">489</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-490"><a href="#EmulatorLauncher.draw_rom_window-490"><span class="linenos">490</span></a>                <span class="n">rom_name</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">rom_name</span>
</span><span id="EmulatorLauncher.draw_rom_window-491"><a href="#EmulatorLauncher.draw_rom_window-491"><span class="linenos">491</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-492"><a href="#EmulatorLauncher.draw_rom_window-492"><span class="linenos">492</span></a>            <span class="c1"># Get file size</span>
</span><span id="EmulatorLauncher.draw_rom_window-493"><a href="#EmulatorLauncher.draw_rom_window-493"><span class="linenos">493</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-494"><a href="#EmulatorLauncher.draw_rom_window-494"><span class="linenos">494</span></a>                <span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-495"><a href="#EmulatorLauncher.draw_rom_window-495"><span class="linenos">495</span></a>                <span class="n">file_size_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_size</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-496"><a href="#EmulatorLauncher.draw_rom_window-496"><span class="linenos">496</span></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-497"><a href="#EmulatorLauncher.draw_rom_window-497"><span class="linenos">497</span></a>                <span class="n">file_size_str</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
</span><span id="EmulatorLauncher.draw_rom_window-498"><a href="#EmulatorLauncher.draw_rom_window-498"><span class="linenos">498</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-499"><a href="#EmulatorLauncher.draw_rom_window-499"><span class="linenos">499</span></a>            <span class="c1"># Calculate display positions</span>
</span><span id="EmulatorLauncher.draw_rom_window-500"><a href="#EmulatorLauncher.draw_rom_window-500"><span class="linenos">500</span></a>            <span class="n">win_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="EmulatorLauncher.draw_rom_window-501"><a href="#EmulatorLauncher.draw_rom_window-501"><span class="linenos">501</span></a>            <span class="n">size_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_size_str</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="EmulatorLauncher.draw_rom_window-502"><a href="#EmulatorLauncher.draw_rom_window-502"><span class="linenos">502</span></a>            <span class="n">name_width</span> <span class="o">=</span> <span class="n">win_width</span> <span class="o">-</span> <span class="n">size_width</span> <span class="o">-</span> <span class="mi">2</span>
</span><span id="EmulatorLauncher.draw_rom_window-503"><a href="#EmulatorLauncher.draw_rom_window-503"><span class="linenos">503</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-504"><a href="#EmulatorLauncher.draw_rom_window-504"><span class="linenos">504</span></a>            <span class="c1"># Determine display attributes</span>
</span><span id="EmulatorLauncher.draw_rom_window-505"><a href="#EmulatorLauncher.draw_rom_window-505"><span class="linenos">505</span></a>            <span class="n">is_selected</span> <span class="o">=</span> <span class="p">(</span><span class="n">top_index</span> <span class="o">+</span> <span class="n">i</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.draw_rom_window-506"><a href="#EmulatorLauncher.draw_rom_window-506"><span class="linenos">506</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span>
</span><span id="EmulatorLauncher.draw_rom_window-507"><a href="#EmulatorLauncher.draw_rom_window-507"><span class="linenos">507</span></a>            <span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-508"><a href="#EmulatorLauncher.draw_rom_window-508"><span class="linenos">508</span></a>            <span class="k">if</span> <span class="n">is_selected</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-509"><a href="#EmulatorLauncher.draw_rom_window-509"><span class="linenos">509</span></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">SELECTED</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-510"><a href="#EmulatorLauncher.draw_rom_window-510"><span class="linenos">510</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_favorite</span><span class="p">(</span><span class="n">rom_path</span><span class="p">):</span>
</span><span id="EmulatorLauncher.draw_rom_window-511"><a href="#EmulatorLauncher.draw_rom_window-511"><span class="linenos">511</span></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">FAVORITE</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-512"><a href="#EmulatorLauncher.draw_rom_window-512"><span class="linenos">512</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-513"><a href="#EmulatorLauncher.draw_rom_window-513"><span class="linenos">513</span></a>                <span class="n">attr</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">NORMAL</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-514"><a href="#EmulatorLauncher.draw_rom_window-514"><span class="linenos">514</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-515"><a href="#EmulatorLauncher.draw_rom_window-515"><span class="linenos">515</span></a>            <span class="c1"># Handle scrolling for long names</span>
</span><span id="EmulatorLauncher.draw_rom_window-516"><a href="#EmulatorLauncher.draw_rom_window-516"><span class="linenos">516</span></a>            <span class="k">if</span> <span class="n">is_selected</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">name_width</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-517"><a href="#EmulatorLauncher.draw_rom_window-517"><span class="linenos">517</span></a>                <span class="n">scroll_speed</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="EmulatorLauncher.draw_rom_window-518"><a href="#EmulatorLauncher.draw_rom_window-518"><span class="linenos">518</span></a>                <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="EmulatorLauncher.draw_rom_window-519"><a href="#EmulatorLauncher.draw_rom_window-519"><span class="linenos">519</span></a>                <span class="n">time_since_selection</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_selection_change_time</span>
</span><span id="EmulatorLauncher.draw_rom_window-520"><a href="#EmulatorLauncher.draw_rom_window-520"><span class="linenos">520</span></a>                <span class="n">scroll_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_since_selection</span> <span class="o">*</span> <span class="n">scroll_speed</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-521"><a href="#EmulatorLauncher.draw_rom_window-521"><span class="linenos">521</span></a>                <span class="n">scroll_offset</span> <span class="o">=</span> <span class="n">scroll_offset</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rom_name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-522"><a href="#EmulatorLauncher.draw_rom_window-522"><span class="linenos">522</span></a>                <span class="n">display_name</span> <span class="o">=</span> <span class="n">rom_name</span> <span class="o">+</span> <span class="s2">&quot;     &quot;</span> <span class="o">+</span> <span class="n">rom_name</span>
</span><span id="EmulatorLauncher.draw_rom_window-523"><a href="#EmulatorLauncher.draw_rom_window-523"><span class="linenos">523</span></a>                <span class="n">display_name</span> <span class="o">=</span> <span class="n">display_name</span><span class="p">[</span><span class="n">scroll_offset</span> <span class="p">:</span> <span class="n">scroll_offset</span> <span class="o">+</span> <span class="n">name_width</span><span class="p">]</span>
</span><span id="EmulatorLauncher.draw_rom_window-524"><a href="#EmulatorLauncher.draw_rom_window-524"><span class="linenos">524</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_rom_window-525"><a href="#EmulatorLauncher.draw_rom_window-525"><span class="linenos">525</span></a>                <span class="n">display_name</span> <span class="o">=</span> <span class="n">rom_name</span><span class="p">[:</span><span class="n">name_width</span><span class="p">]</span>
</span><span id="EmulatorLauncher.draw_rom_window-526"><a href="#EmulatorLauncher.draw_rom_window-526"><span class="linenos">526</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-527"><a href="#EmulatorLauncher.draw_rom_window-527"><span class="linenos">527</span></a>            <span class="c1"># Draw the ROM entry</span>
</span><span id="EmulatorLauncher.draw_rom_window-528"><a href="#EmulatorLauncher.draw_rom_window-528"><span class="linenos">528</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">display_name</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">name_width</span><span class="p">),</span> <span class="n">attr</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-529"><a href="#EmulatorLauncher.draw_rom_window-529"><span class="linenos">529</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">name_width</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">file_size_str</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_rom_window-530"><a href="#EmulatorLauncher.draw_rom_window-530"><span class="linenos">530</span></a>
</span><span id="EmulatorLauncher.draw_rom_window-531"><a href="#EmulatorLauncher.draw_rom_window-531"><span class="linenos">531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Draws the ROM selection window with borders, ROM entries, and additional information.
This method clears the current ROM window, draws borders, and populates the window
with a list of ROMs based on the current view mode (systems, all, or favorites).
It handles scrolling, selection highlighting, and displays ROM names along with their
sizes. If a ROM is marked as a favorite, it adds a star icon next to its name.
The method also manages scrolling for long ROM names when they are selected and ensures
that the display is updated accordingly.
Attributes:
    self.rom_window (curses.window): The window object where ROMs are displayed.
    self.view_mode (str): The current view mode ("systems", "all", or "favorites").
    self.roms (dict): Dictionary containing ROMs categorized by systems.
    self.filtered_roms (dict): Dictionary containing filtered ROMs based on the view mode.
    self.selected_system (int): Index of the currently selected system.
    self.selected_rom (int): Index of the currently selected ROM.
    self.total_roms (int): Total number of ROMs in the current view.
    self.current_rom_index (int): Index of the currently selected ROM (1-based).
    self.focus (str): The current focus of the application ("roms" or other).
    self.last_selection_change_time (float): Timestamp of the last selection change.
Raises:
    Exception: If there is an error retrieving the file size of a ROM.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.launch_rom" class="classattr">
                                        <input id="EmulatorLauncher.launch_rom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">launch_rom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">emulator_path</span>, </span><span class="param"><span class="n">launch_arguments</span>, </span><span class="param"><span class="n">rom_path</span>, </span><span class="param"><span class="n">start_in_directory</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.launch_rom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.launch_rom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.launch_rom-533"><a href="#EmulatorLauncher.launch_rom-533"><span class="linenos">533</span></a>    <span class="k">def</span> <span class="nf">launch_rom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emulator_path</span><span class="p">,</span> <span class="n">launch_arguments</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">,</span> <span class="n">start_in_directory</span><span class="p">):</span>
</span><span id="EmulatorLauncher.launch_rom-534"><a href="#EmulatorLauncher.launch_rom-534"><span class="linenos">534</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.launch_rom-535"><a href="#EmulatorLauncher.launch_rom-535"><span class="linenos">535</span></a><span class="sd">        Launches a ROM using the specified emulator and arguments.</span>
</span><span id="EmulatorLauncher.launch_rom-536"><a href="#EmulatorLauncher.launch_rom-536"><span class="linenos">536</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher.launch_rom-537"><a href="#EmulatorLauncher.launch_rom-537"><span class="linenos">537</span></a><span class="sd">            emulator_path (str): The file path to the emulator executable.</span>
</span><span id="EmulatorLauncher.launch_rom-538"><a href="#EmulatorLauncher.launch_rom-538"><span class="linenos">538</span></a><span class="sd">            launch_arguments (str): The arguments to pass to the emulator. Use &quot;{rom_path}&quot; as a placeholder for the ROM path.</span>
</span><span id="EmulatorLauncher.launch_rom-539"><a href="#EmulatorLauncher.launch_rom-539"><span class="linenos">539</span></a><span class="sd">            rom_path (str): The file path to the ROM to be launched.</span>
</span><span id="EmulatorLauncher.launch_rom-540"><a href="#EmulatorLauncher.launch_rom-540"><span class="linenos">540</span></a><span class="sd">            start_in_directory (str): The directory to set as the working directory when launching the emulator.</span>
</span><span id="EmulatorLauncher.launch_rom-541"><a href="#EmulatorLauncher.launch_rom-541"><span class="linenos">541</span></a><span class="sd">        Raises:</span>
</span><span id="EmulatorLauncher.launch_rom-542"><a href="#EmulatorLauncher.launch_rom-542"><span class="linenos">542</span></a><span class="sd">            subprocess.CalledProcessError: If there is an error launching the emulator.</span>
</span><span id="EmulatorLauncher.launch_rom-543"><a href="#EmulatorLauncher.launch_rom-543"><span class="linenos">543</span></a><span class="sd">            FileNotFoundError: If the emulator executable is not found at the specified path.</span>
</span><span id="EmulatorLauncher.launch_rom-544"><a href="#EmulatorLauncher.launch_rom-544"><span class="linenos">544</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.launch_rom-545"><a href="#EmulatorLauncher.launch_rom-545"><span class="linenos">545</span></a>        <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="n">emulator_path</span><span class="p">]</span>
</span><span id="EmulatorLauncher.launch_rom-546"><a href="#EmulatorLauncher.launch_rom-546"><span class="linenos">546</span></a>        <span class="k">if</span> <span class="n">launch_arguments</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_rom-547"><a href="#EmulatorLauncher.launch_rom-547"><span class="linenos">547</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="n">launch_arguments</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="EmulatorLauncher.launch_rom-548"><a href="#EmulatorLauncher.launch_rom-548"><span class="linenos">548</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="EmulatorLauncher.launch_rom-549"><a href="#EmulatorLauncher.launch_rom-549"><span class="linenos">549</span></a>                <span class="k">if</span> <span class="s2">&quot;</span><span class="si">{rom_path}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_rom-550"><a href="#EmulatorLauncher.launch_rom-550"><span class="linenos">550</span></a>                    <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{rom_path}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.launch_rom-551"><a href="#EmulatorLauncher.launch_rom-551"><span class="linenos">551</span></a>            <span class="n">command</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="EmulatorLauncher.launch_rom-552"><a href="#EmulatorLauncher.launch_rom-552"><span class="linenos">552</span></a>
</span><span id="EmulatorLauncher.launch_rom-553"><a href="#EmulatorLauncher.launch_rom-553"><span class="linenos">553</span></a>        <span class="c1"># print(f&quot;Launching: {&#39; &#39;.join(command)}&quot;)</span>
</span><span id="EmulatorLauncher.launch_rom-554"><a href="#EmulatorLauncher.launch_rom-554"><span class="linenos">554</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_rom-555"><a href="#EmulatorLauncher.launch_rom-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span id="EmulatorLauncher.launch_rom-556"><a href="#EmulatorLauncher.launch_rom-556"><span class="linenos">556</span></a>                <span class="n">command</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">start_in_directory</span>
</span><span id="EmulatorLauncher.launch_rom-557"><a href="#EmulatorLauncher.launch_rom-557"><span class="linenos">557</span></a>            <span class="p">)</span>  <span class="c1"># Set working directory</span>
</span><span id="EmulatorLauncher.launch_rom-558"><a href="#EmulatorLauncher.launch_rom-558"><span class="linenos">558</span></a>        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_rom-559"><a href="#EmulatorLauncher.launch_rom-559"><span class="linenos">559</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error launching emulator: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher.launch_rom-560"><a href="#EmulatorLauncher.launch_rom-560"><span class="linenos">560</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_rom-561"><a href="#EmulatorLauncher.launch_rom-561"><span class="linenos">561</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Emulator not found at: </span><span class="si">{</span><span class="n">emulator_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Launches a ROM using the specified emulator and arguments.
Args:
    emulator_path (str): The file path to the emulator executable.
    launch_arguments (str): The arguments to pass to the emulator. Use "{rom_path}" as a placeholder for the ROM path.
    rom_path (str): The file path to the ROM to be launched.
    start_in_directory (str): The directory to set as the working directory when launching the emulator.
Raises:
    subprocess.CalledProcessError: If there is an error launching the emulator.
    FileNotFoundError: If the emulator executable is not found at the specified path.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.update_filtered_roms" class="classattr">
                                        <input id="EmulatorLauncher.update_filtered_roms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_filtered_roms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.update_filtered_roms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.update_filtered_roms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.update_filtered_roms-563"><a href="#EmulatorLauncher.update_filtered_roms-563"><span class="linenos">563</span></a>    <span class="k">def</span> <span class="nf">update_filtered_roms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.update_filtered_roms-564"><a href="#EmulatorLauncher.update_filtered_roms-564"><span class="linenos">564</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.update_filtered_roms-565"><a href="#EmulatorLauncher.update_filtered_roms-565"><span class="linenos">565</span></a><span class="sd">        Updates the list of filtered ROMs based on the filter string and view mode.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-566"><a href="#EmulatorLauncher.update_filtered_roms-566"><span class="linenos">566</span></a><span class="sd">        This method filters the ROMs according to the current filter string and view mode.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-567"><a href="#EmulatorLauncher.update_filtered_roms-567"><span class="linenos">567</span></a><span class="sd">        The view modes can be &quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;. Depending on the view mode,</span>
</span><span id="EmulatorLauncher.update_filtered_roms-568"><a href="#EmulatorLauncher.update_filtered_roms-568"><span class="linenos">568</span></a><span class="sd">        the filtered ROMs are updated as follows:</span>
</span><span id="EmulatorLauncher.update_filtered_roms-569"><a href="#EmulatorLauncher.update_filtered_roms-569"><span class="linenos">569</span></a><span class="sd">        - &quot;systems&quot;: Filters ROMs within each system based on the filter string.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-570"><a href="#EmulatorLauncher.update_filtered_roms-570"><span class="linenos">570</span></a><span class="sd">        - &quot;all&quot;: Filters all ROMs across all systems based on the filter string.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-571"><a href="#EmulatorLauncher.update_filtered_roms-571"><span class="linenos">571</span></a><span class="sd">        - &quot;favorites&quot;: Filters favorite ROMs based on the filter string.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-572"><a href="#EmulatorLauncher.update_filtered_roms-572"><span class="linenos">572</span></a><span class="sd">        If the filter string is empty, the filtered ROMs list is set to the full list of ROMs</span>
</span><span id="EmulatorLauncher.update_filtered_roms-573"><a href="#EmulatorLauncher.update_filtered_roms-573"><span class="linenos">573</span></a><span class="sd">        for the current view mode.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-574"><a href="#EmulatorLauncher.update_filtered_roms-574"><span class="linenos">574</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher.update_filtered_roms-575"><a href="#EmulatorLauncher.update_filtered_roms-575"><span class="linenos">575</span></a><span class="sd">            filter_string (str): The string used to filter ROMs.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-576"><a href="#EmulatorLauncher.update_filtered_roms-576"><span class="linenos">576</span></a><span class="sd">            view_mode (str): The current view mode (&quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;).</span>
</span><span id="EmulatorLauncher.update_filtered_roms-577"><a href="#EmulatorLauncher.update_filtered_roms-577"><span class="linenos">577</span></a><span class="sd">            roms (dict): A dictionary of ROMs categorized by system.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-578"><a href="#EmulatorLauncher.update_filtered_roms-578"><span class="linenos">578</span></a><span class="sd">            all_roms (list): A list of all ROMs across all systems.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-579"><a href="#EmulatorLauncher.update_filtered_roms-579"><span class="linenos">579</span></a><span class="sd">            filtered_roms (dict): A dictionary of filtered ROMs based on the filter string and view mode.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-580"><a href="#EmulatorLauncher.update_filtered_roms-580"><span class="linenos">580</span></a><span class="sd">            get_favorite_roms_with_system (function): A function that returns favorite ROMs with their systems.</span>
</span><span id="EmulatorLauncher.update_filtered_roms-581"><a href="#EmulatorLauncher.update_filtered_roms-581"><span class="linenos">581</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.update_filtered_roms-582"><a href="#EmulatorLauncher.update_filtered_roms-582"><span class="linenos">582</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">:</span>
</span><span id="EmulatorLauncher.update_filtered_roms-583"><a href="#EmulatorLauncher.update_filtered_roms-583"><span class="linenos">583</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.update_filtered_roms-584"><a href="#EmulatorLauncher.update_filtered_roms-584"><span class="linenos">584</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">roms</span>
</span><span id="EmulatorLauncher.update_filtered_roms-585"><a href="#EmulatorLauncher.update_filtered_roms-585"><span class="linenos">585</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.update_filtered_roms-586"><a href="#EmulatorLauncher.update_filtered_roms-586"><span class="linenos">586</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;all&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span><span class="p">}</span>
</span><span id="EmulatorLauncher.update_filtered_roms-587"><a href="#EmulatorLauncher.update_filtered_roms-587"><span class="linenos">587</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.update_filtered_roms-588"><a href="#EmulatorLauncher.update_filtered_roms-588"><span class="linenos">588</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;favorites&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_favorite_roms_with_system</span><span class="p">()}</span>
</span><span id="EmulatorLauncher.update_filtered_roms-589"><a href="#EmulatorLauncher.update_filtered_roms-589"><span class="linenos">589</span></a>            <span class="k">return</span>
</span><span id="EmulatorLauncher.update_filtered_roms-590"><a href="#EmulatorLauncher.update_filtered_roms-590"><span class="linenos">590</span></a>
</span><span id="EmulatorLauncher.update_filtered_roms-591"><a href="#EmulatorLauncher.update_filtered_roms-591"><span class="linenos">591</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="EmulatorLauncher.update_filtered_roms-592"><a href="#EmulatorLauncher.update_filtered_roms-592"><span class="linenos">592</span></a>
</span><span id="EmulatorLauncher.update_filtered_roms-593"><a href="#EmulatorLauncher.update_filtered_roms-593"><span class="linenos">593</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.update_filtered_roms-594"><a href="#EmulatorLauncher.update_filtered_roms-594"><span class="linenos">594</span></a>            <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">roms</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher.update_filtered_roms-595"><a href="#EmulatorLauncher.update_filtered_roms-595"><span class="linenos">595</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="p">[</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="EmulatorLauncher.update_filtered_roms-596"><a href="#EmulatorLauncher.update_filtered_roms-596"><span class="linenos">596</span></a>                    <span class="n">rom</span>
</span><span id="EmulatorLauncher.update_filtered_roms-597"><a href="#EmulatorLauncher.update_filtered_roms-597"><span class="linenos">597</span></a>                    <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">roms</span>
</span><span id="EmulatorLauncher.update_filtered_roms-598"><a href="#EmulatorLauncher.update_filtered_roms-598"><span class="linenos">598</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="EmulatorLauncher.update_filtered_roms-599"><a href="#EmulatorLauncher.update_filtered_roms-599"><span class="linenos">599</span></a>                <span class="p">]</span>
</span><span id="EmulatorLauncher.update_filtered_roms-600"><a href="#EmulatorLauncher.update_filtered_roms-600"><span class="linenos">600</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.update_filtered_roms-601"><a href="#EmulatorLauncher.update_filtered_roms-601"><span class="linenos">601</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="EmulatorLauncher.update_filtered_roms-602"><a href="#EmulatorLauncher.update_filtered_roms-602"><span class="linenos">602</span></a>                <span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rom</span><span class="p">)</span>
</span><span id="EmulatorLauncher.update_filtered_roms-603"><a href="#EmulatorLauncher.update_filtered_roms-603"><span class="linenos">603</span></a>                <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">rom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_roms</span>
</span><span id="EmulatorLauncher.update_filtered_roms-604"><a href="#EmulatorLauncher.update_filtered_roms-604"><span class="linenos">604</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="EmulatorLauncher.update_filtered_roms-605"><a href="#EmulatorLauncher.update_filtered_roms-605"><span class="linenos">605</span></a>            <span class="p">]</span>
</span><span id="EmulatorLauncher.update_filtered_roms-606"><a href="#EmulatorLauncher.update_filtered_roms-606"><span class="linenos">606</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.update_filtered_roms-607"><a href="#EmulatorLauncher.update_filtered_roms-607"><span class="linenos">607</span></a>            <span class="n">favorite_roms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_favorite_roms_with_system</span><span class="p">()</span>
</span><span id="EmulatorLauncher.update_filtered_roms-608"><a href="#EmulatorLauncher.update_filtered_roms-608"><span class="linenos">608</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="p">[</span><span class="s2">&quot;favorites&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="EmulatorLauncher.update_filtered_roms-609"><a href="#EmulatorLauncher.update_filtered_roms-609"><span class="linenos">609</span></a>                <span class="n">rom_data</span>
</span><span id="EmulatorLauncher.update_filtered_roms-610"><a href="#EmulatorLauncher.update_filtered_roms-610"><span class="linenos">610</span></a>                <span class="k">for</span> <span class="n">rom_data</span> <span class="ow">in</span> <span class="n">favorite_roms</span>
</span><span id="EmulatorLauncher.update_filtered_roms-611"><a href="#EmulatorLauncher.update_filtered_roms-611"><span class="linenos">611</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">rom_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="EmulatorLauncher.update_filtered_roms-612"><a href="#EmulatorLauncher.update_filtered_roms-612"><span class="linenos">612</span></a>            <span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Updates the list of filtered ROMs based on the filter string and view mode.
This method filters the ROMs according to the current filter string and view mode.
The view modes can be "systems", "all", or "favorites". Depending on the view mode,
the filtered ROMs are updated as follows:</p>

<ul>
<li>"systems": Filters ROMs within each system based on the filter string.</li>
<li>"all": Filters all ROMs across all systems based on the filter string.</li>
<li>"favorites": Filters favorite ROMs based on the filter string.
If the filter string is empty, the filtered ROMs list is set to the full list of ROMs
for the current view mode.
Attributes:
filter_string (str): The string used to filter ROMs.
view_mode (str): The current view mode ("systems", "all", or "favorites").
roms (dict): A dictionary of ROMs categorized by system.
all_roms (list): A list of all ROMs across all systems.
filtered_roms (dict): A dictionary of filtered ROMs based on the filter string and view mode.
get_favorite_roms_with_system (function): A function that returns favorite ROMs with their systems.</li>
</ul>
</div>


                            </div>
                            <div id="EmulatorLauncher.get_favorite_roms_with_system" class="classattr">
                                        <input id="EmulatorLauncher.get_favorite_roms_with_system-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_favorite_roms_with_system</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.get_favorite_roms_with_system-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.get_favorite_roms_with_system"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.get_favorite_roms_with_system-614"><a href="#EmulatorLauncher.get_favorite_roms_with_system-614"><span class="linenos">614</span></a>    <span class="k">def</span> <span class="nf">get_favorite_roms_with_system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-615"><a href="#EmulatorLauncher.get_favorite_roms_with_system-615"><span class="linenos">615</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-616"><a href="#EmulatorLauncher.get_favorite_roms_with_system-616"><span class="linenos">616</span></a><span class="sd">        Returns a list of favorite ROMs with their system names.</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-617"><a href="#EmulatorLauncher.get_favorite_roms_with_system-617"><span class="linenos">617</span></a>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-618"><a href="#EmulatorLauncher.get_favorite_roms_with_system-618"><span class="linenos">618</span></a><span class="sd">        This method iterates through the &#39;favorites&#39; dictionary, which contains</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-619"><a href="#EmulatorLauncher.get_favorite_roms_with_system-619"><span class="linenos">619</span></a><span class="sd">        system names as keys and lists of favorite ROMs as values. It creates a</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-620"><a href="#EmulatorLauncher.get_favorite_roms_with_system-620"><span class="linenos">620</span></a><span class="sd">        list of tuples, where each tuple contains a system name and a ROM name.</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-621"><a href="#EmulatorLauncher.get_favorite_roms_with_system-621"><span class="linenos">621</span></a>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-622"><a href="#EmulatorLauncher.get_favorite_roms_with_system-622"><span class="linenos">622</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-623"><a href="#EmulatorLauncher.get_favorite_roms_with_system-623"><span class="linenos">623</span></a><span class="sd">            list of tuple: A list of tuples, where each tuple contains a system</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-624"><a href="#EmulatorLauncher.get_favorite_roms_with_system-624"><span class="linenos">624</span></a><span class="sd">            name (str) and a ROM name (str).</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-625"><a href="#EmulatorLauncher.get_favorite_roms_with_system-625"><span class="linenos">625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-626"><a href="#EmulatorLauncher.get_favorite_roms_with_system-626"><span class="linenos">626</span></a>        <span class="n">favorite_roms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-627"><a href="#EmulatorLauncher.get_favorite_roms_with_system-627"><span class="linenos">627</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">roms</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-628"><a href="#EmulatorLauncher.get_favorite_roms_with_system-628"><span class="linenos">628</span></a>            <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">roms</span><span class="p">:</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-629"><a href="#EmulatorLauncher.get_favorite_roms_with_system-629"><span class="linenos">629</span></a>                <span class="n">favorite_roms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">system</span><span class="p">,</span> <span class="n">rom</span><span class="p">))</span>
</span><span id="EmulatorLauncher.get_favorite_roms_with_system-630"><a href="#EmulatorLauncher.get_favorite_roms_with_system-630"><span class="linenos">630</span></a>        <span class="k">return</span> <span class="n">favorite_roms</span>
</span></pre></div>


            <div class="docstring"><p>Returns a list of favorite ROMs with their system names.</p>

<p>This method iterates through the 'favorites' dictionary, which contains
system names as keys and lists of favorite ROMs as values. It creates a
list of tuples, where each tuple contains a system name and a ROM name.</p>

<p>Returns:
    list of tuple: A list of tuples, where each tuple contains a system
    name (str) and a ROM name (str).</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.toggle_favorite" class="classattr">
                                        <input id="EmulatorLauncher.toggle_favorite-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_favorite</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.toggle_favorite-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.toggle_favorite"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.toggle_favorite-632"><a href="#EmulatorLauncher.toggle_favorite-632"><span class="linenos">632</span></a>    <span class="k">def</span> <span class="nf">toggle_favorite</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.toggle_favorite-633"><a href="#EmulatorLauncher.toggle_favorite-633"><span class="linenos">633</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.toggle_favorite-634"><a href="#EmulatorLauncher.toggle_favorite-634"><span class="linenos">634</span></a><span class="sd">        Toggles the favorite status of the currently selected ROM.</span>
</span><span id="EmulatorLauncher.toggle_favorite-635"><a href="#EmulatorLauncher.toggle_favorite-635"><span class="linenos">635</span></a><span class="sd">        Depending on the current view mode, this method will:</span>
</span><span id="EmulatorLauncher.toggle_favorite-636"><a href="#EmulatorLauncher.toggle_favorite-636"><span class="linenos">636</span></a><span class="sd">        - In &quot;systems&quot; view mode: Toggle the favorite status of the selected ROM within the selected system.</span>
</span><span id="EmulatorLauncher.toggle_favorite-637"><a href="#EmulatorLauncher.toggle_favorite-637"><span class="linenos">637</span></a><span class="sd">        - In &quot;all&quot; view mode: Toggle the favorite status of the selected ROM from the complete list of ROMs.</span>
</span><span id="EmulatorLauncher.toggle_favorite-638"><a href="#EmulatorLauncher.toggle_favorite-638"><span class="linenos">638</span></a><span class="sd">        - In &quot;favorites&quot; view mode: Toggle the favorite status of the selected ROM from the list of favorite ROMs.</span>
</span><span id="EmulatorLauncher.toggle_favorite-639"><a href="#EmulatorLauncher.toggle_favorite-639"><span class="linenos">639</span></a><span class="sd">        After toggling the favorite status, the method updates the filtered ROMs list and redraws the ROM window.</span>
</span><span id="EmulatorLauncher.toggle_favorite-640"><a href="#EmulatorLauncher.toggle_favorite-640"><span class="linenos">640</span></a><span class="sd">        It also ensures that the ROM selection position is restored and within bounds.</span>
</span><span id="EmulatorLauncher.toggle_favorite-641"><a href="#EmulatorLauncher.toggle_favorite-641"><span class="linenos">641</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher.toggle_favorite-642"><a href="#EmulatorLauncher.toggle_favorite-642"><span class="linenos">642</span></a><span class="sd">            self.selected_rom (int): The index of the currently selected ROM.</span>
</span><span id="EmulatorLauncher.toggle_favorite-643"><a href="#EmulatorLauncher.toggle_favorite-643"><span class="linenos">643</span></a><span class="sd">            self.view_mode (str): The current view mode (&quot;systems&quot;, &quot;all&quot;, or &quot;favorites&quot;).</span>
</span><span id="EmulatorLauncher.toggle_favorite-644"><a href="#EmulatorLauncher.toggle_favorite-644"><span class="linenos">644</span></a><span class="sd">            self.roms (dict): A dictionary containing ROMs categorized by systems.</span>
</span><span id="EmulatorLauncher.toggle_favorite-645"><a href="#EmulatorLauncher.toggle_favorite-645"><span class="linenos">645</span></a><span class="sd">            self.filtered_roms (dict): A dictionary containing filtered ROMs based on the current view mode.</span>
</span><span id="EmulatorLauncher.toggle_favorite-646"><a href="#EmulatorLauncher.toggle_favorite-646"><span class="linenos">646</span></a><span class="sd">            self.favorites (dict): A dictionary containing favorite ROMs categorized by systems.</span>
</span><span id="EmulatorLauncher.toggle_favorite-647"><a href="#EmulatorLauncher.toggle_favorite-647"><span class="linenos">647</span></a><span class="sd">            self.selected_system (int): The index of the currently selected system.</span>
</span><span id="EmulatorLauncher.toggle_favorite-648"><a href="#EmulatorLauncher.toggle_favorite-648"><span class="linenos">648</span></a><span class="sd">        Methods:</span>
</span><span id="EmulatorLauncher.toggle_favorite-649"><a href="#EmulatorLauncher.toggle_favorite-649"><span class="linenos">649</span></a><span class="sd">            self.save_favorites(): Saves the current state of favorite ROMs.</span>
</span><span id="EmulatorLauncher.toggle_favorite-650"><a href="#EmulatorLauncher.toggle_favorite-650"><span class="linenos">650</span></a><span class="sd">            self.toggle_favorite_by_system_and_path(system, rom_path): Toggles the favorite status of a ROM by system and path.</span>
</span><span id="EmulatorLauncher.toggle_favorite-651"><a href="#EmulatorLauncher.toggle_favorite-651"><span class="linenos">651</span></a><span class="sd">            self.update_filtered_roms(): Updates the list of filtered ROMs based on the current view mode.</span>
</span><span id="EmulatorLauncher.toggle_favorite-652"><a href="#EmulatorLauncher.toggle_favorite-652"><span class="linenos">652</span></a><span class="sd">            self.draw_rom_window(): Redraws the ROM window to reflect the current state.</span>
</span><span id="EmulatorLauncher.toggle_favorite-653"><a href="#EmulatorLauncher.toggle_favorite-653"><span class="linenos">653</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.toggle_favorite-654"><a href="#EmulatorLauncher.toggle_favorite-654"><span class="linenos">654</span></a>        <span class="n">current_rom_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span>  <span class="c1"># Store the current ROM index</span>
</span><span id="EmulatorLauncher.toggle_favorite-655"><a href="#EmulatorLauncher.toggle_favorite-655"><span class="linenos">655</span></a>
</span><span id="EmulatorLauncher.toggle_favorite-656"><a href="#EmulatorLauncher.toggle_favorite-656"><span class="linenos">656</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-657"><a href="#EmulatorLauncher.toggle_favorite-657"><span class="linenos">657</span></a>            <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="EmulatorLauncher.toggle_favorite-658"><a href="#EmulatorLauncher.toggle_favorite-658"><span class="linenos">658</span></a>            <span class="k">if</span> <span class="n">systems</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-659"><a href="#EmulatorLauncher.toggle_favorite-659"><span class="linenos">659</span></a>                <span class="n">selected_system_name</span> <span class="o">=</span> <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="EmulatorLauncher.toggle_favorite-660"><a href="#EmulatorLauncher.toggle_favorite-660"><span class="linenos">660</span></a>                <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_system_name</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.toggle_favorite-661"><a href="#EmulatorLauncher.toggle_favorite-661"><span class="linenos">661</span></a>                <span class="k">if</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-662"><a href="#EmulatorLauncher.toggle_favorite-662"><span class="linenos">662</span></a>                    <span class="n">selected_rom_path</span> <span class="o">=</span> <span class="n">rom_list</span><span class="p">[</span><span class="n">current_rom_index</span><span class="p">]</span>  <span class="c1"># Use stored index</span>
</span><span id="EmulatorLauncher.toggle_favorite-663"><a href="#EmulatorLauncher.toggle_favorite-663"><span class="linenos">663</span></a>
</span><span id="EmulatorLauncher.toggle_favorite-664"><a href="#EmulatorLauncher.toggle_favorite-664"><span class="linenos">664</span></a>                    <span class="k">if</span> <span class="n">selected_system_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-665"><a href="#EmulatorLauncher.toggle_favorite-665"><span class="linenos">665</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher.toggle_favorite-666"><a href="#EmulatorLauncher.toggle_favorite-666"><span class="linenos">666</span></a>
</span><span id="EmulatorLauncher.toggle_favorite-667"><a href="#EmulatorLauncher.toggle_favorite-667"><span class="linenos">667</span></a>                    <span class="k">if</span> <span class="n">selected_rom_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]:</span>
</span><span id="EmulatorLauncher.toggle_favorite-668"><a href="#EmulatorLauncher.toggle_favorite-668"><span class="linenos">668</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">selected_rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.toggle_favorite-669"><a href="#EmulatorLauncher.toggle_favorite-669"><span class="linenos">669</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-670"><a href="#EmulatorLauncher.toggle_favorite-670"><span class="linenos">670</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selected_rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.toggle_favorite-671"><a href="#EmulatorLauncher.toggle_favorite-671"><span class="linenos">671</span></a>
</span><span id="EmulatorLauncher.toggle_favorite-672"><a href="#EmulatorLauncher.toggle_favorite-672"><span class="linenos">672</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]:</span>
</span><span id="EmulatorLauncher.toggle_favorite-673"><a href="#EmulatorLauncher.toggle_favorite-673"><span class="linenos">673</span></a>                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">selected_system_name</span><span class="p">]</span>
</span><span id="EmulatorLauncher.toggle_favorite-674"><a href="#EmulatorLauncher.toggle_favorite-674"><span class="linenos">674</span></a>
</span><span id="EmulatorLauncher.toggle_favorite-675"><a href="#EmulatorLauncher.toggle_favorite-675"><span class="linenos">675</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">save_favorites</span><span class="p">()</span>
</span><span id="EmulatorLauncher.toggle_favorite-676"><a href="#EmulatorLauncher.toggle_favorite-676"><span class="linenos">676</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-677"><a href="#EmulatorLauncher.toggle_favorite-677"><span class="linenos">677</span></a>            <span class="n">rom_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])[</span>
</span><span id="EmulatorLauncher.toggle_favorite-678"><a href="#EmulatorLauncher.toggle_favorite-678"><span class="linenos">678</span></a>                <span class="n">current_rom_index</span>
</span><span id="EmulatorLauncher.toggle_favorite-679"><a href="#EmulatorLauncher.toggle_favorite-679"><span class="linenos">679</span></a>            <span class="p">]</span>  <span class="c1"># Use stored index</span>
</span><span id="EmulatorLauncher.toggle_favorite-680"><a href="#EmulatorLauncher.toggle_favorite-680"><span class="linenos">680</span></a>            <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="EmulatorLauncher.toggle_favorite-681"><a href="#EmulatorLauncher.toggle_favorite-681"><span class="linenos">681</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite_by_system_and_path</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.toggle_favorite-682"><a href="#EmulatorLauncher.toggle_favorite-682"><span class="linenos">682</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-683"><a href="#EmulatorLauncher.toggle_favorite-683"><span class="linenos">683</span></a>            <span class="n">rom_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])[</span>
</span><span id="EmulatorLauncher.toggle_favorite-684"><a href="#EmulatorLauncher.toggle_favorite-684"><span class="linenos">684</span></a>                <span class="n">current_rom_index</span>
</span><span id="EmulatorLauncher.toggle_favorite-685"><a href="#EmulatorLauncher.toggle_favorite-685"><span class="linenos">685</span></a>            <span class="p">]</span>  <span class="c1"># Use stored index</span>
</span><span id="EmulatorLauncher.toggle_favorite-686"><a href="#EmulatorLauncher.toggle_favorite-686"><span class="linenos">686</span></a>            <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_data</span>
</span><span id="EmulatorLauncher.toggle_favorite-687"><a href="#EmulatorLauncher.toggle_favorite-687"><span class="linenos">687</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite_by_system_and_path</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.toggle_favorite-688"><a href="#EmulatorLauncher.toggle_favorite-688"><span class="linenos">688</span></a>
</span><span id="EmulatorLauncher.toggle_favorite-689"><a href="#EmulatorLauncher.toggle_favorite-689"><span class="linenos">689</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.toggle_favorite-690"><a href="#EmulatorLauncher.toggle_favorite-690"><span class="linenos">690</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher.toggle_favorite-691"><a href="#EmulatorLauncher.toggle_favorite-691"><span class="linenos">691</span></a>
</span><span id="EmulatorLauncher.toggle_favorite-692"><a href="#EmulatorLauncher.toggle_favorite-692"><span class="linenos">692</span></a>        <span class="c1"># Restore the ROM selection position</span>
</span><span id="EmulatorLauncher.toggle_favorite-693"><a href="#EmulatorLauncher.toggle_favorite-693"><span class="linenos">693</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-694"><a href="#EmulatorLauncher.toggle_favorite-694"><span class="linenos">694</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">],</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.toggle_favorite-695"><a href="#EmulatorLauncher.toggle_favorite-695"><span class="linenos">695</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-696"><a href="#EmulatorLauncher.toggle_favorite-696"><span class="linenos">696</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.toggle_favorite-697"><a href="#EmulatorLauncher.toggle_favorite-697"><span class="linenos">697</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite-698"><a href="#EmulatorLauncher.toggle_favorite-698"><span class="linenos">698</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.toggle_favorite-699"><a href="#EmulatorLauncher.toggle_favorite-699"><span class="linenos">699</span></a>
</span><span id="EmulatorLauncher.toggle_favorite-700"><a href="#EmulatorLauncher.toggle_favorite-700"><span class="linenos">700</span></a>        <span class="c1"># Ensure the stored index is within bounds</span>
</span><span id="EmulatorLauncher.toggle_favorite-701"><a href="#EmulatorLauncher.toggle_favorite-701"><span class="linenos">701</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">current_rom_index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher.toggle_favorite-702"><a href="#EmulatorLauncher.toggle_favorite-702"><span class="linenos">702</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Ensure it&#39;s not negative</span>
</span></pre></div>


            <div class="docstring"><p>Toggles the favorite status of the currently selected ROM.
Depending on the current view mode, this method will:</p>

<ul>
<li>In "systems" view mode: Toggle the favorite status of the selected ROM within the selected system.</li>
<li>In "all" view mode: Toggle the favorite status of the selected ROM from the complete list of ROMs.</li>
<li>In "favorites" view mode: Toggle the favorite status of the selected ROM from the list of favorite ROMs.
After toggling the favorite status, the method updates the filtered ROMs list and redraws the ROM window.
It also ensures that the ROM selection position is restored and within bounds.
Attributes:
self.selected_rom (int): The index of the currently selected ROM.
self.view_mode (str): The current view mode ("systems", "all", or "favorites").
self.roms (dict): A dictionary containing ROMs categorized by systems.
self.filtered_roms (dict): A dictionary containing filtered ROMs based on the current view mode.
self.favorites (dict): A dictionary containing favorite ROMs categorized by systems.
self.selected_system (int): The index of the currently selected system.
Methods:
self.save_favorites(): Saves the current state of favorite ROMs.
self.toggle_favorite_by_system_and_path(system, rom_path): Toggles the favorite status of a ROM by system and path.
self.update_filtered_roms(): Updates the list of filtered ROMs based on the current view mode.
self.draw_rom_window(): Redraws the ROM window to reflect the current state.</li>
</ul>
</div>


                            </div>
                            <div id="EmulatorLauncher.toggle_favorite_by_system_and_path" class="classattr">
                                        <input id="EmulatorLauncher.toggle_favorite_by_system_and_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">toggle_favorite_by_system_and_path</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">system</span>, </span><span class="param"><span class="n">rom_path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.toggle_favorite_by_system_and_path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.toggle_favorite_by_system_and_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-704"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-704"><span class="linenos">704</span></a>    <span class="k">def</span> <span class="nf">toggle_favorite_by_system_and_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">):</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-705"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-705"><span class="linenos">705</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-706"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-706"><span class="linenos">706</span></a><span class="sd">        Toggles the favorite status of a ROM by its system and path.</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-707"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-707"><span class="linenos">707</span></a><span class="sd">        If the ROM is already a favorite, it will be removed from the favorites list.</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-708"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-708"><span class="linenos">708</span></a><span class="sd">        If the ROM is not a favorite, it will be added to the favorites list.</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-709"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-709"><span class="linenos">709</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-710"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-710"><span class="linenos">710</span></a><span class="sd">            system (str): The system to which the ROM belongs.</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-711"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-711"><span class="linenos">711</span></a><span class="sd">            rom_path (str): The file path of the ROM.</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-712"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-712"><span class="linenos">712</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-713"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-713"><span class="linenos">713</span></a><span class="sd">            None</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-714"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-714"><span class="linenos">714</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-715"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-715"><span class="linenos">715</span></a>        <span class="k">if</span> <span class="n">system</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-716"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-716"><span class="linenos">716</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-717"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-717"><span class="linenos">717</span></a>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-718"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-718"><span class="linenos">718</span></a>        <span class="k">if</span> <span class="n">rom_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]:</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-719"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-719"><span class="linenos">719</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-720"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-720"><span class="linenos">720</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]:</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-721"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-721"><span class="linenos">721</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-722"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-722"><span class="linenos">722</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-723"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-723"><span class="linenos">723</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="p">[</span><span class="n">system</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rom_path</span><span class="p">)</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-724"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-724"><span class="linenos">724</span></a>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-725"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-725"><span class="linenos">725</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">save_favorites</span><span class="p">()</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-726"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-726"><span class="linenos">726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.toggle_favorite_by_system_and_path-727"><a href="#EmulatorLauncher.toggle_favorite_by_system_and_path-727"><span class="linenos">727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Toggles the favorite status of a ROM by its system and path.
If the ROM is already a favorite, it will be removed from the favorites list.
If the ROM is not a favorite, it will be added to the favorites list.
Args:
    system (str): The system to which the ROM belongs.
    rom_path (str): The file path of the ROM.
Returns:
    None</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.is_favorite" class="classattr">
                                        <input id="EmulatorLauncher.is_favorite-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_favorite</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">rom_path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.is_favorite-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.is_favorite"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.is_favorite-729"><a href="#EmulatorLauncher.is_favorite-729"><span class="linenos">729</span></a>    <span class="k">def</span> <span class="nf">is_favorite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rom_path</span><span class="p">):</span>
</span><span id="EmulatorLauncher.is_favorite-730"><a href="#EmulatorLauncher.is_favorite-730"><span class="linenos">730</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.is_favorite-731"><a href="#EmulatorLauncher.is_favorite-731"><span class="linenos">731</span></a><span class="sd">        Check if a ROM is marked as a favorite.</span>
</span><span id="EmulatorLauncher.is_favorite-732"><a href="#EmulatorLauncher.is_favorite-732"><span class="linenos">732</span></a>
</span><span id="EmulatorLauncher.is_favorite-733"><a href="#EmulatorLauncher.is_favorite-733"><span class="linenos">733</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher.is_favorite-734"><a href="#EmulatorLauncher.is_favorite-734"><span class="linenos">734</span></a><span class="sd">            rom_path (str): The file path of the ROM to check.</span>
</span><span id="EmulatorLauncher.is_favorite-735"><a href="#EmulatorLauncher.is_favorite-735"><span class="linenos">735</span></a>
</span><span id="EmulatorLauncher.is_favorite-736"><a href="#EmulatorLauncher.is_favorite-736"><span class="linenos">736</span></a><span class="sd">        Returns:</span>
</span><span id="EmulatorLauncher.is_favorite-737"><a href="#EmulatorLauncher.is_favorite-737"><span class="linenos">737</span></a><span class="sd">            bool: True if the ROM is a favorite, False otherwise.</span>
</span><span id="EmulatorLauncher.is_favorite-738"><a href="#EmulatorLauncher.is_favorite-738"><span class="linenos">738</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.is_favorite-739"><a href="#EmulatorLauncher.is_favorite-739"><span class="linenos">739</span></a>        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">favorites</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">favorites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="EmulatorLauncher.is_favorite-740"><a href="#EmulatorLauncher.is_favorite-740"><span class="linenos">740</span></a>            <span class="k">if</span> <span class="n">rom_path</span> <span class="ow">in</span> <span class="n">favorites</span><span class="p">:</span>
</span><span id="EmulatorLauncher.is_favorite-741"><a href="#EmulatorLauncher.is_favorite-741"><span class="linenos">741</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="EmulatorLauncher.is_favorite-742"><a href="#EmulatorLauncher.is_favorite-742"><span class="linenos">742</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Check if a ROM is marked as a favorite.</p>

<p>Args:
    rom_path (str): The file path of the ROM to check.</p>

<p>Returns:
    bool: True if the ROM is a favorite, False otherwise.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.handle_input" class="classattr">
                                        <input id="EmulatorLauncher.handle_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">handle_input</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">key</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.handle_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.handle_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.handle_input-744"><a href="#EmulatorLauncher.handle_input-744"><span class="linenos">744</span></a>    <span class="k">def</span> <span class="nf">handle_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="EmulatorLauncher.handle_input-745"><a href="#EmulatorLauncher.handle_input-745"><span class="linenos">745</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.handle_input-746"><a href="#EmulatorLauncher.handle_input-746"><span class="linenos">746</span></a><span class="sd">        Handles user input for navigating and filtering ROMs.</span>
</span><span id="EmulatorLauncher.handle_input-747"><a href="#EmulatorLauncher.handle_input-747"><span class="linenos">747</span></a><span class="sd">        Parameters:</span>
</span><span id="EmulatorLauncher.handle_input-748"><a href="#EmulatorLauncher.handle_input-748"><span class="linenos">748</span></a><span class="sd">        key (int): The key code of the pressed key.</span>
</span><span id="EmulatorLauncher.handle_input-749"><a href="#EmulatorLauncher.handle_input-749"><span class="linenos">749</span></a><span class="sd">        Behavior:</span>
</span><span id="EmulatorLauncher.handle_input-750"><a href="#EmulatorLauncher.handle_input-750"><span class="linenos">750</span></a><span class="sd">        - In &quot;filter&quot; mode:</span>
</span><span id="EmulatorLauncher.handle_input-751"><a href="#EmulatorLauncher.handle_input-751"><span class="linenos">751</span></a><span class="sd">            - Escape key (27): Switch to &quot;navigate&quot; mode, clear filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="EmulatorLauncher.handle_input-752"><a href="#EmulatorLauncher.handle_input-752"><span class="linenos">752</span></a><span class="sd">            - Enter key (10): Launch the selected ROM.</span>
</span><span id="EmulatorLauncher.handle_input-753"><a href="#EmulatorLauncher.handle_input-753"><span class="linenos">753</span></a><span class="sd">            - Backspace key (curses.KEY_BACKSPACE, 127, 8): Remove the last character from the filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="EmulatorLauncher.handle_input-754"><a href="#EmulatorLauncher.handle_input-754"><span class="linenos">754</span></a><span class="sd">            - Up key (curses.KEY_UP): Move the selection up in the filtered ROM list.</span>
</span><span id="EmulatorLauncher.handle_input-755"><a href="#EmulatorLauncher.handle_input-755"><span class="linenos">755</span></a><span class="sd">            - Down key (curses.KEY_DOWN): Move the selection down in the filtered ROM list.</span>
</span><span id="EmulatorLauncher.handle_input-756"><a href="#EmulatorLauncher.handle_input-756"><span class="linenos">756</span></a><span class="sd">            - F2 key (curses.KEY_F2): Toggle favorite status of the selected ROM if focus is on ROMs.</span>
</span><span id="EmulatorLauncher.handle_input-757"><a href="#EmulatorLauncher.handle_input-757"><span class="linenos">757</span></a><span class="sd">            - Printable characters (32-126): Append the character to the filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="EmulatorLauncher.handle_input-758"><a href="#EmulatorLauncher.handle_input-758"><span class="linenos">758</span></a><span class="sd">        - In &quot;navigate&quot; mode:</span>
</span><span id="EmulatorLauncher.handle_input-759"><a href="#EmulatorLauncher.handle_input-759"><span class="linenos">759</span></a><span class="sd">            - Up key (curses.KEY_UP): Navigate through ROMs or switch view modes and systems.</span>
</span><span id="EmulatorLauncher.handle_input-760"><a href="#EmulatorLauncher.handle_input-760"><span class="linenos">760</span></a><span class="sd">            - Down key (curses.KEY_DOWN): Navigate through ROMs or switch view modes and systems.</span>
</span><span id="EmulatorLauncher.handle_input-761"><a href="#EmulatorLauncher.handle_input-761"><span class="linenos">761</span></a><span class="sd">            - Left key (curses.KEY_LEFT): Set focus to systems.</span>
</span><span id="EmulatorLauncher.handle_input-762"><a href="#EmulatorLauncher.handle_input-762"><span class="linenos">762</span></a><span class="sd">            - Right key (curses.KEY_RIGHT): Set focus to ROMs.</span>
</span><span id="EmulatorLauncher.handle_input-763"><a href="#EmulatorLauncher.handle_input-763"><span class="linenos">763</span></a><span class="sd">            - Slash key (ord(&quot;/&quot;)): Switch to &quot;filter&quot; mode, clear filter string, update filtered ROMs, and reset selected ROM.</span>
</span><span id="EmulatorLauncher.handle_input-764"><a href="#EmulatorLauncher.handle_input-764"><span class="linenos">764</span></a><span class="sd">            - Enter key (10): Launch the selected ROM.</span>
</span><span id="EmulatorLauncher.handle_input-765"><a href="#EmulatorLauncher.handle_input-765"><span class="linenos">765</span></a><span class="sd">            - F2 key (curses.KEY_F2): Toggle favorite status of the selected ROM if focus is on ROMs.</span>
</span><span id="EmulatorLauncher.handle_input-766"><a href="#EmulatorLauncher.handle_input-766"><span class="linenos">766</span></a><span class="sd">        Updates:</span>
</span><span id="EmulatorLauncher.handle_input-767"><a href="#EmulatorLauncher.handle_input-767"><span class="linenos">767</span></a><span class="sd">        - Updates the timestamp if any selection state changes.</span>
</span><span id="EmulatorLauncher.handle_input-768"><a href="#EmulatorLauncher.handle_input-768"><span class="linenos">768</span></a><span class="sd">        - Redraws the ROM window, system window, and filter bar.</span>
</span><span id="EmulatorLauncher.handle_input-769"><a href="#EmulatorLauncher.handle_input-769"><span class="linenos">769</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.handle_input-770"><a href="#EmulatorLauncher.handle_input-770"><span class="linenos">770</span></a>        <span class="n">prev_selected_rom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span>
</span><span id="EmulatorLauncher.handle_input-771"><a href="#EmulatorLauncher.handle_input-771"><span class="linenos">771</span></a>        <span class="n">prev_view_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span>
</span><span id="EmulatorLauncher.handle_input-772"><a href="#EmulatorLauncher.handle_input-772"><span class="linenos">772</span></a>        <span class="n">prev_selected_system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span>
</span><span id="EmulatorLauncher.handle_input-773"><a href="#EmulatorLauncher.handle_input-773"><span class="linenos">773</span></a>
</span><span id="EmulatorLauncher.handle_input-774"><a href="#EmulatorLauncher.handle_input-774"><span class="linenos">774</span></a>        <span class="n">systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="EmulatorLauncher.handle_input-775"><a href="#EmulatorLauncher.handle_input-775"><span class="linenos">775</span></a>        <span class="n">num_systems</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">systems</span><span class="p">)</span>
</span><span id="EmulatorLauncher.handle_input-776"><a href="#EmulatorLauncher.handle_input-776"><span class="linenos">776</span></a>
</span><span id="EmulatorLauncher.handle_input-777"><a href="#EmulatorLauncher.handle_input-777"><span class="linenos">777</span></a>        <span class="n">rom_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="EmulatorLauncher.handle_input-778"><a href="#EmulatorLauncher.handle_input-778"><span class="linenos">778</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="n">systems</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-779"><a href="#EmulatorLauncher.handle_input-779"><span class="linenos">779</span></a>            <span class="n">selected_system_name</span> <span class="o">=</span> <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="EmulatorLauncher.handle_input-780"><a href="#EmulatorLauncher.handle_input-780"><span class="linenos">780</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_system_name</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.handle_input-781"><a href="#EmulatorLauncher.handle_input-781"><span class="linenos">781</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-782"><a href="#EmulatorLauncher.handle_input-782"><span class="linenos">782</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.handle_input-783"><a href="#EmulatorLauncher.handle_input-783"><span class="linenos">783</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-784"><a href="#EmulatorLauncher.handle_input-784"><span class="linenos">784</span></a>            <span class="n">rom_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filtered_roms</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="EmulatorLauncher.handle_input-785"><a href="#EmulatorLauncher.handle_input-785"><span class="linenos">785</span></a>
</span><span id="EmulatorLauncher.handle_input-786"><a href="#EmulatorLauncher.handle_input-786"><span class="linenos">786</span></a>        <span class="n">num_roms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rom_list</span><span class="p">)</span>
</span><span id="EmulatorLauncher.handle_input-787"><a href="#EmulatorLauncher.handle_input-787"><span class="linenos">787</span></a>
</span><span id="EmulatorLauncher.handle_input-788"><a href="#EmulatorLauncher.handle_input-788"><span class="linenos">788</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;filter&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-789"><a href="#EmulatorLauncher.handle_input-789"><span class="linenos">789</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">27</span><span class="p">:</span>  <span class="c1"># Escape key</span>
</span><span id="EmulatorLauncher.handle_input-790"><a href="#EmulatorLauncher.handle_input-790"><span class="linenos">790</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="EmulatorLauncher.handle_input-791"><a href="#EmulatorLauncher.handle_input-791"><span class="linenos">791</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="EmulatorLauncher.handle_input-792"><a href="#EmulatorLauncher.handle_input-792"><span class="linenos">792</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-793"><a href="#EmulatorLauncher.handle_input-793"><span class="linenos">793</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-794"><a href="#EmulatorLauncher.handle_input-794"><span class="linenos">794</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># Enter key in filter mode</span>
</span><span id="EmulatorLauncher.handle_input-795"><a href="#EmulatorLauncher.handle_input-795"><span class="linenos">795</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">launch_selected_rom</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">rom_list</span><span class="p">)</span>
</span><span id="EmulatorLauncher.handle_input-796"><a href="#EmulatorLauncher.handle_input-796"><span class="linenos">796</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_BACKSPACE</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">127</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-797"><a href="#EmulatorLauncher.handle_input-797"><span class="linenos">797</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-798"><a href="#EmulatorLauncher.handle_input-798"><span class="linenos">798</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="EmulatorLauncher.handle_input-799"><a href="#EmulatorLauncher.handle_input-799"><span class="linenos">799</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-800"><a href="#EmulatorLauncher.handle_input-800"><span class="linenos">800</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-801"><a href="#EmulatorLauncher.handle_input-801"><span class="linenos">801</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-802"><a href="#EmulatorLauncher.handle_input-802"><span class="linenos">802</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-803"><a href="#EmulatorLauncher.handle_input-803"><span class="linenos">803</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.handle_input-804"><a href="#EmulatorLauncher.handle_input-804"><span class="linenos">804</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-805"><a href="#EmulatorLauncher.handle_input-805"><span class="linenos">805</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">&lt;</span> <span class="n">num_roms</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-806"><a href="#EmulatorLauncher.handle_input-806"><span class="linenos">806</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.handle_input-807"><a href="#EmulatorLauncher.handle_input-807"><span class="linenos">807</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_F2</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-808"><a href="#EmulatorLauncher.handle_input-808"><span class="linenos">808</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-809"><a href="#EmulatorLauncher.handle_input-809"><span class="linenos">809</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-810"><a href="#EmulatorLauncher.handle_input-810"><span class="linenos">810</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">&gt;=</span> <span class="mi">32</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">&lt;=</span> <span class="mi">126</span><span class="p">:</span>  <span class="c1"># Printable characters</span>
</span><span id="EmulatorLauncher.handle_input-811"><a href="#EmulatorLauncher.handle_input-811"><span class="linenos">811</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="EmulatorLauncher.handle_input-812"><a href="#EmulatorLauncher.handle_input-812"><span class="linenos">812</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-813"><a href="#EmulatorLauncher.handle_input-813"><span class="linenos">813</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-814"><a href="#EmulatorLauncher.handle_input-814"><span class="linenos">814</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Navigate mode</span>
</span><span id="EmulatorLauncher.handle_input-815"><a href="#EmulatorLauncher.handle_input-815"><span class="linenos">815</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-816"><a href="#EmulatorLauncher.handle_input-816"><span class="linenos">816</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span> <span class="ow">and</span> <span class="n">num_roms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-817"><a href="#EmulatorLauncher.handle_input-817"><span class="linenos">817</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">num_roms</span>
</span><span id="EmulatorLauncher.handle_input-818"><a href="#EmulatorLauncher.handle_input-818"><span class="linenos">818</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-819"><a href="#EmulatorLauncher.handle_input-819"><span class="linenos">819</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-820"><a href="#EmulatorLauncher.handle_input-820"><span class="linenos">820</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher.handle_input-821"><a href="#EmulatorLauncher.handle_input-821"><span class="linenos">821</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">=</span> <span class="n">num_systems</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.handle_input-822"><a href="#EmulatorLauncher.handle_input-822"><span class="linenos">822</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-823"><a href="#EmulatorLauncher.handle_input-823"><span class="linenos">823</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-824"><a href="#EmulatorLauncher.handle_input-824"><span class="linenos">824</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">num_systems</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-825"><a href="#EmulatorLauncher.handle_input-825"><span class="linenos">825</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;favorites&quot;</span>
</span><span id="EmulatorLauncher.handle_input-826"><a href="#EmulatorLauncher.handle_input-826"><span class="linenos">826</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-827"><a href="#EmulatorLauncher.handle_input-827"><span class="linenos">827</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-828"><a href="#EmulatorLauncher.handle_input-828"><span class="linenos">828</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-829"><a href="#EmulatorLauncher.handle_input-829"><span class="linenos">829</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</span><span id="EmulatorLauncher.handle_input-830"><a href="#EmulatorLauncher.handle_input-830"><span class="linenos">830</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-831"><a href="#EmulatorLauncher.handle_input-831"><span class="linenos">831</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-832"><a href="#EmulatorLauncher.handle_input-832"><span class="linenos">832</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-833"><a href="#EmulatorLauncher.handle_input-833"><span class="linenos">833</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.handle_input-834"><a href="#EmulatorLauncher.handle_input-834"><span class="linenos">834</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-835"><a href="#EmulatorLauncher.handle_input-835"><span class="linenos">835</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-836"><a href="#EmulatorLauncher.handle_input-836"><span class="linenos">836</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span> <span class="ow">and</span> <span class="n">num_roms</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-837"><a href="#EmulatorLauncher.handle_input-837"><span class="linenos">837</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">num_roms</span>
</span><span id="EmulatorLauncher.handle_input-838"><a href="#EmulatorLauncher.handle_input-838"><span class="linenos">838</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-839"><a href="#EmulatorLauncher.handle_input-839"><span class="linenos">839</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;favorites&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-840"><a href="#EmulatorLauncher.handle_input-840"><span class="linenos">840</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</span><span id="EmulatorLauncher.handle_input-841"><a href="#EmulatorLauncher.handle_input-841"><span class="linenos">841</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-842"><a href="#EmulatorLauncher.handle_input-842"><span class="linenos">842</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-843"><a href="#EmulatorLauncher.handle_input-843"><span class="linenos">843</span></a>                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">num_systems</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-844"><a href="#EmulatorLauncher.handle_input-844"><span class="linenos">844</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher.handle_input-845"><a href="#EmulatorLauncher.handle_input-845"><span class="linenos">845</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-846"><a href="#EmulatorLauncher.handle_input-846"><span class="linenos">846</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-847"><a href="#EmulatorLauncher.handle_input-847"><span class="linenos">847</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-848"><a href="#EmulatorLauncher.handle_input-848"><span class="linenos">848</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.handle_input-849"><a href="#EmulatorLauncher.handle_input-849"><span class="linenos">849</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher.handle_input-850"><a href="#EmulatorLauncher.handle_input-850"><span class="linenos">850</span></a>                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">&lt;</span> <span class="n">num_systems</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.handle_input-851"><a href="#EmulatorLauncher.handle_input-851"><span class="linenos">851</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher.handle_input-852"><a href="#EmulatorLauncher.handle_input-852"><span class="linenos">852</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.handle_input-853"><a href="#EmulatorLauncher.handle_input-853"><span class="linenos">853</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-854"><a href="#EmulatorLauncher.handle_input-854"><span class="linenos">854</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-855"><a href="#EmulatorLauncher.handle_input-855"><span class="linenos">855</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.handle_input-856"><a href="#EmulatorLauncher.handle_input-856"><span class="linenos">856</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher.handle_input-857"><a href="#EmulatorLauncher.handle_input-857"><span class="linenos">857</span></a>                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span> <span class="o">==</span> <span class="n">num_systems</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="EmulatorLauncher.handle_input-858"><a href="#EmulatorLauncher.handle_input-858"><span class="linenos">858</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher.handle_input-859"><a href="#EmulatorLauncher.handle_input-859"><span class="linenos">859</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">=</span> <span class="s2">&quot;favorites&quot;</span>
</span><span id="EmulatorLauncher.handle_input-860"><a href="#EmulatorLauncher.handle_input-860"><span class="linenos">860</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-861"><a href="#EmulatorLauncher.handle_input-861"><span class="linenos">861</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-862"><a href="#EmulatorLauncher.handle_input-862"><span class="linenos">862</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-863"><a href="#EmulatorLauncher.handle_input-863"><span class="linenos">863</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="s2">&quot;systems&quot;</span>
</span><span id="EmulatorLauncher.handle_input-864"><a href="#EmulatorLauncher.handle_input-864"><span class="linenos">864</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-865"><a href="#EmulatorLauncher.handle_input-865"><span class="linenos">865</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">=</span> <span class="s2">&quot;roms&quot;</span>
</span><span id="EmulatorLauncher.handle_input-866"><a href="#EmulatorLauncher.handle_input-866"><span class="linenos">866</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
</span><span id="EmulatorLauncher.handle_input-867"><a href="#EmulatorLauncher.handle_input-867"><span class="linenos">867</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;filter&quot;</span>
</span><span id="EmulatorLauncher.handle_input-868"><a href="#EmulatorLauncher.handle_input-868"><span class="linenos">868</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="EmulatorLauncher.handle_input-869"><a href="#EmulatorLauncher.handle_input-869"><span class="linenos">869</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-870"><a href="#EmulatorLauncher.handle_input-870"><span class="linenos">870</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.handle_input-871"><a href="#EmulatorLauncher.handle_input-871"><span class="linenos">871</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># Enter key in navigate mode</span>
</span><span id="EmulatorLauncher.handle_input-872"><a href="#EmulatorLauncher.handle_input-872"><span class="linenos">872</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">launch_selected_rom</span><span class="p">(</span><span class="n">systems</span><span class="p">,</span> <span class="n">rom_list</span><span class="p">)</span>
</span><span id="EmulatorLauncher.handle_input-873"><a href="#EmulatorLauncher.handle_input-873"><span class="linenos">873</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_F2</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-874"><a href="#EmulatorLauncher.handle_input-874"><span class="linenos">874</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.handle_input-875"><a href="#EmulatorLauncher.handle_input-875"><span class="linenos">875</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">toggle_favorite</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-876"><a href="#EmulatorLauncher.handle_input-876"><span class="linenos">876</span></a>
</span><span id="EmulatorLauncher.handle_input-877"><a href="#EmulatorLauncher.handle_input-877"><span class="linenos">877</span></a>            <span class="c1"># Update timestamp if any selection state changed</span>
</span><span id="EmulatorLauncher.handle_input-878"><a href="#EmulatorLauncher.handle_input-878"><span class="linenos">878</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.handle_input-879"><a href="#EmulatorLauncher.handle_input-879"><span class="linenos">879</span></a>            <span class="n">prev_selected_rom</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span>
</span><span id="EmulatorLauncher.handle_input-880"><a href="#EmulatorLauncher.handle_input-880"><span class="linenos">880</span></a>            <span class="ow">or</span> <span class="n">prev_view_mode</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span>
</span><span id="EmulatorLauncher.handle_input-881"><a href="#EmulatorLauncher.handle_input-881"><span class="linenos">881</span></a>            <span class="ow">or</span> <span class="n">prev_selected_system</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span>
</span><span id="EmulatorLauncher.handle_input-882"><a href="#EmulatorLauncher.handle_input-882"><span class="linenos">882</span></a>        <span class="p">):</span>
</span><span id="EmulatorLauncher.handle_input-883"><a href="#EmulatorLauncher.handle_input-883"><span class="linenos">883</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_selection_change_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-884"><a href="#EmulatorLauncher.handle_input-884"><span class="linenos">884</span></a>
</span><span id="EmulatorLauncher.handle_input-885"><a href="#EmulatorLauncher.handle_input-885"><span class="linenos">885</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-886"><a href="#EmulatorLauncher.handle_input-886"><span class="linenos">886</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_system_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher.handle_input-887"><a href="#EmulatorLauncher.handle_input-887"><span class="linenos">887</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Handles user input for navigating and filtering ROMs.
Parameters:
key (int): The key code of the pressed key.
Behavior:</p>

<ul>
<li>In "filter" mode:
<ul>
<li>Escape key (27): Switch to "navigate" mode, clear filter string, update filtered ROMs, and reset selected ROM.</li>
<li>Enter key (10): Launch the selected ROM.</li>
<li>Backspace key (curses.KEY_BACKSPACE, 127, 8): Remove the last character from the filter string, update filtered ROMs, and reset selected ROM.</li>
<li>Up key (curses.KEY_UP): Move the selection up in the filtered ROM list.</li>
<li>Down key (curses.KEY_DOWN): Move the selection down in the filtered ROM list.</li>
<li>F2 key (curses.KEY_F2): Toggle favorite status of the selected ROM if focus is on ROMs.</li>
<li>Printable characters (32-126): Append the character to the filter string, update filtered ROMs, and reset selected ROM.</li>
</ul></li>
<li>In "navigate" mode:
<ul>
<li>Up key (curses.KEY_UP): Navigate through ROMs or switch view modes and systems.</li>
<li>Down key (curses.KEY_DOWN): Navigate through ROMs or switch view modes and systems.</li>
<li>Left key (curses.KEY_LEFT): Set focus to systems.</li>
<li>Right key (curses.KEY_RIGHT): Set focus to ROMs.</li>
<li>Slash key (ord("/")): Switch to "filter" mode, clear filter string, update filtered ROMs, and reset selected ROM.</li>
<li>Enter key (10): Launch the selected ROM.</li>
<li>F2 key (curses.KEY_F2): Toggle favorite status of the selected ROM if focus is on ROMs.
Updates:</li>
</ul></li>
<li>Updates the timestamp if any selection state changes.</li>
<li>Redraws the ROM window, system window, and filter bar.</li>
</ul>
</div>


                            </div>
                            <div id="EmulatorLauncher.launch_selected_rom" class="classattr">
                                        <input id="EmulatorLauncher.launch_selected_rom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">launch_selected_rom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">systems</span>, </span><span class="param"><span class="n">rom_list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.launch_selected_rom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.launch_selected_rom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.launch_selected_rom-889"><a href="#EmulatorLauncher.launch_selected_rom-889"><span class="linenos">889</span></a>    <span class="k">def</span> <span class="nf">launch_selected_rom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">systems</span><span class="p">,</span> <span class="n">rom_list</span><span class="p">):</span>
</span><span id="EmulatorLauncher.launch_selected_rom-890"><a href="#EmulatorLauncher.launch_selected_rom-890"><span class="linenos">890</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.launch_selected_rom-891"><a href="#EmulatorLauncher.launch_selected_rom-891"><span class="linenos">891</span></a><span class="sd">        Launches the selected ROM using the appropriate emulator configuration.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-892"><a href="#EmulatorLauncher.launch_selected_rom-892"><span class="linenos">892</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-893"><a href="#EmulatorLauncher.launch_selected_rom-893"><span class="linenos">893</span></a><span class="sd">            systems (list): A list of available systems.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-894"><a href="#EmulatorLauncher.launch_selected_rom-894"><span class="linenos">894</span></a><span class="sd">            rom_list (list): A list of ROMs available for the selected system.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-895"><a href="#EmulatorLauncher.launch_selected_rom-895"><span class="linenos">895</span></a><span class="sd">        Preconditions:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-896"><a href="#EmulatorLauncher.launch_selected_rom-896"><span class="linenos">896</span></a><span class="sd">            - `self.focus` must be &quot;roms&quot;.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-897"><a href="#EmulatorLauncher.launch_selected_rom-897"><span class="linenos">897</span></a><span class="sd">            - `self.emulator_process` must be None.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-898"><a href="#EmulatorLauncher.launch_selected_rom-898"><span class="linenos">898</span></a><span class="sd">            - `rom_list` must not be empty.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-899"><a href="#EmulatorLauncher.launch_selected_rom-899"><span class="linenos">899</span></a><span class="sd">        Behavior:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-900"><a href="#EmulatorLauncher.launch_selected_rom-900"><span class="linenos">900</span></a><span class="sd">            - If `self.view_mode` is &quot;systems&quot;:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-901"><a href="#EmulatorLauncher.launch_selected_rom-901"><span class="linenos">901</span></a><span class="sd">                - Retrieves the system configuration for the selected system.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-902"><a href="#EmulatorLauncher.launch_selected_rom-902"><span class="linenos">902</span></a><span class="sd">                - Launches the ROM using the emulator path and launch arguments from the system configuration.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-903"><a href="#EmulatorLauncher.launch_selected_rom-903"><span class="linenos">903</span></a><span class="sd">            - If `self.view_mode` is &quot;favorites&quot; or &quot;all&quot;:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-904"><a href="#EmulatorLauncher.launch_selected_rom-904"><span class="linenos">904</span></a><span class="sd">                - Retrieves the system and ROM path for the selected ROM.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-905"><a href="#EmulatorLauncher.launch_selected_rom-905"><span class="linenos">905</span></a><span class="sd">                - Launches the ROM using the emulator path and launch arguments from the system configuration.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-906"><a href="#EmulatorLauncher.launch_selected_rom-906"><span class="linenos">906</span></a><span class="sd">        Postconditions:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-907"><a href="#EmulatorLauncher.launch_selected_rom-907"><span class="linenos">907</span></a><span class="sd">            - Clears the filter string.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-908"><a href="#EmulatorLauncher.launch_selected_rom-908"><span class="linenos">908</span></a><span class="sd">            - Updates the filtered ROMs list.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-909"><a href="#EmulatorLauncher.launch_selected_rom-909"><span class="linenos">909</span></a><span class="sd">            - Resets the selected ROM index to 0.</span>
</span><span id="EmulatorLauncher.launch_selected_rom-910"><a href="#EmulatorLauncher.launch_selected_rom-910"><span class="linenos">910</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.launch_selected_rom-911"><a href="#EmulatorLauncher.launch_selected_rom-911"><span class="linenos">911</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span> <span class="o">==</span> <span class="s2">&quot;roms&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-912"><a href="#EmulatorLauncher.launch_selected_rom-912"><span class="linenos">912</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="o">==</span> <span class="s2">&quot;systems&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-913"><a href="#EmulatorLauncher.launch_selected_rom-913"><span class="linenos">913</span></a>                <span class="n">system_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;systems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span><span id="EmulatorLauncher.launch_selected_rom-914"><a href="#EmulatorLauncher.launch_selected_rom-914"><span class="linenos">914</span></a>                    <span class="n">systems</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_system</span><span class="p">]</span>
</span><span id="EmulatorLauncher.launch_selected_rom-915"><a href="#EmulatorLauncher.launch_selected_rom-915"><span class="linenos">915</span></a>                <span class="p">)</span>
</span><span id="EmulatorLauncher.launch_selected_rom-916"><a href="#EmulatorLauncher.launch_selected_rom-916"><span class="linenos">916</span></a>                <span class="k">if</span> <span class="n">system_config</span> <span class="ow">and</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-917"><a href="#EmulatorLauncher.launch_selected_rom-917"><span class="linenos">917</span></a>                    <span class="n">start_in_directory</span> <span class="o">=</span> <span class="n">system_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_in&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher.launch_selected_rom-918"><a href="#EmulatorLauncher.launch_selected_rom-918"><span class="linenos">918</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">launch_rom</span><span class="p">(</span>
</span><span id="EmulatorLauncher.launch_selected_rom-919"><a href="#EmulatorLauncher.launch_selected_rom-919"><span class="linenos">919</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;emulator_path&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher.launch_selected_rom-920"><a href="#EmulatorLauncher.launch_selected_rom-920"><span class="linenos">920</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;launch_arguments&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher.launch_selected_rom-921"><a href="#EmulatorLauncher.launch_selected_rom-921"><span class="linenos">921</span></a>                        <span class="n">rom_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">],</span>
</span><span id="EmulatorLauncher.launch_selected_rom-922"><a href="#EmulatorLauncher.launch_selected_rom-922"><span class="linenos">922</span></a>                        <span class="n">start_in_directory</span><span class="p">,</span>
</span><span id="EmulatorLauncher.launch_selected_rom-923"><a href="#EmulatorLauncher.launch_selected_rom-923"><span class="linenos">923</span></a>                    <span class="p">)</span>
</span><span id="EmulatorLauncher.launch_selected_rom-924"><a href="#EmulatorLauncher.launch_selected_rom-924"><span class="linenos">924</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">view_mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;favorites&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">rom_list</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-925"><a href="#EmulatorLauncher.launch_selected_rom-925"><span class="linenos">925</span></a>                <span class="n">system</span><span class="p">,</span> <span class="n">rom_path</span> <span class="o">=</span> <span class="n">rom_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span><span class="p">]</span>
</span><span id="EmulatorLauncher.launch_selected_rom-926"><a href="#EmulatorLauncher.launch_selected_rom-926"><span class="linenos">926</span></a>                <span class="n">system_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;systems&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span><span id="EmulatorLauncher.launch_selected_rom-927"><a href="#EmulatorLauncher.launch_selected_rom-927"><span class="linenos">927</span></a>                <span class="k">if</span> <span class="n">system_config</span><span class="p">:</span>
</span><span id="EmulatorLauncher.launch_selected_rom-928"><a href="#EmulatorLauncher.launch_selected_rom-928"><span class="linenos">928</span></a>                    <span class="n">start_in_directory</span> <span class="o">=</span> <span class="n">system_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start_in&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher.launch_selected_rom-929"><a href="#EmulatorLauncher.launch_selected_rom-929"><span class="linenos">929</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">launch_rom</span><span class="p">(</span>
</span><span id="EmulatorLauncher.launch_selected_rom-930"><a href="#EmulatorLauncher.launch_selected_rom-930"><span class="linenos">930</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;emulator_path&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher.launch_selected_rom-931"><a href="#EmulatorLauncher.launch_selected_rom-931"><span class="linenos">931</span></a>                        <span class="n">system_config</span><span class="p">[</span><span class="s2">&quot;launch_arguments&quot;</span><span class="p">],</span>
</span><span id="EmulatorLauncher.launch_selected_rom-932"><a href="#EmulatorLauncher.launch_selected_rom-932"><span class="linenos">932</span></a>                        <span class="n">rom_path</span><span class="p">,</span>
</span><span id="EmulatorLauncher.launch_selected_rom-933"><a href="#EmulatorLauncher.launch_selected_rom-933"><span class="linenos">933</span></a>                        <span class="n">start_in_directory</span><span class="p">,</span>
</span><span id="EmulatorLauncher.launch_selected_rom-934"><a href="#EmulatorLauncher.launch_selected_rom-934"><span class="linenos">934</span></a>                    <span class="p">)</span>
</span><span id="EmulatorLauncher.launch_selected_rom-935"><a href="#EmulatorLauncher.launch_selected_rom-935"><span class="linenos">935</span></a>
</span><span id="EmulatorLauncher.launch_selected_rom-936"><a href="#EmulatorLauncher.launch_selected_rom-936"><span class="linenos">936</span></a>            <span class="c1"># Clear filter and update display after launching</span>
</span><span id="EmulatorLauncher.launch_selected_rom-937"><a href="#EmulatorLauncher.launch_selected_rom-937"><span class="linenos">937</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="EmulatorLauncher.launch_selected_rom-938"><a href="#EmulatorLauncher.launch_selected_rom-938"><span class="linenos">938</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="EmulatorLauncher.launch_selected_rom-939"><a href="#EmulatorLauncher.launch_selected_rom-939"><span class="linenos">939</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.launch_selected_rom-940"><a href="#EmulatorLauncher.launch_selected_rom-940"><span class="linenos">940</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">selected_rom</span> <span class="o">=</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Launches the selected ROM using the appropriate emulator configuration.
Args:
    systems (list): A list of available systems.
    rom_list (list): A list of ROMs available for the selected system.
Preconditions:
    - <code>self.focus</code> must be "roms".
    - <code>self.emulator_process</code> must be None.
    - <code>rom_list</code> must not be empty.
Behavior:
    - If <code>self.view_mode</code> is "systems":
        - Retrieves the system configuration for the selected system.
        - Launches the ROM using the emulator path and launch arguments from the system configuration.
    - If <code>self.view_mode</code> is "favorites" or "all":
        - Retrieves the system and ROM path for the selected ROM.
        - Launches the ROM using the emulator path and launch arguments from the system configuration.
Postconditions:
    - Clears the filter string.
    - Updates the filtered ROMs list.
    - Resets the selected ROM index to 0.</p>
</div>


                            </div>
                            <div id="EmulatorLauncher.draw_filter_bar" class="classattr">
                                        <input id="EmulatorLauncher.draw_filter_bar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_filter_bar</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.draw_filter_bar-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.draw_filter_bar"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.draw_filter_bar-942"><a href="#EmulatorLauncher.draw_filter_bar-942"><span class="linenos">942</span></a>    <span class="k">def</span> <span class="nf">draw_filter_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="EmulatorLauncher.draw_filter_bar-943"><a href="#EmulatorLauncher.draw_filter_bar-943"><span class="linenos">943</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.draw_filter_bar-944"><a href="#EmulatorLauncher.draw_filter_bar-944"><span class="linenos">944</span></a><span class="sd">        Draws the filter bar at the bottom of the terminal window.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-945"><a href="#EmulatorLauncher.draw_filter_bar-945"><span class="linenos">945</span></a><span class="sd">        This method clears the current status bar, sets the appropriate style,</span>
</span><span id="EmulatorLauncher.draw_filter_bar-946"><a href="#EmulatorLauncher.draw_filter_bar-946"><span class="linenos">946</span></a><span class="sd">        and displays the current status based on the mode (filter or ready).</span>
</span><span id="EmulatorLauncher.draw_filter_bar-947"><a href="#EmulatorLauncher.draw_filter_bar-947"><span class="linenos">947</span></a><span class="sd">        It also ensures that the status bar text fits within the window width.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-948"><a href="#EmulatorLauncher.draw_filter_bar-948"><span class="linenos">948</span></a><span class="sd">        The status bar displays different information based on the mode:</span>
</span><span id="EmulatorLauncher.draw_filter_bar-949"><a href="#EmulatorLauncher.draw_filter_bar-949"><span class="linenos">949</span></a><span class="sd">        - In &quot;filter&quot; mode, it shows the filter string and the current ROM count.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-950"><a href="#EmulatorLauncher.draw_filter_bar-950"><span class="linenos">950</span></a><span class="sd">        - In &quot;ready&quot; mode, it shows a ready message and the current ROM count.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-951"><a href="#EmulatorLauncher.draw_filter_bar-951"><span class="linenos">951</span></a><span class="sd">        The status bar also includes help text with key bindings for various actions.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-952"><a href="#EmulatorLauncher.draw_filter_bar-952"><span class="linenos">952</span></a><span class="sd">        Attributes:</span>
</span><span id="EmulatorLauncher.draw_filter_bar-953"><a href="#EmulatorLauncher.draw_filter_bar-953"><span class="linenos">953</span></a><span class="sd">            height (int): The height of the terminal window.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-954"><a href="#EmulatorLauncher.draw_filter_bar-954"><span class="linenos">954</span></a><span class="sd">            width (int): The width of the terminal window.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-955"><a href="#EmulatorLauncher.draw_filter_bar-955"><span class="linenos">955</span></a><span class="sd">            current_rom (int): The index of the current ROM.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-956"><a href="#EmulatorLauncher.draw_filter_bar-956"><span class="linenos">956</span></a><span class="sd">            counter (str): The string representing the current ROM count.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-957"><a href="#EmulatorLauncher.draw_filter_bar-957"><span class="linenos">957</span></a><span class="sd">            status (str): The status message to be displayed.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-958"><a href="#EmulatorLauncher.draw_filter_bar-958"><span class="linenos">958</span></a><span class="sd">            help_text (str): The help text with key bindings.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-959"><a href="#EmulatorLauncher.draw_filter_bar-959"><span class="linenos">959</span></a><span class="sd">            total_length (int): The total length of the status and help text.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-960"><a href="#EmulatorLauncher.draw_filter_bar-960"><span class="linenos">960</span></a><span class="sd">            padding (int): The padding to ensure the text fits within the window width.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-961"><a href="#EmulatorLauncher.draw_filter_bar-961"><span class="linenos">961</span></a><span class="sd">            final_text (str): The final text to be displayed on the status bar.</span>
</span><span id="EmulatorLauncher.draw_filter_bar-962"><a href="#EmulatorLauncher.draw_filter_bar-962"><span class="linenos">962</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.draw_filter_bar-963"><a href="#EmulatorLauncher.draw_filter_bar-963"><span class="linenos">963</span></a>        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()</span>
</span><span id="EmulatorLauncher.draw_filter_bar-964"><a href="#EmulatorLauncher.draw_filter_bar-964"><span class="linenos">964</span></a>
</span><span id="EmulatorLauncher.draw_filter_bar-965"><a href="#EmulatorLauncher.draw_filter_bar-965"><span class="linenos">965</span></a>        <span class="c1"># Clear the status bar</span>
</span><span id="EmulatorLauncher.draw_filter_bar-966"><a href="#EmulatorLauncher.draw_filter_bar-966"><span class="linenos">966</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_filter_bar-967"><a href="#EmulatorLauncher.draw_filter_bar-967"><span class="linenos">967</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">clrtoeol</span><span class="p">()</span>
</span><span id="EmulatorLauncher.draw_filter_bar-968"><a href="#EmulatorLauncher.draw_filter_bar-968"><span class="linenos">968</span></a>
</span><span id="EmulatorLauncher.draw_filter_bar-969"><a href="#EmulatorLauncher.draw_filter_bar-969"><span class="linenos">969</span></a>        <span class="c1"># Set status bar style</span>
</span><span id="EmulatorLauncher.draw_filter_bar-970"><a href="#EmulatorLauncher.draw_filter_bar-970"><span class="linenos">970</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">attron</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">STATUS_BAR</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="EmulatorLauncher.draw_filter_bar-971"><a href="#EmulatorLauncher.draw_filter_bar-971"><span class="linenos">971</span></a>
</span><span id="EmulatorLauncher.draw_filter_bar-972"><a href="#EmulatorLauncher.draw_filter_bar-972"><span class="linenos">972</span></a>        <span class="n">current_rom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_rom_index</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.draw_filter_bar-973"><a href="#EmulatorLauncher.draw_filter_bar-973"><span class="linenos">973</span></a>        <span class="n">counter</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">current_rom</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_roms</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher.draw_filter_bar-974"><a href="#EmulatorLauncher.draw_filter_bar-974"><span class="linenos">974</span></a>
</span><span id="EmulatorLauncher.draw_filter_bar-975"><a href="#EmulatorLauncher.draw_filter_bar-975"><span class="linenos">975</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;filter&quot;</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_filter_bar-976"><a href="#EmulatorLauncher.draw_filter_bar-976"><span class="linenos">976</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; / </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_string</span><span class="si">}{</span><span class="n">counter</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher.draw_filter_bar-977"><a href="#EmulatorLauncher.draw_filter_bar-977"><span class="linenos">977</span></a>            <span class="n">help_text</span> <span class="o">=</span> <span class="s2">&quot;ESC:Exit  ENTER/A:Launch  F2/X:Favorite  Q/B:Quit&quot;</span>
</span><span id="EmulatorLauncher.draw_filter_bar-978"><a href="#EmulatorLauncher.draw_filter_bar-978"><span class="linenos">978</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.draw_filter_bar-979"><a href="#EmulatorLauncher.draw_filter_bar-979"><span class="linenos">979</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; Ready</span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="EmulatorLauncher.draw_filter_bar-980"><a href="#EmulatorLauncher.draw_filter_bar-980"><span class="linenos">980</span></a>            <span class="n">help_text</span> <span class="o">=</span> <span class="s2">&quot;/:Search  ENTER/A:Launch  F2/X:Favorite  Q/B:Quit&quot;</span>
</span><span id="EmulatorLauncher.draw_filter_bar-981"><a href="#EmulatorLauncher.draw_filter_bar-981"><span class="linenos">981</span></a>
</span><span id="EmulatorLauncher.draw_filter_bar-982"><a href="#EmulatorLauncher.draw_filter_bar-982"><span class="linenos">982</span></a>        <span class="c1"># Calculate padding, ensuring we don&#39;t exceed the window width</span>
</span><span id="EmulatorLauncher.draw_filter_bar-983"><a href="#EmulatorLauncher.draw_filter_bar-983"><span class="linenos">983</span></a>        <span class="n">total_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">help_text</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_filter_bar-984"><a href="#EmulatorLauncher.draw_filter_bar-984"><span class="linenos">984</span></a>        <span class="n">padding</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span> <span class="o">-</span> <span class="n">total_length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Leave one character at the end</span>
</span><span id="EmulatorLauncher.draw_filter_bar-985"><a href="#EmulatorLauncher.draw_filter_bar-985"><span class="linenos">985</span></a>
</span><span id="EmulatorLauncher.draw_filter_bar-986"><a href="#EmulatorLauncher.draw_filter_bar-986"><span class="linenos">986</span></a>        <span class="c1"># Ensure we don&#39;t write beyond the last column</span>
</span><span id="EmulatorLauncher.draw_filter_bar-987"><a href="#EmulatorLauncher.draw_filter_bar-987"><span class="linenos">987</span></a>        <span class="n">final_text</span> <span class="o">=</span> <span class="p">(</span><span class="n">status</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">help_text</span><span class="p">)[:</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="EmulatorLauncher.draw_filter_bar-988"><a href="#EmulatorLauncher.draw_filter_bar-988"><span class="linenos">988</span></a>
</span><span id="EmulatorLauncher.draw_filter_bar-989"><a href="#EmulatorLauncher.draw_filter_bar-989"><span class="linenos">989</span></a>        <span class="c1"># Draw status bar</span>
</span><span id="EmulatorLauncher.draw_filter_bar-990"><a href="#EmulatorLauncher.draw_filter_bar-990"><span class="linenos">990</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">final_text</span><span class="p">)</span>
</span><span id="EmulatorLauncher.draw_filter_bar-991"><a href="#EmulatorLauncher.draw_filter_bar-991"><span class="linenos">991</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">attroff</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">color_pair</span><span class="p">(</span><span class="n">Colors</span><span class="o">.</span><span class="n">STATUS_BAR</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</span><span id="EmulatorLauncher.draw_filter_bar-992"><a href="#EmulatorLauncher.draw_filter_bar-992"><span class="linenos">992</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Draws the filter bar at the bottom of the terminal window.
This method clears the current status bar, sets the appropriate style,
and displays the current status based on the mode (filter or ready).
It also ensures that the status bar text fits within the window width.
The status bar displays different information based on the mode:</p>

<ul>
<li>In "filter" mode, it shows the filter string and the current ROM count.</li>
<li>In "ready" mode, it shows a ready message and the current ROM count.
The status bar also includes help text with key bindings for various actions.
Attributes:
height (int): The height of the terminal window.
width (int): The width of the terminal window.
current_rom (int): The index of the current ROM.
counter (str): The string representing the current ROM count.
status (str): The status message to be displayed.
help_text (str): The help text with key bindings.
total_length (int): The total length of the status and help text.
padding (int): The padding to ensure the text fits within the window width.
final_text (str): The final text to be displayed on the status bar.</li>
</ul>
</div>


                            </div>
                            <div id="EmulatorLauncher.main" class="classattr">
                                        <input id="EmulatorLauncher.main-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">main</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">stdscr</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="EmulatorLauncher.main-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#EmulatorLauncher.main"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="EmulatorLauncher.main-994"><a href="#EmulatorLauncher.main-994"><span class="linenos"> 994</span></a>    <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stdscr</span><span class="p">):</span>
</span><span id="EmulatorLauncher.main-995"><a href="#EmulatorLauncher.main-995"><span class="linenos"> 995</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.main-996"><a href="#EmulatorLauncher.main-996"><span class="linenos"> 996</span></a><span class="sd">        Main function to initialize and run the ROM launcher interface.</span>
</span><span id="EmulatorLauncher.main-997"><a href="#EmulatorLauncher.main-997"><span class="linenos"> 997</span></a><span class="sd">        Args:</span>
</span><span id="EmulatorLauncher.main-998"><a href="#EmulatorLauncher.main-998"><span class="linenos"> 998</span></a><span class="sd">            stdscr: The standard screen object provided by curses.</span>
</span><span id="EmulatorLauncher.main-999"><a href="#EmulatorLauncher.main-999"><span class="linenos"> 999</span></a><span class="sd">        This function sets up the curses environment, initializes pygame for gamepad support,</span>
</span><span id="EmulatorLauncher.main-1000"><a href="#EmulatorLauncher.main-1000"><span class="linenos">1000</span></a><span class="sd">        and enters the main loop to handle user input and update the display. It supports both</span>
</span><span id="EmulatorLauncher.main-1001"><a href="#EmulatorLauncher.main-1001"><span class="linenos">1001</span></a><span class="sd">        keyboard and gamepad inputs, with auto-repeat functionality for gamepad D-pad and joystick axes.</span>
</span><span id="EmulatorLauncher.main-1002"><a href="#EmulatorLauncher.main-1002"><span class="linenos">1002</span></a><span class="sd">        The interface is divided into two windows: one for system selection and one for ROM selection.</span>
</span><span id="EmulatorLauncher.main-1003"><a href="#EmulatorLauncher.main-1003"><span class="linenos">1003</span></a><span class="sd">        The function also handles window resizing and checks for the completion of the emulator process.</span>
</span><span id="EmulatorLauncher.main-1004"><a href="#EmulatorLauncher.main-1004"><span class="linenos">1004</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="EmulatorLauncher.main-1005"><a href="#EmulatorLauncher.main-1005"><span class="linenos">1005</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stdscr</span> <span class="o">=</span> <span class="n">stdscr</span>
</span><span id="EmulatorLauncher.main-1006"><a href="#EmulatorLauncher.main-1006"><span class="linenos">1006</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">keypad</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1007"><a href="#EmulatorLauncher.main-1007"><span class="linenos">1007</span></a>        <span class="n">curses</span><span class="o">.</span><span class="n">curs_set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1008"><a href="#EmulatorLauncher.main-1008"><span class="linenos">1008</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">init_colors</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1009"><a href="#EmulatorLauncher.main-1009"><span class="linenos">1009</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1010"><a href="#EmulatorLauncher.main-1010"><span class="linenos">1010</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1011"><a href="#EmulatorLauncher.main-1011"><span class="linenos">1011</span></a>
</span><span id="EmulatorLauncher.main-1012"><a href="#EmulatorLauncher.main-1012"><span class="linenos">1012</span></a>        <span class="c1"># Initialize pygame for gamepad support.</span>
</span><span id="EmulatorLauncher.main-1013"><a href="#EmulatorLauncher.main-1013"><span class="linenos">1013</span></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1014"><a href="#EmulatorLauncher.main-1014"><span class="linenos">1014</span></a>        <span class="n">pygame</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1015"><a href="#EmulatorLauncher.main-1015"><span class="linenos">1015</span></a>        <span class="k">if</span> <span class="n">pygame</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1016"><a href="#EmulatorLauncher.main-1016"><span class="linenos">1016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">Joystick</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1017"><a href="#EmulatorLauncher.main-1017"><span class="linenos">1017</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1018"><a href="#EmulatorLauncher.main-1018"><span class="linenos">1018</span></a>            <span class="c1"># print(&quot;Controller connected:&quot;, self.joystick.get_name())</span>
</span><span id="EmulatorLauncher.main-1019"><a href="#EmulatorLauncher.main-1019"><span class="linenos">1019</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1020"><a href="#EmulatorLauncher.main-1020"><span class="linenos">1020</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher.main-1021"><a href="#EmulatorLauncher.main-1021"><span class="linenos">1021</span></a>            <span class="c1"># print(&quot;No controller found.&quot;)</span>
</span><span id="EmulatorLauncher.main-1022"><a href="#EmulatorLauncher.main-1022"><span class="linenos">1022</span></a>
</span><span id="EmulatorLauncher.main-1023"><a href="#EmulatorLauncher.main-1023"><span class="linenos">1023</span></a>        <span class="n">stdscr</span><span class="o">.</span><span class="n">nodelay</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1024"><a href="#EmulatorLauncher.main-1024"><span class="linenos">1024</span></a>
</span><span id="EmulatorLauncher.main-1025"><a href="#EmulatorLauncher.main-1025"><span class="linenos">1025</span></a>        <span class="c1"># Calculate split for windows.</span>
</span><span id="EmulatorLauncher.main-1026"><a href="#EmulatorLauncher.main-1026"><span class="linenos">1026</span></a>        <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1027"><a href="#EmulatorLauncher.main-1027"><span class="linenos">1027</span></a>        <span class="n">system_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">4</span>
</span><span id="EmulatorLauncher.main-1028"><a href="#EmulatorLauncher.main-1028"><span class="linenos">1028</span></a>        <span class="n">rom_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">system_width</span>
</span><span id="EmulatorLauncher.main-1029"><a href="#EmulatorLauncher.main-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">system_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1030"><a href="#EmulatorLauncher.main-1030"><span class="linenos">1030</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rom_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">system_width</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1031"><a href="#EmulatorLauncher.main-1031"><span class="linenos">1031</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="EmulatorLauncher.main-1032"><a href="#EmulatorLauncher.main-1032"><span class="linenos">1032</span></a>
</span><span id="EmulatorLauncher.main-1033"><a href="#EmulatorLauncher.main-1033"><span class="linenos">1033</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1034"><a href="#EmulatorLauncher.main-1034"><span class="linenos">1034</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_system_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1035"><a href="#EmulatorLauncher.main-1035"><span class="linenos">1035</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1036"><a href="#EmulatorLauncher.main-1036"><span class="linenos">1036</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1037"><a href="#EmulatorLauncher.main-1037"><span class="linenos">1037</span></a>
</span><span id="EmulatorLauncher.main-1038"><a href="#EmulatorLauncher.main-1038"><span class="linenos">1038</span></a>        <span class="c1"># Timing parameters (in seconds)</span>
</span><span id="EmulatorLauncher.main-1039"><a href="#EmulatorLauncher.main-1039"><span class="linenos">1039</span></a>        <span class="n">initial_delay</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># Delay before auto-repeat kicks in</span>
</span><span id="EmulatorLauncher.main-1040"><a href="#EmulatorLauncher.main-1040"><span class="linenos">1040</span></a>        <span class="n">repeat_interval</span> <span class="o">=</span> <span class="mf">0.04</span>  <span class="c1"># Interval between repeats after initial delay</span>
</span><span id="EmulatorLauncher.main-1041"><a href="#EmulatorLauncher.main-1041"><span class="linenos">1041</span></a>
</span><span id="EmulatorLauncher.main-1042"><a href="#EmulatorLauncher.main-1042"><span class="linenos">1042</span></a>        <span class="c1"># Timing parameters for scroll updates</span>
</span><span id="EmulatorLauncher.main-1043"><a href="#EmulatorLauncher.main-1043"><span class="linenos">1043</span></a>        <span class="n">last_scroll_time</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1044"><a href="#EmulatorLauncher.main-1044"><span class="linenos">1044</span></a>        <span class="n">scroll_interval</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># 100 milliseconds</span>
</span><span id="EmulatorLauncher.main-1045"><a href="#EmulatorLauncher.main-1045"><span class="linenos">1045</span></a>
</span><span id="EmulatorLauncher.main-1046"><a href="#EmulatorLauncher.main-1046"><span class="linenos">1046</span></a>        <span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="EmulatorLauncher.main-1047"><a href="#EmulatorLauncher.main-1047"><span class="linenos">1047</span></a>
</span><span id="EmulatorLauncher.main-1048"><a href="#EmulatorLauncher.main-1048"><span class="linenos">1048</span></a>        <span class="k">while</span> <span class="n">running</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1049"><a href="#EmulatorLauncher.main-1049"><span class="linenos">1049</span></a>            <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1050"><a href="#EmulatorLauncher.main-1050"><span class="linenos">1050</span></a>
</span><span id="EmulatorLauncher.main-1051"><a href="#EmulatorLauncher.main-1051"><span class="linenos">1051</span></a>            <span class="k">if</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">last_scroll_time</span> <span class="o">&gt;=</span> <span class="n">scroll_interval</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1052"><a href="#EmulatorLauncher.main-1052"><span class="linenos">1052</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1053"><a href="#EmulatorLauncher.main-1053"><span class="linenos">1053</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1054"><a href="#EmulatorLauncher.main-1054"><span class="linenos">1054</span></a>                <span class="n">last_scroll_time</span> <span class="o">=</span> <span class="n">current_time</span>
</span><span id="EmulatorLauncher.main-1055"><a href="#EmulatorLauncher.main-1055"><span class="linenos">1055</span></a>
</span><span id="EmulatorLauncher.main-1056"><a href="#EmulatorLauncher.main-1056"><span class="linenos">1056</span></a>            <span class="c1"># Process keyboard input.</span>
</span><span id="EmulatorLauncher.main-1057"><a href="#EmulatorLauncher.main-1057"><span class="linenos">1057</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getch</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1058"><a href="#EmulatorLauncher.main-1058"><span class="linenos">1058</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1059"><a href="#EmulatorLauncher.main-1059"><span class="linenos">1059</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="n">curses</span><span class="o">.</span><span class="n">KEY_RESIZE</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1060"><a href="#EmulatorLauncher.main-1060"><span class="linenos">1060</span></a>                    <span class="c1"># Handle window resize</span>
</span><span id="EmulatorLauncher.main-1061"><a href="#EmulatorLauncher.main-1061"><span class="linenos">1061</span></a>                    <span class="n">curses</span><span class="o">.</span><span class="n">resize_term</span><span class="p">(</span><span class="o">*</span><span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">())</span>
</span><span id="EmulatorLauncher.main-1062"><a href="#EmulatorLauncher.main-1062"><span class="linenos">1062</span></a>                    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getmaxyx</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1063"><a href="#EmulatorLauncher.main-1063"><span class="linenos">1063</span></a>                    <span class="n">system_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">4</span>
</span><span id="EmulatorLauncher.main-1064"><a href="#EmulatorLauncher.main-1064"><span class="linenos">1064</span></a>                    <span class="n">rom_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">system_width</span>
</span><span id="EmulatorLauncher.main-1065"><a href="#EmulatorLauncher.main-1065"><span class="linenos">1065</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">system_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">system_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1066"><a href="#EmulatorLauncher.main-1066"><span class="linenos">1066</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">rom_window</span> <span class="o">=</span> <span class="n">curses</span><span class="o">.</span><span class="n">newwin</span><span class="p">(</span>
</span><span id="EmulatorLauncher.main-1067"><a href="#EmulatorLauncher.main-1067"><span class="linenos">1067</span></a>                        <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rom_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">system_width</span>
</span><span id="EmulatorLauncher.main-1068"><a href="#EmulatorLauncher.main-1068"><span class="linenos">1068</span></a>                    <span class="p">)</span>
</span><span id="EmulatorLauncher.main-1069"><a href="#EmulatorLauncher.main-1069"><span class="linenos">1069</span></a>                    <span class="n">stdscr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1070"><a href="#EmulatorLauncher.main-1070"><span class="linenos">1070</span></a>                    <span class="n">curses</span><span class="o">.</span><span class="n">curs_set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Re-hide cursor after resize</span>
</span><span id="EmulatorLauncher.main-1071"><a href="#EmulatorLauncher.main-1071"><span class="linenos">1071</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">init_colors</span><span class="p">()</span>  <span class="c1"># Re-initialize colors if necessary</span>
</span><span id="EmulatorLauncher.main-1072"><a href="#EmulatorLauncher.main-1072"><span class="linenos">1072</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">update_filtered_roms</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1073"><a href="#EmulatorLauncher.main-1073"><span class="linenos">1073</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_system_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1074"><a href="#EmulatorLauncher.main-1074"><span class="linenos">1074</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_rom_window</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1075"><a href="#EmulatorLauncher.main-1075"><span class="linenos">1075</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_filter_bar</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1076"><a href="#EmulatorLauncher.main-1076"><span class="linenos">1076</span></a>                <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.main-1077"><a href="#EmulatorLauncher.main-1077"><span class="linenos">1077</span></a>                    <span class="n">key</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1078"><a href="#EmulatorLauncher.main-1078"><span class="linenos">1078</span></a>                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher.main-1079"><a href="#EmulatorLauncher.main-1079"><span class="linenos">1079</span></a>                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;navigate&quot;</span>
</span><span id="EmulatorLauncher.main-1080"><a href="#EmulatorLauncher.main-1080"><span class="linenos">1080</span></a>                <span class="p">):</span>
</span><span id="EmulatorLauncher.main-1081"><a href="#EmulatorLauncher.main-1081"><span class="linenos">1081</span></a>                    <span class="k">break</span>
</span><span id="EmulatorLauncher.main-1082"><a href="#EmulatorLauncher.main-1082"><span class="linenos">1082</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1083"><a href="#EmulatorLauncher.main-1083"><span class="linenos">1083</span></a>
</span><span id="EmulatorLauncher.main-1084"><a href="#EmulatorLauncher.main-1084"><span class="linenos">1084</span></a>            <span class="c1"># Process pygame events for button presses.</span>
</span><span id="EmulatorLauncher.main-1085"><a href="#EmulatorLauncher.main-1085"><span class="linenos">1085</span></a>            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
</span><span id="EmulatorLauncher.main-1086"><a href="#EmulatorLauncher.main-1086"><span class="linenos">1086</span></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">pygame</span><span class="o">.</span><span class="n">JOYBUTTONDOWN</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1087"><a href="#EmulatorLauncher.main-1087"><span class="linenos">1087</span></a>                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Typically A button.</span>
</span><span id="EmulatorLauncher.main-1088"><a href="#EmulatorLauncher.main-1088"><span class="linenos">1088</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Enter key.</span>
</span><span id="EmulatorLauncher.main-1089"><a href="#EmulatorLauncher.main-1089"><span class="linenos">1089</span></a>                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Typically B button.</span>
</span><span id="EmulatorLauncher.main-1090"><a href="#EmulatorLauncher.main-1090"><span class="linenos">1090</span></a>                        <span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="EmulatorLauncher.main-1091"><a href="#EmulatorLauncher.main-1091"><span class="linenos">1091</span></a>                    <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Example: X button.</span>
</span><span id="EmulatorLauncher.main-1092"><a href="#EmulatorLauncher.main-1092"><span class="linenos">1092</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_F2</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1093"><a href="#EmulatorLauncher.main-1093"><span class="linenos">1093</span></a>                <span class="c1"># We poll the hat state below for auto-repeat.</span>
</span><span id="EmulatorLauncher.main-1094"><a href="#EmulatorLauncher.main-1094"><span class="linenos">1094</span></a>
</span><span id="EmulatorLauncher.main-1095"><a href="#EmulatorLauncher.main-1095"><span class="linenos">1095</span></a>            <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="EmulatorLauncher.main-1096"><a href="#EmulatorLauncher.main-1096"><span class="linenos">1096</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1097"><a href="#EmulatorLauncher.main-1097"><span class="linenos">1097</span></a>                <span class="c1"># ----- Process D-pad (hat) with initial delay auto-repeat -----</span>
</span><span id="EmulatorLauncher.main-1098"><a href="#EmulatorLauncher.main-1098"><span class="linenos">1098</span></a>                <span class="n">hat_x</span><span class="p">,</span> <span class="n">hat_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_hat</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1099"><a href="#EmulatorLauncher.main-1099"><span class="linenos">1099</span></a>                <span class="c1"># For UP</span>
</span><span id="EmulatorLauncher.main-1100"><a href="#EmulatorLauncher.main-1100"><span class="linenos">1100</span></a>                <span class="k">if</span> <span class="n">hat_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1101"><a href="#EmulatorLauncher.main-1101"><span class="linenos">1101</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1102"><a href="#EmulatorLauncher.main-1102"><span class="linenos">1102</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1103"><a href="#EmulatorLauncher.main-1103"><span class="linenos">1103</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1104"><a href="#EmulatorLauncher.main-1104"><span class="linenos">1104</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1105"><a href="#EmulatorLauncher.main-1105"><span class="linenos">1105</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.main-1106"><a href="#EmulatorLauncher.main-1106"><span class="linenos">1106</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher.main-1107"><a href="#EmulatorLauncher.main-1107"><span class="linenos">1107</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher.main-1108"><a href="#EmulatorLauncher.main-1108"><span class="linenos">1108</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher.main-1109"><a href="#EmulatorLauncher.main-1109"><span class="linenos">1109</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1110"><a href="#EmulatorLauncher.main-1110"><span class="linenos">1110</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1111"><a href="#EmulatorLauncher.main-1111"><span class="linenos">1111</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1112"><a href="#EmulatorLauncher.main-1112"><span class="linenos">1112</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1113"><a href="#EmulatorLauncher.main-1113"><span class="linenos">1113</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1114"><a href="#EmulatorLauncher.main-1114"><span class="linenos">1114</span></a>
</span><span id="EmulatorLauncher.main-1115"><a href="#EmulatorLauncher.main-1115"><span class="linenos">1115</span></a>                <span class="c1"># For DOWN</span>
</span><span id="EmulatorLauncher.main-1116"><a href="#EmulatorLauncher.main-1116"><span class="linenos">1116</span></a>                <span class="k">if</span> <span class="n">hat_y</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1117"><a href="#EmulatorLauncher.main-1117"><span class="linenos">1117</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1118"><a href="#EmulatorLauncher.main-1118"><span class="linenos">1118</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1119"><a href="#EmulatorLauncher.main-1119"><span class="linenos">1119</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1120"><a href="#EmulatorLauncher.main-1120"><span class="linenos">1120</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1121"><a href="#EmulatorLauncher.main-1121"><span class="linenos">1121</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.main-1122"><a href="#EmulatorLauncher.main-1122"><span class="linenos">1122</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher.main-1123"><a href="#EmulatorLauncher.main-1123"><span class="linenos">1123</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher.main-1124"><a href="#EmulatorLauncher.main-1124"><span class="linenos">1124</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher.main-1125"><a href="#EmulatorLauncher.main-1125"><span class="linenos">1125</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1126"><a href="#EmulatorLauncher.main-1126"><span class="linenos">1126</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1127"><a href="#EmulatorLauncher.main-1127"><span class="linenos">1127</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1128"><a href="#EmulatorLauncher.main-1128"><span class="linenos">1128</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1129"><a href="#EmulatorLauncher.main-1129"><span class="linenos">1129</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1130"><a href="#EmulatorLauncher.main-1130"><span class="linenos">1130</span></a>
</span><span id="EmulatorLauncher.main-1131"><a href="#EmulatorLauncher.main-1131"><span class="linenos">1131</span></a>                <span class="c1"># For RIGHT</span>
</span><span id="EmulatorLauncher.main-1132"><a href="#EmulatorLauncher.main-1132"><span class="linenos">1132</span></a>                <span class="k">if</span> <span class="n">hat_x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1133"><a href="#EmulatorLauncher.main-1133"><span class="linenos">1133</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1134"><a href="#EmulatorLauncher.main-1134"><span class="linenos">1134</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1135"><a href="#EmulatorLauncher.main-1135"><span class="linenos">1135</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1136"><a href="#EmulatorLauncher.main-1136"><span class="linenos">1136</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1137"><a href="#EmulatorLauncher.main-1137"><span class="linenos">1137</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.main-1138"><a href="#EmulatorLauncher.main-1138"><span class="linenos">1138</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher.main-1139"><a href="#EmulatorLauncher.main-1139"><span class="linenos">1139</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher.main-1140"><a href="#EmulatorLauncher.main-1140"><span class="linenos">1140</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher.main-1141"><a href="#EmulatorLauncher.main-1141"><span class="linenos">1141</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1142"><a href="#EmulatorLauncher.main-1142"><span class="linenos">1142</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1143"><a href="#EmulatorLauncher.main-1143"><span class="linenos">1143</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1144"><a href="#EmulatorLauncher.main-1144"><span class="linenos">1144</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1145"><a href="#EmulatorLauncher.main-1145"><span class="linenos">1145</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1146"><a href="#EmulatorLauncher.main-1146"><span class="linenos">1146</span></a>
</span><span id="EmulatorLauncher.main-1147"><a href="#EmulatorLauncher.main-1147"><span class="linenos">1147</span></a>                <span class="c1"># For LEFT</span>
</span><span id="EmulatorLauncher.main-1148"><a href="#EmulatorLauncher.main-1148"><span class="linenos">1148</span></a>                <span class="k">if</span> <span class="n">hat_x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1149"><a href="#EmulatorLauncher.main-1149"><span class="linenos">1149</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1150"><a href="#EmulatorLauncher.main-1150"><span class="linenos">1150</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1151"><a href="#EmulatorLauncher.main-1151"><span class="linenos">1151</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1152"><a href="#EmulatorLauncher.main-1152"><span class="linenos">1152</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1153"><a href="#EmulatorLauncher.main-1153"><span class="linenos">1153</span></a>                    <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.main-1154"><a href="#EmulatorLauncher.main-1154"><span class="linenos">1154</span></a>                        <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher.main-1155"><a href="#EmulatorLauncher.main-1155"><span class="linenos">1155</span></a>                        <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher.main-1156"><a href="#EmulatorLauncher.main-1156"><span class="linenos">1156</span></a>                    <span class="p">):</span>
</span><span id="EmulatorLauncher.main-1157"><a href="#EmulatorLauncher.main-1157"><span class="linenos">1157</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1158"><a href="#EmulatorLauncher.main-1158"><span class="linenos">1158</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1159"><a href="#EmulatorLauncher.main-1159"><span class="linenos">1159</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1160"><a href="#EmulatorLauncher.main-1160"><span class="linenos">1160</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">first_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1161"><a href="#EmulatorLauncher.main-1161"><span class="linenos">1161</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">last_hat_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1162"><a href="#EmulatorLauncher.main-1162"><span class="linenos">1162</span></a>
</span><span id="EmulatorLauncher.main-1163"><a href="#EmulatorLauncher.main-1163"><span class="linenos">1163</span></a>                <span class="c1"># ----- Process Joystick Axes if D-pad is neutral -----</span>
</span><span id="EmulatorLauncher.main-1164"><a href="#EmulatorLauncher.main-1164"><span class="linenos">1164</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">hat_x</span><span class="p">,</span> <span class="n">hat_y</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="EmulatorLauncher.main-1165"><a href="#EmulatorLauncher.main-1165"><span class="linenos">1165</span></a>                    <span class="n">axis_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1166"><a href="#EmulatorLauncher.main-1166"><span class="linenos">1166</span></a>                    <span class="n">axis_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1167"><a href="#EmulatorLauncher.main-1167"><span class="linenos">1167</span></a>
</span><span id="EmulatorLauncher.main-1168"><a href="#EmulatorLauncher.main-1168"><span class="linenos">1168</span></a>                    <span class="c1"># For UP</span>
</span><span id="EmulatorLauncher.main-1169"><a href="#EmulatorLauncher.main-1169"><span class="linenos">1169</span></a>                    <span class="k">if</span> <span class="n">axis_y</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1170"><a href="#EmulatorLauncher.main-1170"><span class="linenos">1170</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1171"><a href="#EmulatorLauncher.main-1171"><span class="linenos">1171</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1172"><a href="#EmulatorLauncher.main-1172"><span class="linenos">1172</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1173"><a href="#EmulatorLauncher.main-1173"><span class="linenos">1173</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1174"><a href="#EmulatorLauncher.main-1174"><span class="linenos">1174</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.main-1175"><a href="#EmulatorLauncher.main-1175"><span class="linenos">1175</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher.main-1176"><a href="#EmulatorLauncher.main-1176"><span class="linenos">1176</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher.main-1177"><a href="#EmulatorLauncher.main-1177"><span class="linenos">1177</span></a>                        <span class="p">):</span>
</span><span id="EmulatorLauncher.main-1178"><a href="#EmulatorLauncher.main-1178"><span class="linenos">1178</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_UP</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1179"><a href="#EmulatorLauncher.main-1179"><span class="linenos">1179</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1180"><a href="#EmulatorLauncher.main-1180"><span class="linenos">1180</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1181"><a href="#EmulatorLauncher.main-1181"><span class="linenos">1181</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1182"><a href="#EmulatorLauncher.main-1182"><span class="linenos">1182</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1183"><a href="#EmulatorLauncher.main-1183"><span class="linenos">1183</span></a>
</span><span id="EmulatorLauncher.main-1184"><a href="#EmulatorLauncher.main-1184"><span class="linenos">1184</span></a>                    <span class="c1"># For DOWN</span>
</span><span id="EmulatorLauncher.main-1185"><a href="#EmulatorLauncher.main-1185"><span class="linenos">1185</span></a>                    <span class="k">if</span> <span class="n">axis_y</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1186"><a href="#EmulatorLauncher.main-1186"><span class="linenos">1186</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1187"><a href="#EmulatorLauncher.main-1187"><span class="linenos">1187</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1188"><a href="#EmulatorLauncher.main-1188"><span class="linenos">1188</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1189"><a href="#EmulatorLauncher.main-1189"><span class="linenos">1189</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1190"><a href="#EmulatorLauncher.main-1190"><span class="linenos">1190</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.main-1191"><a href="#EmulatorLauncher.main-1191"><span class="linenos">1191</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher.main-1192"><a href="#EmulatorLauncher.main-1192"><span class="linenos">1192</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher.main-1193"><a href="#EmulatorLauncher.main-1193"><span class="linenos">1193</span></a>                        <span class="p">):</span>
</span><span id="EmulatorLauncher.main-1194"><a href="#EmulatorLauncher.main-1194"><span class="linenos">1194</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_DOWN</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1195"><a href="#EmulatorLauncher.main-1195"><span class="linenos">1195</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1196"><a href="#EmulatorLauncher.main-1196"><span class="linenos">1196</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1197"><a href="#EmulatorLauncher.main-1197"><span class="linenos">1197</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1198"><a href="#EmulatorLauncher.main-1198"><span class="linenos">1198</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1199"><a href="#EmulatorLauncher.main-1199"><span class="linenos">1199</span></a>
</span><span id="EmulatorLauncher.main-1200"><a href="#EmulatorLauncher.main-1200"><span class="linenos">1200</span></a>                    <span class="c1"># For LEFT</span>
</span><span id="EmulatorLauncher.main-1201"><a href="#EmulatorLauncher.main-1201"><span class="linenos">1201</span></a>                    <span class="k">if</span> <span class="n">axis_x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1202"><a href="#EmulatorLauncher.main-1202"><span class="linenos">1202</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1203"><a href="#EmulatorLauncher.main-1203"><span class="linenos">1203</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1204"><a href="#EmulatorLauncher.main-1204"><span class="linenos">1204</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1205"><a href="#EmulatorLauncher.main-1205"><span class="linenos">1205</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1206"><a href="#EmulatorLauncher.main-1206"><span class="linenos">1206</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.main-1207"><a href="#EmulatorLauncher.main-1207"><span class="linenos">1207</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher.main-1208"><a href="#EmulatorLauncher.main-1208"><span class="linenos">1208</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher.main-1209"><a href="#EmulatorLauncher.main-1209"><span class="linenos">1209</span></a>                        <span class="p">):</span>
</span><span id="EmulatorLauncher.main-1210"><a href="#EmulatorLauncher.main-1210"><span class="linenos">1210</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_LEFT</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1211"><a href="#EmulatorLauncher.main-1211"><span class="linenos">1211</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1212"><a href="#EmulatorLauncher.main-1212"><span class="linenos">1212</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1213"><a href="#EmulatorLauncher.main-1213"><span class="linenos">1213</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1214"><a href="#EmulatorLauncher.main-1214"><span class="linenos">1214</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1215"><a href="#EmulatorLauncher.main-1215"><span class="linenos">1215</span></a>
</span><span id="EmulatorLauncher.main-1216"><a href="#EmulatorLauncher.main-1216"><span class="linenos">1216</span></a>                    <span class="c1"># For RIGHT</span>
</span><span id="EmulatorLauncher.main-1217"><a href="#EmulatorLauncher.main-1217"><span class="linenos">1217</span></a>                    <span class="k">if</span> <span class="n">axis_x</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1218"><a href="#EmulatorLauncher.main-1218"><span class="linenos">1218</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1219"><a href="#EmulatorLauncher.main-1219"><span class="linenos">1219</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1220"><a href="#EmulatorLauncher.main-1220"><span class="linenos">1220</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1221"><a href="#EmulatorLauncher.main-1221"><span class="linenos">1221</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1222"><a href="#EmulatorLauncher.main-1222"><span class="linenos">1222</span></a>                        <span class="k">elif</span> <span class="p">(</span>
</span><span id="EmulatorLauncher.main-1223"><a href="#EmulatorLauncher.main-1223"><span class="linenos">1223</span></a>                            <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_delay</span>
</span><span id="EmulatorLauncher.main-1224"><a href="#EmulatorLauncher.main-1224"><span class="linenos">1224</span></a>                            <span class="ow">and</span> <span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">repeat_interval</span>
</span><span id="EmulatorLauncher.main-1225"><a href="#EmulatorLauncher.main-1225"><span class="linenos">1225</span></a>                        <span class="p">):</span>
</span><span id="EmulatorLauncher.main-1226"><a href="#EmulatorLauncher.main-1226"><span class="linenos">1226</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">handle_input</span><span class="p">(</span><span class="n">curses</span><span class="o">.</span><span class="n">KEY_RIGHT</span><span class="p">)</span>
</span><span id="EmulatorLauncher.main-1227"><a href="#EmulatorLauncher.main-1227"><span class="linenos">1227</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span>
</span><span id="EmulatorLauncher.main-1228"><a href="#EmulatorLauncher.main-1228"><span class="linenos">1228</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1229"><a href="#EmulatorLauncher.main-1229"><span class="linenos">1229</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">first_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1230"><a href="#EmulatorLauncher.main-1230"><span class="linenos">1230</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">last_axis_event</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="EmulatorLauncher.main-1231"><a href="#EmulatorLauncher.main-1231"><span class="linenos">1231</span></a>
</span><span id="EmulatorLauncher.main-1232"><a href="#EmulatorLauncher.main-1232"><span class="linenos">1232</span></a>            <span class="c1"># Check if the emulator process has finished.</span>
</span><span id="EmulatorLauncher.main-1233"><a href="#EmulatorLauncher.main-1233"><span class="linenos">1233</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="EmulatorLauncher.main-1234"><a href="#EmulatorLauncher.main-1234"><span class="linenos">1234</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">emulator_process</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="EmulatorLauncher.main-1235"><a href="#EmulatorLauncher.main-1235"><span class="linenos">1235</span></a>
</span><span id="EmulatorLauncher.main-1236"><a href="#EmulatorLauncher.main-1236"><span class="linenos">1236</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Main function to initialize and run the ROM launcher interface.
Args:
    stdscr: The standard screen object provided by curses.
This function sets up the curses environment, initializes pygame for gamepad support,
and enters the main loop to handle user input and update the display. It supports both
keyboard and gamepad inputs, with auto-repeat functionality for gamepad D-pad and joystick axes.
The interface is divided into two windows: one for system selection and one for ROM selection.
The function also handles window resizing and checks for the completion of the emulator process.</p>
</div>


                            </div>
                </section>
                <section id="main">
                            <input id="main-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">main</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="main-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#main"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="main-1239"><a href="#main-1239"><span class="linenos">1239</span></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span><span id="main-1240"><a href="#main-1240"><span class="linenos">1240</span></a>    <span class="n">launcher</span> <span class="o">=</span> <span class="n">EmulatorLauncher</span><span class="p">()</span>
</span><span id="main-1241"><a href="#main-1241"><span class="linenos">1241</span></a>    <span class="n">curses</span><span class="o">.</span><span class="n">wrapper</span><span class="p">(</span><span class="n">launcher</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
</span></pre></div>


    

                </section>
    </main>
</body>
</html>